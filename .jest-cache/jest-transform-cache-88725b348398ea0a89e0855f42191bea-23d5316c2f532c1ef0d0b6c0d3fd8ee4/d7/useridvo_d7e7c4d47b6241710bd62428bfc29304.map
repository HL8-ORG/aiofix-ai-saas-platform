{"version":3,"names":["core_1","cov_c2hc8cutu","s","require","uuid_1","UserId","ValueObject","constructor","value","f","validate","b","_value","trim","length","InvalidUserIdError","uuidRegex","test","generate","v4","fromString","toString","exports","Error","message","name"],"sources":["/home/arligle/V1/Aiofix/aiofix-ai-saas-platform/packages/user/src/domain/value-objects/user-id.vo.ts"],"sourcesContent":["import { ValueObject } from '@aiofix/core';\nimport { v4 as uuidv4 } from 'uuid';\n\n/**\n * 用户ID值对象\n *\n * 设计原理：\n * - 封装用户标识符的业务规则\n * - 确保用户ID的唯一性和有效性\n * - 提供类型安全的用户标识\n *\n * 业务规则：\n * - 用户ID必须是有效的UUID格式\n * - 用户ID不能为空或无效字符串\n * - 用户ID在系统中必须唯一\n */\nexport class UserId extends ValueObject<string> {\n  constructor(value: string) {\n    super(value);\n    this.validate();\n  }\n\n  /**\n   * 验证用户ID的有效性\n   *\n   * 业务规则：\n   * - 必须是有效的UUID格式\n   * - 不能为空或无效字符串\n   */\n  private validate(): void {\n    if (!this._value || this._value.trim().length === 0) {\n      throw new InvalidUserIdError('User ID cannot be empty');\n    }\n\n    // UUID格式验证\n    const uuidRegex =\n      /^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;\n    if (!uuidRegex.test(this._value)) {\n      throw new InvalidUserIdError(`Invalid UUID format: ${this._value}`);\n    }\n  }\n\n  /**\n   * 生成新的用户ID\n   *\n   * 业务规则：\n   * - 使用UUID v4生成唯一标识符\n   * - 确保全局唯一性\n   */\n  public static generate(): UserId {\n    return new UserId(uuidv4());\n  }\n\n  /**\n   * 从字符串创建用户ID\n   *\n   * @param value 用户ID字符串\n   * @returns 用户ID值对象\n   */\n  public static fromString(value: string): UserId {\n    return new UserId(value);\n  }\n\n  /**\n   * 获取用户ID的字符串表示\n   *\n   * @returns 用户ID字符串\n   */\n  public toString(): string {\n    return this._value;\n  }\n}\n\n/**\n * 无效用户ID异常\n *\n * 业务规则：\n * - 当用户ID不符合业务规则时抛出\n * - 提供清晰的错误信息\n */\nexport class InvalidUserIdError extends Error {\n  constructor(message: string) {\n    super(message);\n    this.name = 'InvalidUserIdError';\n  }\n}\n"],"mappings":"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","ignoreList":[]}