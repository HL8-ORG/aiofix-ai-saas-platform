c5d6397445e339dd0aa6ea8c870691e1
"use strict";
var __esDecorate = (this && this.__esDecorate) || function (ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {
    function accept(f) { if (f !== void 0 && typeof f !== "function") throw new TypeError("Function expected"); return f; }
    var kind = contextIn.kind, key = kind === "getter" ? "get" : kind === "setter" ? "set" : "value";
    var target = !descriptorIn && ctor ? contextIn["static"] ? ctor : ctor.prototype : null;
    var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});
    var _, done = false;
    for (var i = decorators.length - 1; i >= 0; i--) {
        var context = {};
        for (var p in contextIn) context[p] = p === "access" ? {} : contextIn[p];
        for (var p in contextIn.access) context.access[p] = contextIn.access[p];
        context.addInitializer = function (f) { if (done) throw new TypeError("Cannot add initializers after decoration has completed"); extraInitializers.push(accept(f || null)); };
        var result = (0, decorators[i])(kind === "accessor" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);
        if (kind === "accessor") {
            if (result === void 0) continue;
            if (result === null || typeof result !== "object") throw new TypeError("Object expected");
            if (_ = accept(result.get)) descriptor.get = _;
            if (_ = accept(result.set)) descriptor.set = _;
            if (_ = accept(result.init)) initializers.unshift(_);
        }
        else if (_ = accept(result)) {
            if (kind === "field") initializers.unshift(_);
            else descriptor[key] = _;
        }
    }
    if (target) Object.defineProperty(target, contextIn.name, descriptor);
    done = true;
};
var __runInitializers = (this && this.__runInitializers) || function (thisArg, initializers, value) {
    var useValue = arguments.length > 2;
    for (var i = 0; i < initializers.length; i++) {
        value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);
    }
    return useValue ? value : void 0;
};
var __setFunctionName = (this && this.__setFunctionName) || function (f, name, prefix) {
    if (typeof name === "symbol") name = name.description ? "[".concat(name.description, "]") : "";
    return Object.defineProperty(f, "name", { configurable: true, value: prefix ? "".concat(prefix, " ", name) : name });
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.CacheManagerService = void 0;
const common_1 = require("@nestjs/common");
const cache_interface_1 = require("../interfaces/cache.interface");
const logging_1 = require("@aiofix/logging");
/**
 * @class CacheManagerService
 * @description
 * 缓存管理器服务，作为缓存系统的核心协调器。
 *
 * 主要功能包括：
 * 1. 管理多个缓存层（L1、L2、L3等）
 * 2. 实现缓存策略（LRU、LFU、FIFO等）
 * 3. 提供统一的缓存接口
 * 4. 监控缓存性能和健康状态
 * 5. 处理缓存失效和更新
 * 6. 提供缓存统计和分析
 *
 * @implements {ICacheService}
 */
let CacheManagerService = (() => {
    let _classDecorators = [(0, common_1.Injectable)()];
    let _classDescriptor;
    let _classExtraInitializers = [];
    let _classThis;
    var CacheManagerService = _classThis = class {
        constructor(config, eventEmitter, logger) {
            this.eventEmitter = eventEmitter;
            /**
             * 缓存层映射，按优先级排序
             */
            this.layers = new Map();
            /**
             * 请求计数器
             */
            this.requestCount = 0;
            /**
             * 命中计数器
             */
            this.hitCount = 0;
            /**
             * 响应时间累计
             */
            this.totalResponseTime = 0;
            this.logger = logger;
            this.config = {
                enabled: true,
                defaultStrategy: cache_interface_1.CacheStrategy.LRU,
                monitoringInterval: 30000,
                cleanupInterval: 60000,
                maxSize: 10000,
                enableStats: true,
                enableEvents: true,
                ...config,
            };
            this.stats = this.initializeStats();
            this.initializeLayers();
            this.startMonitoring();
            this.startCleanup();
            this.logger.info('CacheManagerService initialized', logging_1.LogContext.CACHE);
        }
        /**
         * @method get
         * @description 从缓存中获取值
         * @param key 缓存键
         * @returns {Promise<T | null>} 缓存值
         */
        async get(key) {
            const startTime = Date.now();
            this.requestCount++;
            try {
                // 按优先级遍历缓存层
                for (const layer of this.getSortedLayers()) {
                    if (!layer.enabled)
                        continue;
                    const value = await layer.service.get(key);
                    if (value !== null) {
                        // 缓存命中，更新统计
                        this.hitCount++;
                        this.updateStats(startTime);
                        // 如果命中的是低优先级层，尝试提升到高优先级层
                        if (layer.priority > 1) {
                            this.promoteToHigherLayer(key, value, layer.priority);
                        }
                        this.emitEvent('cache_hit', { key, layer: layer.name, value });
                        return value;
                    }
                }
                // 缓存未命中
                this.updateStats(startTime);
                this.emitEvent('cache_miss', { key });
                return null;
            }
            catch (error) {
                this.logger.error(`Error getting cache value: ${key.key}`, logging_1.LogContext.CACHE, undefined, error);
                this.emitEvent('cache_error', { key, error });
                return null;
            }
        }
        /**
         * @method set
         * @description 设置缓存值
         * @param key 缓存键
         * @param value 缓存值
         * @param options 缓存选项
         * @returns {Promise<boolean>} 是否成功
         */
        async set(key, value, options) {
            const startTime = Date.now();
            try {
                const mergedOptions = { ...this.config.defaultOptions, ...options };
                let success = false;
                // 按优先级设置到所有启用的缓存层
                for (const layer of this.getSortedLayers()) {
                    if (!layer.enabled || layer.readOnly)
                        continue;
                    try {
                        const layerSuccess = await layer.service.set(key, value, {
                            ...layer.options,
                            ...mergedOptions,
                        });
                        if (layerSuccess) {
                            success = true;
                            this.emitEvent('cache_set', { key, layer: layer.name, value });
                        }
                    }
                    catch (error) {
                        this.logger.warn(`Failed to set cache in layer ${layer.name}: ${key.key}`, logging_1.LogContext.CACHE, undefined, error);
                    }
                }
                this.updateStats(startTime);
                return success;
            }
            catch (error) {
                this.logger.error(`Error setting cache value: ${key.key}`, logging_1.LogContext.CACHE, undefined, error);
                this.emitEvent('cache_error', { key, error });
                return false;
            }
        }
        /**
         * @method delete
         * @description 删除缓存值
         * @param key 缓存键
         * @returns {Promise<boolean>} 是否成功
         */
        async delete(key) {
            const startTime = Date.now();
            try {
                let success = false;
                // 从所有缓存层删除
                for (const layer of this.getSortedLayers()) {
                    if (!layer.enabled || layer.readOnly)
                        continue;
                    try {
                        const layerSuccess = await layer.service.delete(key);
                        if (layerSuccess) {
                            success = true;
                            this.emitEvent('cache_delete', { key, layer: layer.name });
                        }
                    }
                    catch (error) {
                        this.logger.warn(`Failed to delete cache from layer ${layer.name}: ${key.key}`, logging_1.LogContext.CACHE, undefined, error);
                    }
                }
                this.updateStats(startTime);
                return success;
            }
            catch (error) {
                this.logger.error(`Error deleting cache value: ${key.key}`, logging_1.LogContext.CACHE, undefined, error);
                this.emitEvent('cache_error', { key, error });
                return false;
            }
        }
        /**
         * @method exists
         * @description 检查缓存键是否存在
         * @param key 缓存键
         * @returns {Promise<boolean>} 是否存在
         */
        async exists(key) {
            const startTime = Date.now();
            this.requestCount++;
            try {
                // 检查所有缓存层
                for (const layer of this.getSortedLayers()) {
                    if (!layer.enabled)
                        continue;
                    const exists = await layer.service.exists(key);
                    if (exists) {
                        this.hitCount++;
                        this.updateStats(startTime);
                        this.emitEvent('cache_exists', { key, layer: layer.name });
                        return true;
                    }
                }
                this.updateStats(startTime);
                return false;
            }
            catch (error) {
                this.logger.error(`Error checking cache existence: ${key.key}`, logging_1.LogContext.CACHE, undefined, error);
                this.emitEvent('cache_error', { key, error });
                return false;
            }
        }
        /**
         * @method clear
         * @description 清空缓存
         * @param namespace 命名空间
         * @returns {Promise<boolean>} 是否成功
         */
        async clear(namespace) {
            const startTime = Date.now();
            try {
                let success = false;
                // 清空所有缓存层
                for (const layer of this.getSortedLayers()) {
                    if (!layer.enabled || layer.readOnly)
                        continue;
                    try {
                        const layerSuccess = await layer.service.clear(namespace);
                        if (layerSuccess) {
                            success = true;
                            this.emitEvent('cache_clear', { layer: layer.name, namespace });
                        }
                    }
                    catch (error) {
                        this.logger.warn(`Failed to clear cache layer ${layer.name}`, logging_1.LogContext.CACHE, undefined, error);
                    }
                }
                this.updateStats(startTime);
                return success;
            }
            catch (error) {
                this.logger.error('Error clearing cache', logging_1.LogContext.CACHE, undefined, error);
                this.emitEvent('cache_error', { error });
                return false;
            }
        }
        /**
         * @method getStats
         * @description 获取缓存统计信息
         * @returns {Promise<CacheStats>} 统计信息
         */
        async getStats() {
            try {
                // 更新各层统计信息
                const layerStats = {};
                for (const [name, layer] of this.layers) {
                    if (layer.enabled) {
                        try {
                            layerStats[name] = await layer.service.getStats();
                        }
                        catch (error) {
                            this.logger.warn(`Failed to get stats for layer ${name}`, logging_1.LogContext.CACHE, undefined, error);
                            layerStats[name] = null;
                        }
                    }
                }
                // 计算总体统计
                this.stats.hitRate =
                    this.requestCount > 0 ? this.hitCount / this.requestCount : 0;
                this.stats.activeLayers = Array.from(this.layers.values()).filter(layer => layer.enabled).length;
                this.stats.layerStats = layerStats;
                this.stats.lastUpdated = new Date();
                return { ...this.stats };
            }
            catch (error) {
                this.logger.error('Error getting cache stats', logging_1.LogContext.CACHE, undefined, error);
                return this.stats;
            }
        }
        /**
         * @method getHealth
         * @description 获取缓存健康状态
         * @returns {Promise<CacheHealth>} 健康状态
         */
        async getHealth() {
            try {
                let healthyLayers = 0;
                let totalResponseTime = 0;
                let hasError = false;
                let errorMessage = '';
                // 检查各层健康状态
                for (const [, layer] of this.layers) {
                    if (layer.enabled) {
                        try {
                            const layerHealth = await layer.service.getHealth();
                            totalResponseTime += layerHealth.responseTime;
                            if (layerHealth.healthy) {
                                healthyLayers++;
                            }
                            else {
                                hasError = true;
                                errorMessage = layerHealth.error || 'Layer unhealthy';
                            }
                        }
                        catch (error) {
                            hasError = true;
                            errorMessage = error.message;
                        }
                    }
                }
                const activeLayers = Array.from(this.layers.values()).filter(layer => layer.enabled).length;
                const averageResponseTime = activeLayers > 0 ? totalResponseTime / activeLayers : 0;
                return {
                    healthy: !hasError && healthyLayers === activeLayers,
                    connected: healthyLayers > 0,
                    responseTime: averageResponseTime,
                    error: hasError ? errorMessage : undefined,
                    lastCheck: Date.now(),
                };
            }
            catch (error) {
                this.logger.error('Error getting cache health', logging_1.LogContext.CACHE, undefined, error);
                return {
                    healthy: false,
                    connected: false,
                    responseTime: 0,
                    error: error.message,
                    lastCheck: Date.now(),
                };
            }
        }
        /**
         * @method addLayer
         * @description 添加缓存层
         * @param config 缓存层配置
         * @returns {boolean} 是否成功
         */
        addLayer(config) {
            try {
                if (this.layers.has(config.name)) {
                    this.logger.warn(`Cache layer ${config.name} already exists, replacing...`, logging_1.LogContext.CACHE);
                }
                this.layers.set(config.name, {
                    enabled: true,
                    readOnly: false,
                    fallback: false,
                    ...config,
                });
                this.logger.info(`Added cache layer: ${config.name} with priority ${config.priority}`, logging_1.LogContext.CACHE);
                this.emitEvent('layer_added', {
                    layer: config.name,
                    priority: config.priority,
                });
                return true;
            }
            catch (error) {
                this.logger.error(`Failed to add cache layer: ${config.name}`, logging_1.LogContext.CACHE, undefined, error);
                return false;
            }
        }
        /**
         * @method removeLayer
         * @description 移除缓存层
         * @param name 缓存层名称
         * @returns {boolean} 是否成功
         */
        removeLayer(name) {
            try {
                if (!this.layers.has(name)) {
                    this.logger.warn(`Cache layer ${name} does not exist`, logging_1.LogContext.CACHE);
                    return false;
                }
                this.layers.delete(name);
                this.logger.info(`Removed cache layer: ${name}`, logging_1.LogContext.CACHE);
                this.emitEvent('layer_removed', { layer: name });
                return true;
            }
            catch (error) {
                this.logger.error(`Failed to remove cache layer: ${name}`, logging_1.LogContext.CACHE, undefined, error);
                return false;
            }
        }
        /**
         * @method enableLayer
         * @description 启用缓存层
         * @param name 缓存层名称
         * @param enabled 是否启用
         * @returns {boolean} 是否成功
         */
        enableLayer(name, enabled) {
            try {
                const layer = this.layers.get(name);
                if (!layer) {
                    this.logger.warn(`Cache layer ${name} does not exist`, logging_1.LogContext.CACHE);
                    return false;
                }
                layer.enabled = enabled;
                this.logger.info(`${enabled ? 'Enabled' : 'Disabled'} cache layer: ${name}`, logging_1.LogContext.CACHE);
                this.emitEvent('layer_toggled', { layer: name, enabled });
                return true;
            }
            catch (error) {
                this.logger.error(`Failed to toggle cache layer: ${name}`, logging_1.LogContext.CACHE, undefined, error);
                return false;
            }
        }
        /**
         * @method getLayers
         * @description 获取所有缓存层信息
         * @returns {CacheLayerConfig[]} 缓存层配置列表
         */
        getLayers() {
            return Array.from(this.layers.values()).map(layer => ({ ...layer }));
        }
        /**
         * @method resetStats
         * @description 重置缓存统计信息
         */
        async resetStats() {
            try {
                // 重置各层统计
                for (const [name, layer] of this.layers) {
                    if (layer.enabled) {
                        try {
                            await layer.service.resetStats();
                        }
                        catch (error) {
                            this.logger.warn(`Failed to reset stats for layer ${name}`, logging_1.LogContext.CACHE, undefined, error);
                        }
                    }
                }
                // 重置管理器统计
                this.requestCount = 0;
                this.hitCount = 0;
                this.totalResponseTime = 0;
                this.stats = this.initializeStats();
                this.logger.info('Cache stats reset successfully', logging_1.LogContext.CACHE);
                this.emitEvent('stats_reset', {});
            }
            catch (error) {
                this.logger.error('Failed to reset cache stats', logging_1.LogContext.CACHE, undefined, error);
            }
        }
        /**
         * @method onDestroy
         * @description 销毁时清理资源
         */
        onDestroy() {
            this.stopMonitoring();
            this.stopCleanup();
            this.logger.info('CacheManagerService destroyed', logging_1.LogContext.CACHE);
        }
        // 私有方法
        /**
         * @private
         * @method initializeStats
         * @description 初始化统计信息
         * @returns {CacheManagerStats} 初始统计信息
         */
        initializeStats() {
            return {
                totalEntries: 0,
                hits: 0,
                misses: 0,
                hitRate: 0,
                totalSize: 0,
                averageSize: 0,
                expiredEntries: 0,
                evictedEntries: 0,
                lastReset: Date.now(),
                activeLayers: 0,
                layerStats: {},
                lastUpdated: new Date(),
            };
        }
        /**
         * @private
         * @method initializeLayers
         * @description 初始化缓存层
         */
        initializeLayers() {
            if (this.config.layers) {
                for (const layerConfig of this.config.layers) {
                    this.addLayer(layerConfig);
                }
            }
        }
        /**
         * @private
         * @method getSortedLayers
         * @description 获取按优先级排序的缓存层
         * @returns {CacheLayerConfig[]} 排序后的缓存层
         */
        getSortedLayers() {
            return Array.from(this.layers.values())
                .filter(layer => layer.enabled)
                .sort((a, b) => a.priority - b.priority);
        }
        /**
         * @private
         * @method promoteToHigherLayer
         * @description 将缓存值提升到更高优先级的层
         * @param key 缓存键
         * @param value 缓存值
         * @param currentPriority 当前优先级
         */
        async promoteToHigherLayer(key, value, currentPriority) {
            try {
                const higherLayers = Array.from(this.layers.values())
                    .filter(layer => layer.enabled &&
                    !layer.readOnly &&
                    layer.priority < currentPriority)
                    .sort((a, b) => a.priority - b.priority);
                for (const layer of higherLayers) {
                    try {
                        await layer.service.set(key, value);
                        this.emitEvent('cache_promoted', {
                            key,
                            fromPriority: currentPriority,
                            toPriority: layer.priority,
                            layer: layer.name,
                        });
                    }
                    catch (error) {
                        this.logger.warn(`Failed to promote cache to layer ${layer.name}: ${key.key}`, logging_1.LogContext.CACHE, undefined, error);
                    }
                }
            }
            catch (error) {
                this.logger.error(`Error promoting cache: ${key.key}`, logging_1.LogContext.CACHE, undefined, error);
            }
        }
        /**
         * @private
         * @method updateStats
         * @description 更新统计信息
         * @param startTime 开始时间
         */
        updateStats(startTime) {
            const responseTime = Date.now() - startTime;
            this.totalResponseTime += responseTime;
            this.stats.hits = this.hitCount;
            this.stats.misses = this.requestCount - this.hitCount;
        }
        /**
         * @private
         * @method emitEvent
         * @description 发送缓存事件
         * @param type 事件类型
         * @param data 事件数据
         */
        emitEvent(type, _data) {
            if (this.config.enableEvents) {
                try {
                    this.eventEmitter.emit(`cache.${type}`, {
                        type,
                        data: _data,
                        timestamp: new Date(),
                        managerId: 'cache-manager',
                    });
                }
                catch (error) {
                    this.logger.warn(`Failed to emit cache event: ${type}`, logging_1.LogContext.CACHE, undefined, error);
                }
            }
        }
        /**
         * @private
         * @method startMonitoring
         * @description 开始监控
         */
        startMonitoring() {
            if (this.config.monitoringInterval && this.config.monitoringInterval > 0) {
                this.monitoringTimer = setInterval(async () => {
                    try {
                        await this.performMonitoring();
                    }
                    catch (error) {
                        this.logger.error('Cache monitoring failed', logging_1.LogContext.CACHE, undefined, error);
                    }
                }, this.config.monitoringInterval);
                this.logger.info(`Started cache monitoring, interval: ${this.config.monitoringInterval}ms`, logging_1.LogContext.CACHE);
            }
        }
        /**
         * @private
         * @method stopMonitoring
         * @description 停止监控
         */
        stopMonitoring() {
            if (this.monitoringTimer) {
                clearInterval(this.monitoringTimer);
                this.monitoringTimer = undefined;
                this.logger.info('Stopped cache monitoring', logging_1.LogContext.CACHE);
            }
        }
        /**
         * @private
         * @method startCleanup
         * @description 开始清理
         */
        startCleanup() {
            if (this.config.cleanupInterval && this.config.cleanupInterval > 0) {
                this.cleanupTimer = setInterval(async () => {
                    try {
                        await this.performCleanup();
                    }
                    catch (error) {
                        this.logger.error('Cache cleanup failed', logging_1.LogContext.CACHE, undefined, error);
                    }
                }, this.config.cleanupInterval);
                this.logger.info(`Started cache cleanup, interval: ${this.config.cleanupInterval}ms`, logging_1.LogContext.CACHE);
            }
        }
        /**
         * @private
         * @method stopCleanup
         * @description 停止清理
         */
        stopCleanup() {
            if (this.cleanupTimer) {
                clearInterval(this.cleanupTimer);
                this.cleanupTimer = undefined;
                this.logger.info('Stopped cache cleanup', logging_1.LogContext.CACHE);
            }
        }
        /**
         * @private
         * @method performMonitoring
         * @description 执行监控
         */
        async performMonitoring() {
            try {
                const health = await this.getHealth();
                const stats = await this.getStats();
                this.emitEvent('monitoring', { health, stats });
                // 检查健康状态
                if (!health.healthy) {
                    this.logger.warn('Cache health check failed', logging_1.LogContext.CACHE);
                }
            }
            catch (error) {
                this.logger.error('Cache monitoring execution failed', logging_1.LogContext.CACHE, undefined, error);
            }
        }
        /**
         * @private
         * @method performCleanup
         * @description 执行清理
         */
        async performCleanup() {
            try {
                // 清理过期的缓存项
                for (const layer of this.getSortedLayers()) {
                    if (layer.enabled && !layer.readOnly) {
                        try {
                            // 这里可以调用各层的清理方法，如果有的话
                            this.emitEvent('cleanup', { layer: layer.name });
                        }
                        catch (error) {
                            this.logger.warn(`Failed to cleanup layer ${layer.name}`, logging_1.LogContext.CACHE, undefined, error);
                        }
                    }
                }
                this.logger.debug('Cache cleanup completed', logging_1.LogContext.CACHE);
            }
            catch (error) {
                this.logger.error('Cache cleanup execution failed', logging_1.LogContext.CACHE, undefined, error);
            }
        }
    };
    __setFunctionName(_classThis, "CacheManagerService");
    (() => {
        const _metadata = typeof Symbol === "function" && Symbol.metadata ? Object.create(null) : void 0;
        __esDecorate(null, _classDescriptor = { value: _classThis }, _classDecorators, { kind: "class", name: _classThis.name, metadata: _metadata }, null, _classExtraInitializers);
        CacheManagerService = _classThis = _classDescriptor.value;
        if (_metadata) Object.defineProperty(_classThis, Symbol.metadata, { enumerable: true, configurable: true, writable: true, value: _metadata });
        __runInitializers(_classThis, _classExtraInitializers);
    })();
    return CacheManagerService = _classThis;
})();
exports.CacheManagerService = CacheManagerService;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvYXJsaWdsZS9WMS9BaW9maXgvYWlvZml4LWFpLXNhYXMtcGxhdGZvcm0vcGFja2FnZXMvY2FjaGUvc3JjL3NlcnZpY2VzL2NhY2hlLW1hbmFnZXIuc2VydmljZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLDJDQUFvRDtBQVdwRCxtRUFBOEQ7QUFDOUQsNkNBQWdFO0FBZ0VoRTs7Ozs7Ozs7Ozs7Ozs7R0FjRztJQUVVLG1CQUFtQjs0QkFEL0IsSUFBQSxtQkFBVSxHQUFFOzs7OztRQTRDWCxZQUNrQyxNQUEwQixFQUV6QyxZQUEyQixFQUM1QyxNQUF5QjtZQURSLGlCQUFZLEdBQVosWUFBWSxDQUFlO1lBM0M5Qzs7ZUFFRztZQUNjLFdBQU0sR0FBRyxJQUFJLEdBQUcsRUFBNEIsQ0FBQztZQXNCOUQ7O2VBRUc7WUFDSyxpQkFBWSxHQUFHLENBQUMsQ0FBQztZQUV6Qjs7ZUFFRztZQUNLLGFBQVEsR0FBRyxDQUFDLENBQUM7WUFFckI7O2VBRUc7WUFDSyxzQkFBaUIsR0FBRyxDQUFDLENBQUM7WUFRNUIsSUFBSSxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUM7WUFDckIsSUFBSSxDQUFDLE1BQU0sR0FBRztnQkFDWixPQUFPLEVBQUUsSUFBSTtnQkFDYixlQUFlLEVBQUUsK0JBQWEsQ0FBQyxHQUFHO2dCQUNsQyxrQkFBa0IsRUFBRSxLQUFLO2dCQUN6QixlQUFlLEVBQUUsS0FBSztnQkFDdEIsT0FBTyxFQUFFLEtBQUs7Z0JBQ2QsV0FBVyxFQUFFLElBQUk7Z0JBQ2pCLFlBQVksRUFBRSxJQUFJO2dCQUNsQixHQUFHLE1BQU07YUFDVixDQUFDO1lBRUYsSUFBSSxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUMsZUFBZSxFQUFFLENBQUM7WUFDcEMsSUFBSSxDQUFDLGdCQUFnQixFQUFFLENBQUM7WUFDeEIsSUFBSSxDQUFDLGVBQWUsRUFBRSxDQUFDO1lBQ3ZCLElBQUksQ0FBQyxZQUFZLEVBQUUsQ0FBQztZQUVw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Q0gsc0JBQXNCOzRCQUN0QixJQUFJLENBQUMsU0FBUyxDQUFDLFNBQVMsRUFBRSxFQUFFLEtBQUssRUFBRSxLQUFLLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQzt3QkFDbkQsQ0FBQzt3QkFBQyxPQUFPLEtBQUssRUFBRSxDQUFDOzRCQUNmLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUNkLDJCQUEyQixLQUFLLENBQUMsSUFBSSxFQUFFLEVBQ3ZDLG9CQUFVLENBQUMsS0FBSyxFQUNoQixTQUFTLEVBQ1QsS0FBYyxDQUNmLENBQUM7d0JBQ0osQ0FBQztvQkFDSCxDQUFDO2dCQUNILENBQUM7Z0JBRUQsSUFBSSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMseUJBQXlCLEVBQUUsb0JBQVUsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUNqRSxDQUFDO1lBQUMsT0FBTyxLQUFLLEVBQUUsQ0FBQztnQkFDZixJQUFJLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FDZixnQ0FBZ0MsRUFDaEMsb0JBQVUsQ0FBQyxLQUFLLEVBQ2hCLFNBQVMsRUFDVCxLQUFjLENBQ2YsQ0FBQztZQUNKLENBQUM7UUFDSCxDQUFDOzs7OztRQTExQkgsNktBMjFCQzs7O1FBMzFCWSx1REFBbUI7Ozs7QUFBbkIsa0RBQW1CIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9ob21lL2FybGlnbGUvVjEvQWlvZml4L2Fpb2ZpeC1haS1zYWFzLXBsYXRmb3JtL3BhY2thZ2VzL2NhY2hlL3NyYy9zZXJ2aWNlcy9jYWNoZS1tYW5hZ2VyLnNlcnZpY2UudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW5qZWN0YWJsZSwgSW5qZWN0IH0gZnJvbSAnQG5lc3Rqcy9jb21tb24nO1xuaW1wb3J0IHsgRXZlbnRFbWl0dGVyMiB9IGZyb20gJ0BuZXN0anMvZXZlbnQtZW1pdHRlcic7XG5cbmltcG9ydCB0eXBlIHsgSUNhY2hlU2VydmljZSB9IGZyb20gJy4uL2ludGVyZmFjZXMvY2FjaGUuaW50ZXJmYWNlJztcblxuaW1wb3J0IHR5cGUge1xuICBDYWNoZU9wdGlvbnMsXG4gIENhY2hlS2V5LFxuICBDYWNoZVN0YXRzLFxuICBDYWNoZUhlYWx0aCxcbn0gZnJvbSAnLi4vaW50ZXJmYWNlcy9jYWNoZS5pbnRlcmZhY2UnO1xuaW1wb3J0IHsgQ2FjaGVTdHJhdGVneSB9IGZyb20gJy4uL2ludGVyZmFjZXMvY2FjaGUuaW50ZXJmYWNlJztcbmltcG9ydCB7IFBpbm9Mb2dnZXJTZXJ2aWNlLCBMb2dDb250ZXh0IH0gZnJvbSAnQGFpb2ZpeC9sb2dnaW5nJztcblxuLyoqXG4gKiBAaW50ZXJmYWNlIENhY2hlTWFuYWdlckNvbmZpZ1xuICogQGRlc2NyaXB0aW9uXG4gKiDnvJPlrZjnrqHnkIblmajphY3nva7mjqXlj6PvvIzlrprkuYnnvJPlrZjnrqHnkIblmajnmoTphY3nva7pgInpobnjgIJcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBDYWNoZU1hbmFnZXJDb25maWcge1xuICAvKiog6buY6K6k57yT5a2Y6YCJ6aG5ICovXG4gIGRlZmF1bHRPcHRpb25zPzogQ2FjaGVPcHRpb25zO1xuICAvKiog6buY6K6k57yT5a2Y562W55WlICovXG4gIGRlZmF1bHRTdHJhdGVneT86IENhY2hlU3RyYXRlZ3k7XG4gIC8qKiDmmK/lkKblkK/nlKjnvJPlrZggKi9cbiAgZW5hYmxlZD86IGJvb2xlYW47XG4gIC8qKiDnvJPlrZjlsYLphY3nva4gKi9cbiAgbGF5ZXJzPzogQ2FjaGVMYXllckNvbmZpZ1tdO1xuICAvKiog55uR5o6n6Ze06ZqU77yI5q+r56eS77yJICovXG4gIG1vbml0b3JpbmdJbnRlcnZhbD86IG51bWJlcjtcbiAgLyoqIOiHquWKqOa4heeQhumXtOmalO+8iOavq+enku+8iSAqL1xuICBjbGVhbnVwSW50ZXJ2YWw/OiBudW1iZXI7XG4gIC8qKiDmnIDlpKfnvJPlrZjlpKflsI8gKi9cbiAgbWF4U2l6ZT86IG51bWJlcjtcbiAgLyoqIOaYr+WQpuWQr+eUqOe7n+iuoSAqL1xuICBlbmFibGVTdGF0cz86IGJvb2xlYW47XG4gIC8qKiDmmK/lkKblkK/nlKjkuovku7YgKi9cbiAgZW5hYmxlRXZlbnRzPzogYm9vbGVhbjtcbn1cblxuLyoqXG4gKiBAaW50ZXJmYWNlIENhY2hlTGF5ZXJDb25maWdcbiAqIEBkZXNjcmlwdGlvblxuICog57yT5a2Y5bGC6YWN572u5o6l5Y+j77yM5a6a5LmJ5Y2V5Liq57yT5a2Y5bGC55qE6YWN572u44CCXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgQ2FjaGVMYXllckNvbmZpZyB7XG4gIC8qKiDnvJPlrZjlsYLlkI3np7AgKi9cbiAgbmFtZTogc3RyaW5nO1xuICAvKiog57yT5a2Y5bGC5LyY5YWI57qn77yI5pWw5a2X6LaK5bCP5LyY5YWI57qn6LaK6auY77yJICovXG4gIHByaW9yaXR5OiBudW1iZXI7XG4gIC8qKiDnvJPlrZjmnI3liqHlrp7kvosgKi9cbiAgc2VydmljZTogSUNhY2hlU2VydmljZTtcbiAgLyoqIOe8k+WtmOWxgumAiemhuSAqL1xuICBvcHRpb25zPzogQ2FjaGVPcHRpb25zO1xuICAvKiog5piv5ZCm5ZCv55SoICovXG4gIGVuYWJsZWQ/OiBib29sZWFuO1xuICAvKiog5piv5ZCm5Y+q6K+7ICovXG4gIHJlYWRPbmx5PzogYm9vbGVhbjtcbiAgLyoqIOaYr+WQpuS9nOS4uuWQjuWkh+e8k+WtmCAqL1xuICBmYWxsYmFjaz86IGJvb2xlYW47XG59XG5cbi8qKlxuICogQGludGVyZmFjZSBDYWNoZU1hbmFnZXJTdGF0c1xuICogQGRlc2NyaXB0aW9uXG4gKiDnvJPlrZjnrqHnkIblmajnu5/orqHkv6Hmga/mjqXlj6PjgIJcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBDYWNoZU1hbmFnZXJTdGF0cyBleHRlbmRzIENhY2hlU3RhdHMge1xuICAvKiog5rS76LeD57yT5a2Y5bGC5pWw6YePICovXG4gIGFjdGl2ZUxheWVyczogbnVtYmVyO1xuICAvKiog5ZCE5bGC57uf6K6h5L+h5oGvICovXG4gIGxheWVyU3RhdHM6IFJlY29yZDxzdHJpbmcsIGFueT47XG4gIC8qKiDmnIDlkI7mm7TmlrDml7bpl7QgKi9cbiAgbGFzdFVwZGF0ZWQ6IERhdGU7XG59XG5cbi8qKlxuICogQGNsYXNzIENhY2hlTWFuYWdlclNlcnZpY2VcbiAqIEBkZXNjcmlwdGlvblxuICog57yT5a2Y566h55CG5Zmo5pyN5Yqh77yM5L2c5Li657yT5a2Y57O757uf55qE5qC45b+D5Y2P6LCD5Zmo44CCXG4gKlxuICog5Li76KaB5Yqf6IO95YyF5ous77yaXG4gKiAxLiDnrqHnkIblpJrkuKrnvJPlrZjlsYLvvIhMMeOAgUwy44CBTDPnrYnvvIlcbiAqIDIuIOWunueOsOe8k+WtmOetlueVpe+8iExSVeOAgUxGVeOAgUZJRk/nrYnvvIlcbiAqIDMuIOaPkOS+m+e7n+S4gOeahOe8k+WtmOaOpeWPo1xuICogNC4g55uR5o6n57yT5a2Y5oCn6IO95ZKM5YGl5bq354q25oCBXG4gKiA1LiDlpITnkIbnvJPlrZjlpLHmlYjlkozmm7TmlrBcbiAqIDYuIOaPkOS+m+e8k+WtmOe7n+iuoeWSjOWIhuaekFxuICpcbiAqIEBpbXBsZW1lbnRzIHtJQ2FjaGVTZXJ2aWNlfVxuICovXG5ASW5qZWN0YWJsZSgpXG5leHBvcnQgY2xhc3MgQ2FjaGVNYW5hZ2VyU2VydmljZSBpbXBsZW1lbnRzIElDYWNoZVNlcnZpY2Uge1xuICBwcml2YXRlIHJlYWRvbmx5IGxvZ2dlcjogUGlub0xvZ2dlclNlcnZpY2U7XG5cbiAgLyoqXG4gICAqIOe8k+WtmOWxguaYoOWwhO+8jOaMieS8mOWFiOe6p+aOkuW6j1xuICAgKi9cbiAgcHJpdmF0ZSByZWFkb25seSBsYXllcnMgPSBuZXcgTWFwPHN0cmluZywgQ2FjaGVMYXllckNvbmZpZz4oKTtcblxuICAvKipcbiAgICog57yT5a2Y566h55CG5Zmo6YWN572uXG4gICAqL1xuICBwcml2YXRlIGNvbmZpZzogQ2FjaGVNYW5hZ2VyQ29uZmlnO1xuXG4gIC8qKlxuICAgKiDnu5/orqHkv6Hmga9cbiAgICovXG4gIHByaXZhdGUgc3RhdHM6IENhY2hlTWFuYWdlclN0YXRzO1xuXG4gIC8qKlxuICAgKiDnm5Hmjqflrprml7blmahcbiAgICovXG4gIHByaXZhdGUgbW9uaXRvcmluZ1RpbWVyPzogTm9kZUpTLlRpbWVvdXQ7XG5cbiAgLyoqXG4gICAqIOa4heeQhuWumuaXtuWZqFxuICAgKi9cbiAgcHJpdmF0ZSBjbGVhbnVwVGltZXI/OiBOb2RlSlMuVGltZW91dDtcblxuICAvKipcbiAgICog6K+35rGC6K6h5pWw5ZmoXG4gICAqL1xuICBwcml2YXRlIHJlcXVlc3RDb3VudCA9IDA7XG5cbiAgLyoqXG4gICAqIOWRveS4reiuoeaVsOWZqFxuICAgKi9cbiAgcHJpdmF0ZSBoaXRDb3VudCA9IDA7XG5cbiAgLyoqXG4gICAqIOWTjeW6lOaXtumXtOe0r+iuoVxuICAgKi9cbiAgcHJpdmF0ZSB0b3RhbFJlc3BvbnNlVGltZSA9IDA7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgQEluamVjdCgnQ0FDSEVfTUFOQUdFUl9DT05GSUcnKSBjb25maWc6IENhY2hlTWFuYWdlckNvbmZpZyxcblxuICAgIHByaXZhdGUgcmVhZG9ubHkgZXZlbnRFbWl0dGVyOiBFdmVudEVtaXR0ZXIyLFxuICAgIGxvZ2dlcjogUGlub0xvZ2dlclNlcnZpY2UsXG4gICkge1xuICAgIHRoaXMubG9nZ2VyID0gbG9nZ2VyO1xuICAgIHRoaXMuY29uZmlnID0ge1xuICAgICAgZW5hYmxlZDogdHJ1ZSxcbiAgICAgIGRlZmF1bHRTdHJhdGVneTogQ2FjaGVTdHJhdGVneS5MUlUsXG4gICAgICBtb25pdG9yaW5nSW50ZXJ2YWw6IDMwMDAwLFxuICAgICAgY2xlYW51cEludGVydmFsOiA2MDAwMCxcbiAgICAgIG1heFNpemU6IDEwMDAwLFxuICAgICAgZW5hYmxlU3RhdHM6IHRydWUsXG4gICAgICBlbmFibGVFdmVudHM6IHRydWUsXG4gICAgICAuLi5jb25maWcsXG4gICAgfTtcblxuICAgIHRoaXMuc3RhdHMgPSB0aGlzLmluaXRpYWxpemVTdGF0cygpO1xuICAgIHRoaXMuaW5pdGlhbGl6ZUxheWVycygpO1xuICAgIHRoaXMuc3RhcnRNb25pdG9yaW5nKCk7XG4gICAgdGhpcy5zdGFydENsZWFudXAoKTtcblxuICAgIHRoaXMubG9nZ2VyLmluZm8oJ0NhY2hlTWFuYWdlclNlcnZpY2UgaW5pdGlhbGl6ZWQnLCBMb2dDb250ZXh0LkNBQ0hFKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAbWV0aG9kIGdldFxuICAgKiBAZGVzY3JpcHRpb24g5LuO57yT5a2Y5Lit6I635Y+W5YC8XG4gICAqIEBwYXJhbSBrZXkg57yT5a2Y6ZSuXG4gICAqIEByZXR1cm5zIHtQcm9taXNlPFQgfCBudWxsPn0g57yT5a2Y5YC8XG4gICAqL1xuICBhc3luYyBnZXQ8VCA9IGFueT4oa2V5OiBDYWNoZUtleSk6IFByb21pc2U8VCB8IG51bGw+IHtcbiAgICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuICAgIHRoaXMucmVxdWVzdENvdW50Kys7XG5cbiAgICB0cnkge1xuICAgICAgLy8g5oyJ5LyY5YWI57qn6YGN5Y6G57yT5a2Y5bGCXG4gICAgICBmb3IgKGNvbnN0IGxheWVyIG9mIHRoaXMuZ2V0U29ydGVkTGF5ZXJzKCkpIHtcbiAgICAgICAgaWYgKCFsYXllci5lbmFibGVkKSBjb250aW51ZTtcblxuICAgICAgICBjb25zdCB2YWx1ZSA9IGF3YWl0IGxheWVyLnNlcnZpY2UuZ2V0PFQ+KGtleSk7XG5cbiAgICAgICAgaWYgKHZhbHVlICE9PSBudWxsKSB7XG4gICAgICAgICAgLy8g57yT5a2Y5ZG95Lit77yM5pu05paw57uf6K6hXG4gICAgICAgICAgdGhpcy5oaXRDb3VudCsrO1xuICAgICAgICAgIHRoaXMudXBkYXRlU3RhdHMoc3RhcnRUaW1lKTtcblxuICAgICAgICAgIC8vIOWmguaenOWRveS4reeahOaYr+S9juS8mOWFiOe6p+Wxgu+8jOWwneivleaPkOWNh+WIsOmrmOS8mOWFiOe6p+WxglxuICAgICAgICAgIGlmIChsYXllci5wcmlvcml0eSA+IDEpIHtcbiAgICAgICAgICAgIHRoaXMucHJvbW90ZVRvSGlnaGVyTGF5ZXIoa2V5LCB2YWx1ZSwgbGF5ZXIucHJpb3JpdHkpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHRoaXMuZW1pdEV2ZW50KCdjYWNoZV9oaXQnLCB7IGtleSwgbGF5ZXI6IGxheWVyLm5hbWUsIHZhbHVlIH0pO1xuICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyDnvJPlrZjmnKrlkb3kuK1cbiAgICAgIHRoaXMudXBkYXRlU3RhdHMoc3RhcnRUaW1lKTtcbiAgICAgIHRoaXMuZW1pdEV2ZW50KCdjYWNoZV9taXNzJywgeyBrZXkgfSk7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhpcy5sb2dnZXIuZXJyb3IoXG4gICAgICAgIGBFcnJvciBnZXR0aW5nIGNhY2hlIHZhbHVlOiAke2tleS5rZXl9YCxcbiAgICAgICAgTG9nQ29udGV4dC5DQUNIRSxcbiAgICAgICAgdW5kZWZpbmVkLFxuICAgICAgICBlcnJvciBhcyBFcnJvcixcbiAgICAgICk7XG4gICAgICB0aGlzLmVtaXRFdmVudCgnY2FjaGVfZXJyb3InLCB7IGtleSwgZXJyb3IgfSk7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQG1ldGhvZCBzZXRcbiAgICogQGRlc2NyaXB0aW9uIOiuvue9rue8k+WtmOWAvFxuICAgKiBAcGFyYW0ga2V5IOe8k+WtmOmUrlxuICAgKiBAcGFyYW0gdmFsdWUg57yT5a2Y5YC8XG4gICAqIEBwYXJhbSBvcHRpb25zIOe8k+WtmOmAiemhuVxuICAgKiBAcmV0dXJucyB7UHJvbWlzZTxib29sZWFuPn0g5piv5ZCm5oiQ5YqfXG4gICAqL1xuICBhc3luYyBzZXQ8VCA9IGFueT4oXG4gICAga2V5OiBDYWNoZUtleSxcbiAgICB2YWx1ZTogVCxcbiAgICBvcHRpb25zPzogUGFydGlhbDxDYWNoZU9wdGlvbnM+LFxuICApOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IG1lcmdlZE9wdGlvbnMgPSB7IC4uLnRoaXMuY29uZmlnLmRlZmF1bHRPcHRpb25zLCAuLi5vcHRpb25zIH07XG4gICAgICBsZXQgc3VjY2VzcyA9IGZhbHNlO1xuXG4gICAgICAvLyDmjInkvJjlhYjnuqforr7nva7liLDmiYDmnInlkK/nlKjnmoTnvJPlrZjlsYJcbiAgICAgIGZvciAoY29uc3QgbGF5ZXIgb2YgdGhpcy5nZXRTb3J0ZWRMYXllcnMoKSkge1xuICAgICAgICBpZiAoIWxheWVyLmVuYWJsZWQgfHwgbGF5ZXIucmVhZE9ubHkpIGNvbnRpbnVlO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgbGF5ZXJTdWNjZXNzID0gYXdhaXQgbGF5ZXIuc2VydmljZS5zZXQoa2V5LCB2YWx1ZSwge1xuICAgICAgICAgICAgLi4ubGF5ZXIub3B0aW9ucyxcbiAgICAgICAgICAgIC4uLm1lcmdlZE9wdGlvbnMsXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgaWYgKGxheWVyU3VjY2Vzcykge1xuICAgICAgICAgICAgc3VjY2VzcyA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLmVtaXRFdmVudCgnY2FjaGVfc2V0JywgeyBrZXksIGxheWVyOiBsYXllci5uYW1lLCB2YWx1ZSB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgdGhpcy5sb2dnZXIud2FybihcbiAgICAgICAgICAgIGBGYWlsZWQgdG8gc2V0IGNhY2hlIGluIGxheWVyICR7bGF5ZXIubmFtZX06ICR7a2V5LmtleX1gLFxuICAgICAgICAgICAgTG9nQ29udGV4dC5DQUNIRSxcbiAgICAgICAgICAgIHVuZGVmaW5lZCxcbiAgICAgICAgICAgIGVycm9yIGFzIEVycm9yLFxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgdGhpcy51cGRhdGVTdGF0cyhzdGFydFRpbWUpO1xuICAgICAgcmV0dXJuIHN1Y2Nlc3M7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRoaXMubG9nZ2VyLmVycm9yKFxuICAgICAgICBgRXJyb3Igc2V0dGluZyBjYWNoZSB2YWx1ZTogJHtrZXkua2V5fWAsXG4gICAgICAgIExvZ0NvbnRleHQuQ0FDSEUsXG4gICAgICAgIHVuZGVmaW5lZCxcbiAgICAgICAgZXJyb3IgYXMgRXJyb3IsXG4gICAgICApO1xuICAgICAgdGhpcy5lbWl0RXZlbnQoJ2NhY2hlX2Vycm9yJywgeyBrZXksIGVycm9yIH0pO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBAbWV0aG9kIGRlbGV0ZVxuICAgKiBAZGVzY3JpcHRpb24g5Yig6Zmk57yT5a2Y5YC8XG4gICAqIEBwYXJhbSBrZXkg57yT5a2Y6ZSuXG4gICAqIEByZXR1cm5zIHtQcm9taXNlPGJvb2xlYW4+fSDmmK/lkKbmiJDlip9cbiAgICovXG4gIGFzeW5jIGRlbGV0ZShrZXk6IENhY2hlS2V5KTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcblxuICAgIHRyeSB7XG4gICAgICBsZXQgc3VjY2VzcyA9IGZhbHNlO1xuXG4gICAgICAvLyDku47miYDmnInnvJPlrZjlsYLliKDpmaRcbiAgICAgIGZvciAoY29uc3QgbGF5ZXIgb2YgdGhpcy5nZXRTb3J0ZWRMYXllcnMoKSkge1xuICAgICAgICBpZiAoIWxheWVyLmVuYWJsZWQgfHwgbGF5ZXIucmVhZE9ubHkpIGNvbnRpbnVlO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgbGF5ZXJTdWNjZXNzID0gYXdhaXQgbGF5ZXIuc2VydmljZS5kZWxldGUoa2V5KTtcbiAgICAgICAgICBpZiAobGF5ZXJTdWNjZXNzKSB7XG4gICAgICAgICAgICBzdWNjZXNzID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuZW1pdEV2ZW50KCdjYWNoZV9kZWxldGUnLCB7IGtleSwgbGF5ZXI6IGxheWVyLm5hbWUgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIHRoaXMubG9nZ2VyLndhcm4oXG4gICAgICAgICAgICBgRmFpbGVkIHRvIGRlbGV0ZSBjYWNoZSBmcm9tIGxheWVyICR7bGF5ZXIubmFtZX06ICR7a2V5LmtleX1gLFxuICAgICAgICAgICAgTG9nQ29udGV4dC5DQUNIRSxcbiAgICAgICAgICAgIHVuZGVmaW5lZCxcbiAgICAgICAgICAgIGVycm9yIGFzIEVycm9yLFxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgdGhpcy51cGRhdGVTdGF0cyhzdGFydFRpbWUpO1xuICAgICAgcmV0dXJuIHN1Y2Nlc3M7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRoaXMubG9nZ2VyLmVycm9yKFxuICAgICAgICBgRXJyb3IgZGVsZXRpbmcgY2FjaGUgdmFsdWU6ICR7a2V5LmtleX1gLFxuICAgICAgICBMb2dDb250ZXh0LkNBQ0hFLFxuICAgICAgICB1bmRlZmluZWQsXG4gICAgICAgIGVycm9yIGFzIEVycm9yLFxuICAgICAgKTtcbiAgICAgIHRoaXMuZW1pdEV2ZW50KCdjYWNoZV9lcnJvcicsIHsga2V5LCBlcnJvciB9KTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQG1ldGhvZCBleGlzdHNcbiAgICogQGRlc2NyaXB0aW9uIOajgOafpee8k+WtmOmUruaYr+WQpuWtmOWcqFxuICAgKiBAcGFyYW0ga2V5IOe8k+WtmOmUrlxuICAgKiBAcmV0dXJucyB7UHJvbWlzZTxib29sZWFuPn0g5piv5ZCm5a2Y5ZyoXG4gICAqL1xuICBhc3luYyBleGlzdHMoa2V5OiBDYWNoZUtleSk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XG4gICAgdGhpcy5yZXF1ZXN0Q291bnQrKztcblxuICAgIHRyeSB7XG4gICAgICAvLyDmo4Dmn6XmiYDmnInnvJPlrZjlsYJcbiAgICAgIGZvciAoY29uc3QgbGF5ZXIgb2YgdGhpcy5nZXRTb3J0ZWRMYXllcnMoKSkge1xuICAgICAgICBpZiAoIWxheWVyLmVuYWJsZWQpIGNvbnRpbnVlO1xuXG4gICAgICAgIGNvbnN0IGV4aXN0cyA9IGF3YWl0IGxheWVyLnNlcnZpY2UuZXhpc3RzKGtleSk7XG4gICAgICAgIGlmIChleGlzdHMpIHtcbiAgICAgICAgICB0aGlzLmhpdENvdW50Kys7XG4gICAgICAgICAgdGhpcy51cGRhdGVTdGF0cyhzdGFydFRpbWUpO1xuICAgICAgICAgIHRoaXMuZW1pdEV2ZW50KCdjYWNoZV9leGlzdHMnLCB7IGtleSwgbGF5ZXI6IGxheWVyLm5hbWUgfSk7XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgdGhpcy51cGRhdGVTdGF0cyhzdGFydFRpbWUpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aGlzLmxvZ2dlci5lcnJvcihcbiAgICAgICAgYEVycm9yIGNoZWNraW5nIGNhY2hlIGV4aXN0ZW5jZTogJHtrZXkua2V5fWAsXG4gICAgICAgIExvZ0NvbnRleHQuQ0FDSEUsXG4gICAgICAgIHVuZGVmaW5lZCxcbiAgICAgICAgZXJyb3IgYXMgRXJyb3IsXG4gICAgICApO1xuICAgICAgdGhpcy5lbWl0RXZlbnQoJ2NhY2hlX2Vycm9yJywgeyBrZXksIGVycm9yIH0pO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBAbWV0aG9kIGNsZWFyXG4gICAqIEBkZXNjcmlwdGlvbiDmuIXnqbrnvJPlrZhcbiAgICogQHBhcmFtIG5hbWVzcGFjZSDlkb3lkI3nqbrpl7RcbiAgICogQHJldHVybnMge1Byb21pc2U8Ym9vbGVhbj59IOaYr+WQpuaIkOWKn1xuICAgKi9cbiAgYXN5bmMgY2xlYXIobmFtZXNwYWNlPzogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcblxuICAgIHRyeSB7XG4gICAgICBsZXQgc3VjY2VzcyA9IGZhbHNlO1xuXG4gICAgICAvLyDmuIXnqbrmiYDmnInnvJPlrZjlsYJcbiAgICAgIGZvciAoY29uc3QgbGF5ZXIgb2YgdGhpcy5nZXRTb3J0ZWRMYXllcnMoKSkge1xuICAgICAgICBpZiAoIWxheWVyLmVuYWJsZWQgfHwgbGF5ZXIucmVhZE9ubHkpIGNvbnRpbnVlO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgbGF5ZXJTdWNjZXNzID0gYXdhaXQgbGF5ZXIuc2VydmljZS5jbGVhcihuYW1lc3BhY2UpO1xuICAgICAgICAgIGlmIChsYXllclN1Y2Nlc3MpIHtcbiAgICAgICAgICAgIHN1Y2Nlc3MgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5lbWl0RXZlbnQoJ2NhY2hlX2NsZWFyJywgeyBsYXllcjogbGF5ZXIubmFtZSwgbmFtZXNwYWNlIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICB0aGlzLmxvZ2dlci53YXJuKFxuICAgICAgICAgICAgYEZhaWxlZCB0byBjbGVhciBjYWNoZSBsYXllciAke2xheWVyLm5hbWV9YCxcbiAgICAgICAgICAgIExvZ0NvbnRleHQuQ0FDSEUsXG4gICAgICAgICAgICB1bmRlZmluZWQsXG4gICAgICAgICAgICBlcnJvciBhcyBFcnJvcixcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHRoaXMudXBkYXRlU3RhdHMoc3RhcnRUaW1lKTtcbiAgICAgIHJldHVybiBzdWNjZXNzO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aGlzLmxvZ2dlci5lcnJvcihcbiAgICAgICAgJ0Vycm9yIGNsZWFyaW5nIGNhY2hlJyxcbiAgICAgICAgTG9nQ29udGV4dC5DQUNIRSxcbiAgICAgICAgdW5kZWZpbmVkLFxuICAgICAgICBlcnJvciBhcyBFcnJvcixcbiAgICAgICk7XG4gICAgICB0aGlzLmVtaXRFdmVudCgnY2FjaGVfZXJyb3InLCB7IGVycm9yIH0pO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBAbWV0aG9kIGdldFN0YXRzXG4gICAqIEBkZXNjcmlwdGlvbiDojrflj5bnvJPlrZjnu5/orqHkv6Hmga9cbiAgICogQHJldHVybnMge1Byb21pc2U8Q2FjaGVTdGF0cz59IOe7n+iuoeS/oeaBr1xuICAgKi9cbiAgYXN5bmMgZ2V0U3RhdHMoKTogUHJvbWlzZTxDYWNoZVN0YXRzPiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIOabtOaWsOWQhOWxgue7n+iuoeS/oeaBr1xuICAgICAgY29uc3QgbGF5ZXJTdGF0czogUmVjb3JkPHN0cmluZywgYW55PiA9IHt9O1xuICAgICAgZm9yIChjb25zdCBbbmFtZSwgbGF5ZXJdIG9mIHRoaXMubGF5ZXJzKSB7XG4gICAgICAgIGlmIChsYXllci5lbmFibGVkKSB7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGxheWVyU3RhdHNbbmFtZV0gPSBhd2FpdCBsYXllci5zZXJ2aWNlLmdldFN0YXRzKCk7XG4gICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRoaXMubG9nZ2VyLndhcm4oXG4gICAgICAgICAgICAgIGBGYWlsZWQgdG8gZ2V0IHN0YXRzIGZvciBsYXllciAke25hbWV9YCxcbiAgICAgICAgICAgICAgTG9nQ29udGV4dC5DQUNIRSxcbiAgICAgICAgICAgICAgdW5kZWZpbmVkLFxuICAgICAgICAgICAgICBlcnJvciBhcyBFcnJvcixcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBsYXllclN0YXRzW25hbWVdID0gbnVsbDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8g6K6h566X5oC75L2T57uf6K6hXG4gICAgICB0aGlzLnN0YXRzLmhpdFJhdGUgPVxuICAgICAgICB0aGlzLnJlcXVlc3RDb3VudCA+IDAgPyB0aGlzLmhpdENvdW50IC8gdGhpcy5yZXF1ZXN0Q291bnQgOiAwO1xuICAgICAgdGhpcy5zdGF0cy5hY3RpdmVMYXllcnMgPSBBcnJheS5mcm9tKHRoaXMubGF5ZXJzLnZhbHVlcygpKS5maWx0ZXIoXG4gICAgICAgIGxheWVyID0+IGxheWVyLmVuYWJsZWQsXG4gICAgICApLmxlbmd0aDtcbiAgICAgIHRoaXMuc3RhdHMubGF5ZXJTdGF0cyA9IGxheWVyU3RhdHM7XG4gICAgICB0aGlzLnN0YXRzLmxhc3RVcGRhdGVkID0gbmV3IERhdGUoKTtcblxuICAgICAgcmV0dXJuIHsgLi4udGhpcy5zdGF0cyB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aGlzLmxvZ2dlci5lcnJvcihcbiAgICAgICAgJ0Vycm9yIGdldHRpbmcgY2FjaGUgc3RhdHMnLFxuICAgICAgICBMb2dDb250ZXh0LkNBQ0hFLFxuICAgICAgICB1bmRlZmluZWQsXG4gICAgICAgIGVycm9yIGFzIEVycm9yLFxuICAgICAgKTtcbiAgICAgIHJldHVybiB0aGlzLnN0YXRzO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBAbWV0aG9kIGdldEhlYWx0aFxuICAgKiBAZGVzY3JpcHRpb24g6I635Y+W57yT5a2Y5YGl5bq354q25oCBXG4gICAqIEByZXR1cm5zIHtQcm9taXNlPENhY2hlSGVhbHRoPn0g5YGl5bq354q25oCBXG4gICAqL1xuICBhc3luYyBnZXRIZWFsdGgoKTogUHJvbWlzZTxDYWNoZUhlYWx0aD4ge1xuICAgIHRyeSB7XG4gICAgICBsZXQgaGVhbHRoeUxheWVycyA9IDA7XG4gICAgICBsZXQgdG90YWxSZXNwb25zZVRpbWUgPSAwO1xuICAgICAgbGV0IGhhc0Vycm9yID0gZmFsc2U7XG4gICAgICBsZXQgZXJyb3JNZXNzYWdlID0gJyc7XG5cbiAgICAgIC8vIOajgOafpeWQhOWxguWBpeW6t+eKtuaAgVxuICAgICAgZm9yIChjb25zdCBbLCBsYXllcl0gb2YgdGhpcy5sYXllcnMpIHtcbiAgICAgICAgaWYgKGxheWVyLmVuYWJsZWQpIHtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgbGF5ZXJIZWFsdGggPSBhd2FpdCBsYXllci5zZXJ2aWNlLmdldEhlYWx0aCgpO1xuICAgICAgICAgICAgdG90YWxSZXNwb25zZVRpbWUgKz0gbGF5ZXJIZWFsdGgucmVzcG9uc2VUaW1lO1xuICAgICAgICAgICAgaWYgKGxheWVySGVhbHRoLmhlYWx0aHkpIHtcbiAgICAgICAgICAgICAgaGVhbHRoeUxheWVycysrO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgaGFzRXJyb3IgPSB0cnVlO1xuICAgICAgICAgICAgICBlcnJvck1lc3NhZ2UgPSBsYXllckhlYWx0aC5lcnJvciB8fCAnTGF5ZXIgdW5oZWFsdGh5JztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgaGFzRXJyb3IgPSB0cnVlO1xuICAgICAgICAgICAgZXJyb3JNZXNzYWdlID0gKGVycm9yIGFzIEVycm9yKS5tZXNzYWdlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBjb25zdCBhY3RpdmVMYXllcnMgPSBBcnJheS5mcm9tKHRoaXMubGF5ZXJzLnZhbHVlcygpKS5maWx0ZXIoXG4gICAgICAgIGxheWVyID0+IGxheWVyLmVuYWJsZWQsXG4gICAgICApLmxlbmd0aDtcbiAgICAgIGNvbnN0IGF2ZXJhZ2VSZXNwb25zZVRpbWUgPVxuICAgICAgICBhY3RpdmVMYXllcnMgPiAwID8gdG90YWxSZXNwb25zZVRpbWUgLyBhY3RpdmVMYXllcnMgOiAwO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBoZWFsdGh5OiAhaGFzRXJyb3IgJiYgaGVhbHRoeUxheWVycyA9PT0gYWN0aXZlTGF5ZXJzLFxuICAgICAgICBjb25uZWN0ZWQ6IGhlYWx0aHlMYXllcnMgPiAwLFxuICAgICAgICByZXNwb25zZVRpbWU6IGF2ZXJhZ2VSZXNwb25zZVRpbWUsXG4gICAgICAgIGVycm9yOiBoYXNFcnJvciA/IGVycm9yTWVzc2FnZSA6IHVuZGVmaW5lZCxcbiAgICAgICAgbGFzdENoZWNrOiBEYXRlLm5vdygpLFxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhpcy5sb2dnZXIuZXJyb3IoXG4gICAgICAgICdFcnJvciBnZXR0aW5nIGNhY2hlIGhlYWx0aCcsXG4gICAgICAgIExvZ0NvbnRleHQuQ0FDSEUsXG4gICAgICAgIHVuZGVmaW5lZCxcbiAgICAgICAgZXJyb3IgYXMgRXJyb3IsXG4gICAgICApO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgaGVhbHRoeTogZmFsc2UsXG4gICAgICAgIGNvbm5lY3RlZDogZmFsc2UsXG4gICAgICAgIHJlc3BvbnNlVGltZTogMCxcbiAgICAgICAgZXJyb3I6IChlcnJvciBhcyBFcnJvcikubWVzc2FnZSxcbiAgICAgICAgbGFzdENoZWNrOiBEYXRlLm5vdygpLFxuICAgICAgfTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQG1ldGhvZCBhZGRMYXllclxuICAgKiBAZGVzY3JpcHRpb24g5re75Yqg57yT5a2Y5bGCXG4gICAqIEBwYXJhbSBjb25maWcg57yT5a2Y5bGC6YWN572uXG4gICAqIEByZXR1cm5zIHtib29sZWFufSDmmK/lkKbmiJDlip9cbiAgICovXG4gIGFkZExheWVyKGNvbmZpZzogQ2FjaGVMYXllckNvbmZpZyk6IGJvb2xlYW4ge1xuICAgIHRyeSB7XG4gICAgICBpZiAodGhpcy5sYXllcnMuaGFzKGNvbmZpZy5uYW1lKSkge1xuICAgICAgICB0aGlzLmxvZ2dlci53YXJuKFxuICAgICAgICAgIGBDYWNoZSBsYXllciAke2NvbmZpZy5uYW1lfSBhbHJlYWR5IGV4aXN0cywgcmVwbGFjaW5nLi4uYCxcbiAgICAgICAgICBMb2dDb250ZXh0LkNBQ0hFLFxuICAgICAgICApO1xuICAgICAgfVxuXG4gICAgICB0aGlzLmxheWVycy5zZXQoY29uZmlnLm5hbWUsIHtcbiAgICAgICAgZW5hYmxlZDogdHJ1ZSxcbiAgICAgICAgcmVhZE9ubHk6IGZhbHNlLFxuICAgICAgICBmYWxsYmFjazogZmFsc2UsXG4gICAgICAgIC4uLmNvbmZpZyxcbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLmxvZ2dlci5pbmZvKFxuICAgICAgICBgQWRkZWQgY2FjaGUgbGF5ZXI6ICR7Y29uZmlnLm5hbWV9IHdpdGggcHJpb3JpdHkgJHtjb25maWcucHJpb3JpdHl9YCxcbiAgICAgICAgTG9nQ29udGV4dC5DQUNIRSxcbiAgICAgICk7XG4gICAgICB0aGlzLmVtaXRFdmVudCgnbGF5ZXJfYWRkZWQnLCB7XG4gICAgICAgIGxheWVyOiBjb25maWcubmFtZSxcbiAgICAgICAgcHJpb3JpdHk6IGNvbmZpZy5wcmlvcml0eSxcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRoaXMubG9nZ2VyLmVycm9yKFxuICAgICAgICBgRmFpbGVkIHRvIGFkZCBjYWNoZSBsYXllcjogJHtjb25maWcubmFtZX1gLFxuICAgICAgICBMb2dDb250ZXh0LkNBQ0hFLFxuICAgICAgICB1bmRlZmluZWQsXG4gICAgICAgIGVycm9yIGFzIEVycm9yLFxuICAgICAgKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQG1ldGhvZCByZW1vdmVMYXllclxuICAgKiBAZGVzY3JpcHRpb24g56e76Zmk57yT5a2Y5bGCXG4gICAqIEBwYXJhbSBuYW1lIOe8k+WtmOWxguWQjeensFxuICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0g5piv5ZCm5oiQ5YqfXG4gICAqL1xuICByZW1vdmVMYXllcihuYW1lOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICB0cnkge1xuICAgICAgaWYgKCF0aGlzLmxheWVycy5oYXMobmFtZSkpIHtcbiAgICAgICAgdGhpcy5sb2dnZXIud2FybihcbiAgICAgICAgICBgQ2FjaGUgbGF5ZXIgJHtuYW1lfSBkb2VzIG5vdCBleGlzdGAsXG4gICAgICAgICAgTG9nQ29udGV4dC5DQUNIRSxcbiAgICAgICAgKTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuXG4gICAgICB0aGlzLmxheWVycy5kZWxldGUobmFtZSk7XG4gICAgICB0aGlzLmxvZ2dlci5pbmZvKGBSZW1vdmVkIGNhY2hlIGxheWVyOiAke25hbWV9YCwgTG9nQ29udGV4dC5DQUNIRSk7XG4gICAgICB0aGlzLmVtaXRFdmVudCgnbGF5ZXJfcmVtb3ZlZCcsIHsgbGF5ZXI6IG5hbWUgfSk7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhpcy5sb2dnZXIuZXJyb3IoXG4gICAgICAgIGBGYWlsZWQgdG8gcmVtb3ZlIGNhY2hlIGxheWVyOiAke25hbWV9YCxcbiAgICAgICAgTG9nQ29udGV4dC5DQUNIRSxcbiAgICAgICAgdW5kZWZpbmVkLFxuICAgICAgICBlcnJvciBhcyBFcnJvcixcbiAgICAgICk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEBtZXRob2QgZW5hYmxlTGF5ZXJcbiAgICogQGRlc2NyaXB0aW9uIOWQr+eUqOe8k+WtmOWxglxuICAgKiBAcGFyYW0gbmFtZSDnvJPlrZjlsYLlkI3np7BcbiAgICogQHBhcmFtIGVuYWJsZWQg5piv5ZCm5ZCv55SoXG4gICAqIEByZXR1cm5zIHtib29sZWFufSDmmK/lkKbmiJDlip9cbiAgICovXG4gIGVuYWJsZUxheWVyKG5hbWU6IHN0cmluZywgZW5hYmxlZDogYm9vbGVhbik6IGJvb2xlYW4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBsYXllciA9IHRoaXMubGF5ZXJzLmdldChuYW1lKTtcbiAgICAgIGlmICghbGF5ZXIpIHtcbiAgICAgICAgdGhpcy5sb2dnZXIud2FybihcbiAgICAgICAgICBgQ2FjaGUgbGF5ZXIgJHtuYW1lfSBkb2VzIG5vdCBleGlzdGAsXG4gICAgICAgICAgTG9nQ29udGV4dC5DQUNIRSxcbiAgICAgICAgKTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuXG4gICAgICBsYXllci5lbmFibGVkID0gZW5hYmxlZDtcbiAgICAgIHRoaXMubG9nZ2VyLmluZm8oXG4gICAgICAgIGAke2VuYWJsZWQgPyAnRW5hYmxlZCcgOiAnRGlzYWJsZWQnfSBjYWNoZSBsYXllcjogJHtuYW1lfWAsXG4gICAgICAgIExvZ0NvbnRleHQuQ0FDSEUsXG4gICAgICApO1xuICAgICAgdGhpcy5lbWl0RXZlbnQoJ2xheWVyX3RvZ2dsZWQnLCB7IGxheWVyOiBuYW1lLCBlbmFibGVkIH0pO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRoaXMubG9nZ2VyLmVycm9yKFxuICAgICAgICBgRmFpbGVkIHRvIHRvZ2dsZSBjYWNoZSBsYXllcjogJHtuYW1lfWAsXG4gICAgICAgIExvZ0NvbnRleHQuQ0FDSEUsXG4gICAgICAgIHVuZGVmaW5lZCxcbiAgICAgICAgZXJyb3IgYXMgRXJyb3IsXG4gICAgICApO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBAbWV0aG9kIGdldExheWVyc1xuICAgKiBAZGVzY3JpcHRpb24g6I635Y+W5omA5pyJ57yT5a2Y5bGC5L+h5oGvXG4gICAqIEByZXR1cm5zIHtDYWNoZUxheWVyQ29uZmlnW119IOe8k+WtmOWxgumFjee9ruWIl+ihqFxuICAgKi9cbiAgZ2V0TGF5ZXJzKCk6IENhY2hlTGF5ZXJDb25maWdbXSB7XG4gICAgcmV0dXJuIEFycmF5LmZyb20odGhpcy5sYXllcnMudmFsdWVzKCkpLm1hcChsYXllciA9PiAoeyAuLi5sYXllciB9KSk7XG4gIH1cblxuICAvKipcbiAgICogQG1ldGhvZCByZXNldFN0YXRzXG4gICAqIEBkZXNjcmlwdGlvbiDph43nva7nvJPlrZjnu5/orqHkv6Hmga9cbiAgICovXG4gIGFzeW5jIHJlc2V0U3RhdHMoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIOmHjee9ruWQhOWxgue7n+iuoVxuICAgICAgZm9yIChjb25zdCBbbmFtZSwgbGF5ZXJdIG9mIHRoaXMubGF5ZXJzKSB7XG4gICAgICAgIGlmIChsYXllci5lbmFibGVkKSB7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGF3YWl0IGxheWVyLnNlcnZpY2UucmVzZXRTdGF0cygpO1xuICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICB0aGlzLmxvZ2dlci53YXJuKFxuICAgICAgICAgICAgICBgRmFpbGVkIHRvIHJlc2V0IHN0YXRzIGZvciBsYXllciAke25hbWV9YCxcbiAgICAgICAgICAgICAgTG9nQ29udGV4dC5DQUNIRSxcbiAgICAgICAgICAgICAgdW5kZWZpbmVkLFxuICAgICAgICAgICAgICBlcnJvciBhcyBFcnJvcixcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIOmHjee9rueuoeeQhuWZqOe7n+iuoVxuICAgICAgdGhpcy5yZXF1ZXN0Q291bnQgPSAwO1xuICAgICAgdGhpcy5oaXRDb3VudCA9IDA7XG4gICAgICB0aGlzLnRvdGFsUmVzcG9uc2VUaW1lID0gMDtcbiAgICAgIHRoaXMuc3RhdHMgPSB0aGlzLmluaXRpYWxpemVTdGF0cygpO1xuXG4gICAgICB0aGlzLmxvZ2dlci5pbmZvKCdDYWNoZSBzdGF0cyByZXNldCBzdWNjZXNzZnVsbHknLCBMb2dDb250ZXh0LkNBQ0hFKTtcbiAgICAgIHRoaXMuZW1pdEV2ZW50KCdzdGF0c19yZXNldCcsIHt9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhpcy5sb2dnZXIuZXJyb3IoXG4gICAgICAgICdGYWlsZWQgdG8gcmVzZXQgY2FjaGUgc3RhdHMnLFxuICAgICAgICBMb2dDb250ZXh0LkNBQ0hFLFxuICAgICAgICB1bmRlZmluZWQsXG4gICAgICAgIGVycm9yIGFzIEVycm9yLFxuICAgICAgKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQG1ldGhvZCBvbkRlc3Ryb3lcbiAgICogQGRlc2NyaXB0aW9uIOmUgOavgeaXtua4heeQhui1hOa6kFxuICAgKi9cbiAgb25EZXN0cm95KCk6IHZvaWQge1xuICAgIHRoaXMuc3RvcE1vbml0b3JpbmcoKTtcbiAgICB0aGlzLnN0b3BDbGVhbnVwKCk7XG4gICAgdGhpcy5sb2dnZXIuaW5mbygnQ2FjaGVNYW5hZ2VyU2VydmljZSBkZXN0cm95ZWQnLCBMb2dDb250ZXh0LkNBQ0hFKTtcbiAgfVxuXG4gIC8vIOengeacieaWueazlVxuXG4gIC8qKlxuICAgKiBAcHJpdmF0ZVxuICAgKiBAbWV0aG9kIGluaXRpYWxpemVTdGF0c1xuICAgKiBAZGVzY3JpcHRpb24g5Yid5aeL5YyW57uf6K6h5L+h5oGvXG4gICAqIEByZXR1cm5zIHtDYWNoZU1hbmFnZXJTdGF0c30g5Yid5aeL57uf6K6h5L+h5oGvXG4gICAqL1xuICBwcml2YXRlIGluaXRpYWxpemVTdGF0cygpOiBDYWNoZU1hbmFnZXJTdGF0cyB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHRvdGFsRW50cmllczogMCxcbiAgICAgIGhpdHM6IDAsXG4gICAgICBtaXNzZXM6IDAsXG4gICAgICBoaXRSYXRlOiAwLFxuICAgICAgdG90YWxTaXplOiAwLFxuICAgICAgYXZlcmFnZVNpemU6IDAsXG4gICAgICBleHBpcmVkRW50cmllczogMCxcbiAgICAgIGV2aWN0ZWRFbnRyaWVzOiAwLFxuICAgICAgbGFzdFJlc2V0OiBEYXRlLm5vdygpLFxuICAgICAgYWN0aXZlTGF5ZXJzOiAwLFxuICAgICAgbGF5ZXJTdGF0czoge30sXG4gICAgICBsYXN0VXBkYXRlZDogbmV3IERhdGUoKSxcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIEBwcml2YXRlXG4gICAqIEBtZXRob2QgaW5pdGlhbGl6ZUxheWVyc1xuICAgKiBAZGVzY3JpcHRpb24g5Yid5aeL5YyW57yT5a2Y5bGCXG4gICAqL1xuICBwcml2YXRlIGluaXRpYWxpemVMYXllcnMoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuY29uZmlnLmxheWVycykge1xuICAgICAgZm9yIChjb25zdCBsYXllckNvbmZpZyBvZiB0aGlzLmNvbmZpZy5sYXllcnMpIHtcbiAgICAgICAgdGhpcy5hZGRMYXllcihsYXllckNvbmZpZyk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEBwcml2YXRlXG4gICAqIEBtZXRob2QgZ2V0U29ydGVkTGF5ZXJzXG4gICAqIEBkZXNjcmlwdGlvbiDojrflj5bmjInkvJjlhYjnuqfmjpLluo/nmoTnvJPlrZjlsYJcbiAgICogQHJldHVybnMge0NhY2hlTGF5ZXJDb25maWdbXX0g5o6S5bqP5ZCO55qE57yT5a2Y5bGCXG4gICAqL1xuICBwcml2YXRlIGdldFNvcnRlZExheWVycygpOiBDYWNoZUxheWVyQ29uZmlnW10ge1xuICAgIHJldHVybiBBcnJheS5mcm9tKHRoaXMubGF5ZXJzLnZhbHVlcygpKVxuICAgICAgLmZpbHRlcihsYXllciA9PiBsYXllci5lbmFibGVkKVxuICAgICAgLnNvcnQoKGEsIGIpID0+IGEucHJpb3JpdHkgLSBiLnByaW9yaXR5KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcHJpdmF0ZVxuICAgKiBAbWV0aG9kIHByb21vdGVUb0hpZ2hlckxheWVyXG4gICAqIEBkZXNjcmlwdGlvbiDlsIbnvJPlrZjlgLzmj5DljYfliLDmm7Tpq5jkvJjlhYjnuqfnmoTlsYJcbiAgICogQHBhcmFtIGtleSDnvJPlrZjplK5cbiAgICogQHBhcmFtIHZhbHVlIOe8k+WtmOWAvFxuICAgKiBAcGFyYW0gY3VycmVudFByaW9yaXR5IOW9k+WJjeS8mOWFiOe6p1xuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBwcm9tb3RlVG9IaWdoZXJMYXllcjxUPihcbiAgICBrZXk6IENhY2hlS2V5LFxuICAgIHZhbHVlOiBULFxuICAgIGN1cnJlbnRQcmlvcml0eTogbnVtYmVyLFxuICApOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgaGlnaGVyTGF5ZXJzID0gQXJyYXkuZnJvbSh0aGlzLmxheWVycy52YWx1ZXMoKSlcbiAgICAgICAgLmZpbHRlcihcbiAgICAgICAgICBsYXllciA9PlxuICAgICAgICAgICAgbGF5ZXIuZW5hYmxlZCAmJlxuICAgICAgICAgICAgIWxheWVyLnJlYWRPbmx5ICYmXG4gICAgICAgICAgICBsYXllci5wcmlvcml0eSA8IGN1cnJlbnRQcmlvcml0eSxcbiAgICAgICAgKVxuICAgICAgICAuc29ydCgoYSwgYikgPT4gYS5wcmlvcml0eSAtIGIucHJpb3JpdHkpO1xuXG4gICAgICBmb3IgKGNvbnN0IGxheWVyIG9mIGhpZ2hlckxheWVycykge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGF3YWl0IGxheWVyLnNlcnZpY2Uuc2V0KGtleSwgdmFsdWUpO1xuICAgICAgICAgIHRoaXMuZW1pdEV2ZW50KCdjYWNoZV9wcm9tb3RlZCcsIHtcbiAgICAgICAgICAgIGtleSxcbiAgICAgICAgICAgIGZyb21Qcmlvcml0eTogY3VycmVudFByaW9yaXR5LFxuICAgICAgICAgICAgdG9Qcmlvcml0eTogbGF5ZXIucHJpb3JpdHksXG4gICAgICAgICAgICBsYXllcjogbGF5ZXIubmFtZSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICB0aGlzLmxvZ2dlci53YXJuKFxuICAgICAgICAgICAgYEZhaWxlZCB0byBwcm9tb3RlIGNhY2hlIHRvIGxheWVyICR7bGF5ZXIubmFtZX06ICR7a2V5LmtleX1gLFxuICAgICAgICAgICAgTG9nQ29udGV4dC5DQUNIRSxcbiAgICAgICAgICAgIHVuZGVmaW5lZCxcbiAgICAgICAgICAgIGVycm9yIGFzIEVycm9yLFxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhpcy5sb2dnZXIuZXJyb3IoXG4gICAgICAgIGBFcnJvciBwcm9tb3RpbmcgY2FjaGU6ICR7a2V5LmtleX1gLFxuICAgICAgICBMb2dDb250ZXh0LkNBQ0hFLFxuICAgICAgICB1bmRlZmluZWQsXG4gICAgICAgIGVycm9yIGFzIEVycm9yLFxuICAgICAgKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQHByaXZhdGVcbiAgICogQG1ldGhvZCB1cGRhdGVTdGF0c1xuICAgKiBAZGVzY3JpcHRpb24g5pu05paw57uf6K6h5L+h5oGvXG4gICAqIEBwYXJhbSBzdGFydFRpbWUg5byA5aeL5pe26Ze0XG4gICAqL1xuICBwcml2YXRlIHVwZGF0ZVN0YXRzKHN0YXJ0VGltZTogbnVtYmVyKTogdm9pZCB7XG4gICAgY29uc3QgcmVzcG9uc2VUaW1lID0gRGF0ZS5ub3coKSAtIHN0YXJ0VGltZTtcbiAgICB0aGlzLnRvdGFsUmVzcG9uc2VUaW1lICs9IHJlc3BvbnNlVGltZTtcbiAgICB0aGlzLnN0YXRzLmhpdHMgPSB0aGlzLmhpdENvdW50O1xuICAgIHRoaXMuc3RhdHMubWlzc2VzID0gdGhpcy5yZXF1ZXN0Q291bnQgLSB0aGlzLmhpdENvdW50O1xuICB9XG5cbiAgLyoqXG4gICAqIEBwcml2YXRlXG4gICAqIEBtZXRob2QgZW1pdEV2ZW50XG4gICAqIEBkZXNjcmlwdGlvbiDlj5HpgIHnvJPlrZjkuovku7ZcbiAgICogQHBhcmFtIHR5cGUg5LqL5Lu257G75Z6LXG4gICAqIEBwYXJhbSBkYXRhIOS6i+S7tuaVsOaNrlxuICAgKi9cbiAgcHJpdmF0ZSBlbWl0RXZlbnQodHlwZTogc3RyaW5nLCBfZGF0YTogUmVjb3JkPHN0cmluZywgdW5rbm93bj4pOiB2b2lkIHtcbiAgICBpZiAodGhpcy5jb25maWcuZW5hYmxlRXZlbnRzKSB7XG4gICAgICB0cnkge1xuICAgICAgICB0aGlzLmV2ZW50RW1pdHRlci5lbWl0KGBjYWNoZS4ke3R5cGV9YCwge1xuICAgICAgICAgIHR5cGUsXG4gICAgICAgICAgZGF0YTogX2RhdGEsXG4gICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgICAgICAgIG1hbmFnZXJJZDogJ2NhY2hlLW1hbmFnZXInLFxuICAgICAgICB9KTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIHRoaXMubG9nZ2VyLndhcm4oXG4gICAgICAgICAgYEZhaWxlZCB0byBlbWl0IGNhY2hlIGV2ZW50OiAke3R5cGV9YCxcbiAgICAgICAgICBMb2dDb250ZXh0LkNBQ0hFLFxuICAgICAgICAgIHVuZGVmaW5lZCxcbiAgICAgICAgICBlcnJvciBhcyBFcnJvcixcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQHByaXZhdGVcbiAgICogQG1ldGhvZCBzdGFydE1vbml0b3JpbmdcbiAgICogQGRlc2NyaXB0aW9uIOW8gOWni+ebkeaOp1xuICAgKi9cbiAgcHJpdmF0ZSBzdGFydE1vbml0b3JpbmcoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuY29uZmlnLm1vbml0b3JpbmdJbnRlcnZhbCAmJiB0aGlzLmNvbmZpZy5tb25pdG9yaW5nSW50ZXJ2YWwgPiAwKSB7XG4gICAgICB0aGlzLm1vbml0b3JpbmdUaW1lciA9IHNldEludGVydmFsKGFzeW5jICgpID0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBhd2FpdCB0aGlzLnBlcmZvcm1Nb25pdG9yaW5nKCk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgdGhpcy5sb2dnZXIuZXJyb3IoXG4gICAgICAgICAgICAnQ2FjaGUgbW9uaXRvcmluZyBmYWlsZWQnLFxuICAgICAgICAgICAgTG9nQ29udGV4dC5DQUNIRSxcbiAgICAgICAgICAgIHVuZGVmaW5lZCxcbiAgICAgICAgICAgIGVycm9yIGFzIEVycm9yLFxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgIH0sIHRoaXMuY29uZmlnLm1vbml0b3JpbmdJbnRlcnZhbCk7XG5cbiAgICAgIHRoaXMubG9nZ2VyLmluZm8oXG4gICAgICAgIGBTdGFydGVkIGNhY2hlIG1vbml0b3JpbmcsIGludGVydmFsOiAke3RoaXMuY29uZmlnLm1vbml0b3JpbmdJbnRlcnZhbH1tc2AsXG4gICAgICAgIExvZ0NvbnRleHQuQ0FDSEUsXG4gICAgICApO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBAcHJpdmF0ZVxuICAgKiBAbWV0aG9kIHN0b3BNb25pdG9yaW5nXG4gICAqIEBkZXNjcmlwdGlvbiDlgZzmraLnm5HmjqdcbiAgICovXG4gIHByaXZhdGUgc3RvcE1vbml0b3JpbmcoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMubW9uaXRvcmluZ1RpbWVyKSB7XG4gICAgICBjbGVhckludGVydmFsKHRoaXMubW9uaXRvcmluZ1RpbWVyKTtcbiAgICAgIHRoaXMubW9uaXRvcmluZ1RpbWVyID0gdW5kZWZpbmVkO1xuICAgICAgdGhpcy5sb2dnZXIuaW5mbygnU3RvcHBlZCBjYWNoZSBtb25pdG9yaW5nJywgTG9nQ29udGV4dC5DQUNIRSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEBwcml2YXRlXG4gICAqIEBtZXRob2Qgc3RhcnRDbGVhbnVwXG4gICAqIEBkZXNjcmlwdGlvbiDlvIDlp4vmuIXnkIZcbiAgICovXG4gIHByaXZhdGUgc3RhcnRDbGVhbnVwKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmNvbmZpZy5jbGVhbnVwSW50ZXJ2YWwgJiYgdGhpcy5jb25maWcuY2xlYW51cEludGVydmFsID4gMCkge1xuICAgICAgdGhpcy5jbGVhbnVwVGltZXIgPSBzZXRJbnRlcnZhbChhc3luYyAoKSA9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgYXdhaXQgdGhpcy5wZXJmb3JtQ2xlYW51cCgpO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIHRoaXMubG9nZ2VyLmVycm9yKFxuICAgICAgICAgICAgJ0NhY2hlIGNsZWFudXAgZmFpbGVkJyxcbiAgICAgICAgICAgIExvZ0NvbnRleHQuQ0FDSEUsXG4gICAgICAgICAgICB1bmRlZmluZWQsXG4gICAgICAgICAgICBlcnJvciBhcyBFcnJvcixcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICB9LCB0aGlzLmNvbmZpZy5jbGVhbnVwSW50ZXJ2YWwpO1xuXG4gICAgICB0aGlzLmxvZ2dlci5pbmZvKFxuICAgICAgICBgU3RhcnRlZCBjYWNoZSBjbGVhbnVwLCBpbnRlcnZhbDogJHt0aGlzLmNvbmZpZy5jbGVhbnVwSW50ZXJ2YWx9bXNgLFxuICAgICAgICBMb2dDb250ZXh0LkNBQ0hFLFxuICAgICAgKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQHByaXZhdGVcbiAgICogQG1ldGhvZCBzdG9wQ2xlYW51cFxuICAgKiBAZGVzY3JpcHRpb24g5YGc5q2i5riF55CGXG4gICAqL1xuICBwcml2YXRlIHN0b3BDbGVhbnVwKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmNsZWFudXBUaW1lcikge1xuICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmNsZWFudXBUaW1lcik7XG4gICAgICB0aGlzLmNsZWFudXBUaW1lciA9IHVuZGVmaW5lZDtcbiAgICAgIHRoaXMubG9nZ2VyLmluZm8oJ1N0b3BwZWQgY2FjaGUgY2xlYW51cCcsIExvZ0NvbnRleHQuQ0FDSEUpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBAcHJpdmF0ZVxuICAgKiBAbWV0aG9kIHBlcmZvcm1Nb25pdG9yaW5nXG4gICAqIEBkZXNjcmlwdGlvbiDmiafooYznm5HmjqdcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgcGVyZm9ybU1vbml0b3JpbmcoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGhlYWx0aCA9IGF3YWl0IHRoaXMuZ2V0SGVhbHRoKCk7XG4gICAgICBjb25zdCBzdGF0cyA9IGF3YWl0IHRoaXMuZ2V0U3RhdHMoKTtcblxuICAgICAgdGhpcy5lbWl0RXZlbnQoJ21vbml0b3JpbmcnLCB7IGhlYWx0aCwgc3RhdHMgfSk7XG5cbiAgICAgIC8vIOajgOafpeWBpeW6t+eKtuaAgVxuICAgICAgaWYgKCFoZWFsdGguaGVhbHRoeSkge1xuICAgICAgICB0aGlzLmxvZ2dlci53YXJuKCdDYWNoZSBoZWFsdGggY2hlY2sgZmFpbGVkJywgTG9nQ29udGV4dC5DQUNIRSk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRoaXMubG9nZ2VyLmVycm9yKFxuICAgICAgICAnQ2FjaGUgbW9uaXRvcmluZyBleGVjdXRpb24gZmFpbGVkJyxcbiAgICAgICAgTG9nQ29udGV4dC5DQUNIRSxcbiAgICAgICAgdW5kZWZpbmVkLFxuICAgICAgICBlcnJvciBhcyBFcnJvcixcbiAgICAgICk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEBwcml2YXRlXG4gICAqIEBtZXRob2QgcGVyZm9ybUNsZWFudXBcbiAgICogQGRlc2NyaXB0aW9uIOaJp+ihjOa4heeQhlxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBwZXJmb3JtQ2xlYW51cCgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgLy8g5riF55CG6L+H5pyf55qE57yT5a2Y6aG5XG4gICAgICBmb3IgKGNvbnN0IGxheWVyIG9mIHRoaXMuZ2V0U29ydGVkTGF5ZXJzKCkpIHtcbiAgICAgICAgaWYgKGxheWVyLmVuYWJsZWQgJiYgIWxheWVyLnJlYWRPbmx5KSB7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIOi/memHjOWPr+S7peiwg+eUqOWQhOWxgueahOa4heeQhuaWueazle+8jOWmguaenOacieeahOivnVxuICAgICAgICAgICAgdGhpcy5lbWl0RXZlbnQoJ2NsZWFudXAnLCB7IGxheWVyOiBsYXllci5uYW1lIH0pO1xuICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICB0aGlzLmxvZ2dlci53YXJuKFxuICAgICAgICAgICAgICBgRmFpbGVkIHRvIGNsZWFudXAgbGF5ZXIgJHtsYXllci5uYW1lfWAsXG4gICAgICAgICAgICAgIExvZ0NvbnRleHQuQ0FDSEUsXG4gICAgICAgICAgICAgIHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgZXJyb3IgYXMgRXJyb3IsXG4gICAgICAgICAgICApO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICB0aGlzLmxvZ2dlci5kZWJ1ZygnQ2FjaGUgY2xlYW51cCBjb21wbGV0ZWQnLCBMb2dDb250ZXh0LkNBQ0hFKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhpcy5sb2dnZXIuZXJyb3IoXG4gICAgICAgICdDYWNoZSBjbGVhbnVwIGV4ZWN1dGlvbiBmYWlsZWQnLFxuICAgICAgICBMb2dDb250ZXh0LkNBQ0hFLFxuICAgICAgICB1bmRlZmluZWQsXG4gICAgICAgIGVycm9yIGFzIEVycm9yLFxuICAgICAgKTtcbiAgICB9XG4gIH1cbn1cbiJdLCJ2ZXJzaW9uIjozfQ==