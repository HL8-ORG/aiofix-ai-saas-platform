b2ed04ae313383468029148d2b2f5c37
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const testing_1 = require("@nestjs/testing");
const pino_logger_config_service_1 = require("./pino-logger-config.service");
const logging_interface_1 = require("../interfaces/logging.interface");
describe('PinoLoggerConfigService', () => {
    let service;
    let originalEnv;
    beforeEach(async () => {
        // 保存原始环境变量
        originalEnv = { ...process.env };
        // 清理可能影响测试的环境变量
        delete process.env.LOG_LEVEL;
        delete process.env.LOG_FORMAT;
        delete process.env.LOG_FILE_PATH;
        delete process.env.LOG_REMOTE_URL;
        delete process.env.LOG_REMOTE_TOKEN;
        delete process.env.NODE_ENV;
        const module = await testing_1.Test.createTestingModule({
            providers: [pino_logger_config_service_1.PinoLoggerConfigService],
        }).compile();
        service = module.get(pino_logger_config_service_1.PinoLoggerConfigService);
    });
    afterEach(() => {
        // 恢复原始环境变量
        process.env = originalEnv;
    });
    describe('初始化', () => {
        it('应该使用默认配置初始化', () => {
            const config = service.getConfig();
            expect(config.level).toBe('info');
            expect(config.format).toBe(logging_interface_1.LogFormat.JSON);
            expect(config.colorize).toBe(false);
            expect(config.timestamp).toBe(true);
            expect(config.requestId).toBe(true);
            expect(config.tenantId).toBe(true);
            expect(config.userId).toBe(true);
            expect(config.performance).toBe(true);
            expect(config.stackTrace).toBe(true);
        });
        it('应该使用自定义配置初始化', async () => {
            const customConfig = {
                level: 'debug',
                format: logging_interface_1.LogFormat.TEXT,
                colorize: true,
            };
            const module = await testing_1.Test.createTestingModule({
                providers: [
                    {
                        provide: pino_logger_config_service_1.PinoLoggerConfigService,
                        useFactory: () => new pino_logger_config_service_1.PinoLoggerConfigService(customConfig),
                    },
                ],
            }).compile();
            const customService = module.get(pino_logger_config_service_1.PinoLoggerConfigService);
            const config = customService.getConfig();
            expect(config.level).toBe('debug');
            expect(config.format).toBe(logging_interface_1.LogFormat.TEXT);
            expect(config.colorize).toBe(true);
        });
        it('应该从环境变量读取配置', async () => {
            process.env.LOG_LEVEL = 'warn';
            process.env.LOG_FORMAT = 'text';
            process.env.NODE_ENV = 'development';
            const module = await testing_1.Test.createTestingModule({
                providers: [pino_logger_config_service_1.PinoLoggerConfigService],
            }).compile();
            const envService = module.get(pino_logger_config_service_1.PinoLoggerConfigService);
            const config = envService.getConfig();
            expect(config.level).toBe('warn');
            expect(config.format).toBe('text');
            expect(config.colorize).toBe(true); // development环境应该启用colorize
        });
    });
    describe('配置管理', () => {
        it('应该获取当前配置', () => {
            const config = service.getConfig();
            expect(config).toBeDefined();
            expect(typeof config).toBe('object');
            expect(config.level).toBeDefined();
            expect(config.format).toBeDefined();
        });
        it('应该更新配置', () => {
            const newConfig = {
                level: 'debug',
                format: logging_interface_1.LogFormat.TEXT,
                colorize: true,
            };
            service.updateConfig(newConfig);
            const config = service.getConfig();
            expect(config.level).toBe('debug');
            expect(config.format).toBe(logging_interface_1.LogFormat.TEXT);
            expect(config.colorize).toBe(true);
        });
        it('应该部分更新配置', () => {
            const originalConfig = service.getConfig();
            service.updateConfig({ level: 'error' });
            const config = service.getConfig();
            expect(config.level).toBe('error');
            expect(config.format).toBe(originalConfig.format);
            expect(config.colorize).toBe(originalConfig.colorize);
        });
        it('应该重置为默认配置', () => {
            // 先修改配置
            service.updateConfig({ level: 'debug', colorize: true });
            // 重置为默认配置
            service.resetToDefaults();
            const config = service.getConfig();
            expect(config.level).toBe('info');
            expect(config.colorize).toBe(false);
        });
    });
    describe('日志级别管理', () => {
        it('应该获取当前日志级别', () => {
            const level = service.getLevel();
            expect(level).toBe('info');
        });
        it('应该设置日志级别', () => {
            service.setLevel('debug');
            expect(service.getLevel()).toBe('debug');
        });
        it('应该支持所有有效的日志级别', () => {
            const validLevels = [
                'fatal',
                'error',
                'warn',
                'info',
                'debug',
                'trace',
            ];
            validLevels.forEach(level => {
                service.setLevel(level);
                expect(service.getLevel()).toBe(level);
            });
        });
    });
    describe('日志格式管理', () => {
        it('应该获取当前日志格式', () => {
            const format = service.getFormat();
            expect(format).toBe(logging_interface_1.LogFormat.JSON);
        });
        it('应该设置日志格式', () => {
            service.setFormat(logging_interface_1.LogFormat.TEXT);
            expect(service.getFormat()).toBe(logging_interface_1.LogFormat.TEXT);
        });
        it('应该支持所有有效的日志格式', () => {
            const validFormats = [logging_interface_1.LogFormat.JSON, logging_interface_1.LogFormat.TEXT];
            validFormats.forEach(format => {
                service.setFormat(format);
                expect(service.getFormat()).toBe(format);
            });
        });
    });
    describe('环境检测', () => {
        it('应该正确检测生产环境', async () => {
            process.env.NODE_ENV = 'production';
            const module = await testing_1.Test.createTestingModule({
                providers: [pino_logger_config_service_1.PinoLoggerConfigService],
            }).compile();
            const prodService = module.get(pino_logger_config_service_1.PinoLoggerConfigService);
            expect(prodService.isProduction()).toBe(true);
            expect(prodService.isDevelopment()).toBe(false);
        });
        it('应该正确检测开发环境', async () => {
            process.env.NODE_ENV = 'development';
            const module = await testing_1.Test.createTestingModule({
                providers: [pino_logger_config_service_1.PinoLoggerConfigService],
            }).compile();
            const devService = module.get(pino_logger_config_service_1.PinoLoggerConfigService);
            expect(devService.isProduction()).toBe(false);
            expect(devService.isDevelopment()).toBe(true);
        });
        it('应该正确检测测试环境', async () => {
            process.env.NODE_ENV = 'test';
            const module = await testing_1.Test.createTestingModule({
                providers: [pino_logger_config_service_1.PinoLoggerConfigService],
            }).compile();
            const testService = module.get(pino_logger_config_service_1.PinoLoggerConfigService);
            expect(testService.isProduction()).toBe(false);
            expect(testService.isDevelopment()).toBe(true);
        });
    });
    describe('美化格式判断', () => {
        it('开发环境应该使用美化格式', async () => {
            process.env.NODE_ENV = 'development';
            const module = await testing_1.Test.createTestingModule({
                providers: [pino_logger_config_service_1.PinoLoggerConfigService],
            }).compile();
            const devService = module.get(pino_logger_config_service_1.PinoLoggerConfigService);
            devService.setFormat(logging_interface_1.LogFormat.TEXT);
            expect(devService.shouldUsePrettyFormat()).toBe(true);
        });
        it('生产环境不应该使用美化格式', async () => {
            process.env.NODE_ENV = 'production';
            const module = await testing_1.Test.createTestingModule({
                providers: [pino_logger_config_service_1.PinoLoggerConfigService],
            }).compile();
            const prodService = module.get(pino_logger_config_service_1.PinoLoggerConfigService);
            prodService.setFormat(logging_interface_1.LogFormat.TEXT);
            expect(prodService.shouldUsePrettyFormat()).toBe(false);
        });
        it('JSON格式不应该使用美化格式', async () => {
            process.env.NODE_ENV = 'development';
            const module = await testing_1.Test.createTestingModule({
                providers: [pino_logger_config_service_1.PinoLoggerConfigService],
            }).compile();
            const devService = module.get(pino_logger_config_service_1.PinoLoggerConfigService);
            devService.setFormat(logging_interface_1.LogFormat.JSON);
            expect(devService.shouldUsePrettyFormat()).toBe(false);
        });
    });
    describe('配置验证', () => {
        it('应该验证有效的日志级别', () => {
            const validLevels = [
                'fatal',
                'error',
                'warn',
                'info',
                'debug',
                'trace',
            ];
            validLevels.forEach(level => {
                expect(() => {
                    service.updateConfig({ level });
                }).not.toThrow();
            });
        });
        it('应该验证有效的日志格式', () => {
            const validFormats = [logging_interface_1.LogFormat.JSON, logging_interface_1.LogFormat.TEXT];
            validFormats.forEach(format => {
                expect(() => {
                    service.updateConfig({ format });
                }).not.toThrow();
            });
        });
        it('应该验证文件轮转配置', () => {
            const validRotationConfig = {
                rotation: {
                    maxSize: '10m',
                    maxFiles: 5,
                    interval: '1d',
                },
            };
            expect(() => {
                service.updateConfig(validRotationConfig);
            }).not.toThrow();
        });
        it('应该验证远程日志配置', () => {
            const validRemoteConfig = {
                remote: {
                    url: 'https://logs.example.com',
                    token: 'secret-token',
                    timeout: 5000,
                    retries: 3,
                },
            };
            expect(() => {
                service.updateConfig(validRemoteConfig);
            }).not.toThrow();
        });
    });
    describe('配置验证错误', () => {
        it('应该拒绝无效的日志级别', () => {
            expect(() => {
                service.updateConfig({ level: 'invalid' });
            }).toThrow('Invalid log level');
        });
        it('应该拒绝无效的日志格式', () => {
            expect(() => {
                service.updateConfig({ format: 'invalid' });
            }).toThrow('Invalid log format');
        });
        it('应该拒绝无效的文件大小格式', () => {
            expect(() => {
                service.updateConfig({
                    rotation: {
                        maxSize: 'invalid-size',
                        maxFiles: 5,
                        interval: '1d',
                    },
                });
            }).toThrow('Invalid maxSize format');
        });
        it('应该拒绝缺少URL的远程日志配置', () => {
            expect(() => {
                service.updateConfig({
                    remote: {
                        url: '',
                        token: 'secret-token',
                        timeout: 5000,
                        retries: 3,
                    },
                });
            }).toThrow('Remote logging URL is required');
        });
        it('应该拒绝负数的超时时间', () => {
            expect(() => {
                service.updateConfig({
                    remote: {
                        url: 'https://logs.example.com',
                        token: 'secret-token',
                        timeout: -1,
                        retries: 3,
                    },
                });
            }).toThrow('Remote logging timeout must be positive');
        });
        it('应该拒绝负数的重试次数', () => {
            expect(() => {
                service.updateConfig({
                    remote: {
                        url: 'https://logs.example.com',
                        token: 'secret-token',
                        timeout: 5000,
                        retries: -1,
                    },
                });
            }).toThrow('Remote logging retries must be non-negative');
        });
    });
    describe('环境变量配置', () => {
        it('应该从环境变量读取日志级别', async () => {
            process.env.LOG_LEVEL = 'error';
            const module = await testing_1.Test.createTestingModule({
                providers: [pino_logger_config_service_1.PinoLoggerConfigService],
            }).compile();
            const envService = module.get(pino_logger_config_service_1.PinoLoggerConfigService);
            expect(envService.getLevel()).toBe('error');
        });
        it('应该从环境变量读取日志格式', async () => {
            process.env.LOG_FORMAT = 'text';
            const module = await testing_1.Test.createTestingModule({
                providers: [pino_logger_config_service_1.PinoLoggerConfigService],
            }).compile();
            const envService = module.get(pino_logger_config_service_1.PinoLoggerConfigService);
            expect(envService.getFormat()).toBe('text');
        });
        it('应该从环境变量读取日志文件路径', async () => {
            process.env.LOG_FILE_PATH = '/var/log/app.log';
            const module = await testing_1.Test.createTestingModule({
                providers: [pino_logger_config_service_1.PinoLoggerConfigService],
            }).compile();
            const envService = module.get(pino_logger_config_service_1.PinoLoggerConfigService);
            const config = envService.getConfig();
            expect(config.filePath).toBe('/var/log/app.log');
        });
        it('应该从环境变量读取远程日志配置', async () => {
            process.env.LOG_REMOTE_URL = 'https://logs.example.com';
            process.env.LOG_REMOTE_TOKEN = 'secret-token';
            const module = await testing_1.Test.createTestingModule({
                providers: [pino_logger_config_service_1.PinoLoggerConfigService],
            }).compile();
            const envService = module.get(pino_logger_config_service_1.PinoLoggerConfigService);
            const config = envService.getConfig();
            expect(config.remote).toBeDefined();
            expect(config.remote?.url).toBe('https://logs.example.com');
            expect(config.remote?.token).toBe('secret-token');
            expect(config.remote?.timeout).toBe(5000);
            expect(config.remote?.retries).toBe(3);
        });
    });
    describe('配置合并', () => {
        it('应该正确合并默认配置和自定义配置', async () => {
            const customConfig = {
                level: 'debug',
                colorize: true,
                timestamp: false,
            };
            const module = await testing_1.Test.createTestingModule({
                providers: [
                    {
                        provide: pino_logger_config_service_1.PinoLoggerConfigService,
                        useFactory: () => new pino_logger_config_service_1.PinoLoggerConfigService(customConfig),
                    },
                ],
            }).compile();
            const customService = module.get(pino_logger_config_service_1.PinoLoggerConfigService);
            const config = customService.getConfig();
            // 自定义配置应该覆盖默认配置
            expect(config.level).toBe('debug');
            expect(config.colorize).toBe(true);
            expect(config.timestamp).toBe(false);
            // 未指定的配置应该保持默认值
            expect(config.requestId).toBe(true);
            expect(config.tenantId).toBe(true);
            expect(config.userId).toBe(true);
        });
        it('应该正确处理环境变量和自定义配置的优先级', async () => {
            process.env.LOG_LEVEL = 'warn';
            process.env.LOG_FORMAT = 'text';
            const customConfig = {
                level: 'debug',
                colorize: true,
            };
            const module = await testing_1.Test.createTestingModule({
                providers: [
                    {
                        provide: pino_logger_config_service_1.PinoLoggerConfigService,
                        useFactory: () => new pino_logger_config_service_1.PinoLoggerConfigService(customConfig),
                    },
                ],
            }).compile();
            const customService = module.get(pino_logger_config_service_1.PinoLoggerConfigService);
            const config = customService.getConfig();
            // 环境变量应该覆盖默认配置，但自定义配置应该覆盖环境变量
            expect(config.level).toBe('debug'); // 自定义配置优先级最高
            expect(config.format).toBe('text'); // 环境变量
            expect(config.colorize).toBe(true); // 自定义配置
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvYXJsaWdsZS9WMS9BaW9maXgvYWlvZml4LWFpLXNhYXMtcGxhdGZvcm0vcGFja2FnZXMvbG9nZ2luZy9zcmMvc2VydmljZXMvcGluby1sb2dnZXItY29uZmlnLnNlcnZpY2Uuc3BlYy50cyIsIm1hcHBpbmdzIjoiOztBQUFBLDZDQUFzRDtBQUN0RCw2RUFHc0M7QUFDdEMsdUVBQXVFO0FBRXZFLFFBQVEsQ0FBQyx5QkFBeUIsRUFBRSxHQUFHLEVBQUU7SUFDdkMsSUFBSSxPQUFnQyxDQUFDO0lBQ3JDLElBQUksV0FBOEIsQ0FBQztJQUVuQyxVQUFVLENBQUMsS0FBSyxJQUFJLEVBQUU7UUFDcEIsV0FBVztRQUNYLFdBQVcsR0FBRyxFQUFFLEdBQUcsT0FBTyxDQUFDLEdBQUcsRUFBRSxDQUFDO1FBRWpDLGdCQUFnQjtRQUNoQixPQUFPLE9BQU8sQ0FBQyxHQUFHLENBQUMsU0FBUyxDQUFDO1FBQzdCLE9BQU8sT0FBTyxDQUFDLEdBQUcsQ0FBQyxVQUFVLENBQUM7UUFDOUIsT0FBTyxPQUFPLENBQUMsR0FBRyxDQUFDLGFBQWEsQ0FBQztRQUNqQyxPQUFPLE9BQU8sQ0FBQyxHQUFHLENBQUMsY0FBYyxDQUFDO1FBQ2xDLE9BQU8sT0FBTyxDQUFDLEdBQUcsQ0FBQyxnQkFBZ0IsQ0FBQztRQUNwQyxPQUFPLE9BQU8sQ0FBQyxHQUFHLENBQUMsUUFBUSxDQUFDO1FBRTVCLE1BQU0sTUFBTSxHQUFrQixNQUFNLGNBQUksQ0FBQyxtQkFBbUIsQ0FBQztZQUMzRCxTQUFTLEVBQUUsQ0FBQyxvREFBdUIsQ0FBQztTQUNyQyxDQUFDLENBQUMsT0FBTyxFQUFFLENBQUM7UUFFYixPQUFPLEdBQUcsTUFBTSxDQUFDLEdBQUcsQ0FBMEIsb0RBQXVCLENBQUMsQ0FBQztJQUN6RSxDQUFDLENBQUMsQ0FBQztJQUVILFNBQVMsQ0FBQyxHQUFHLEVBQUU7UUFDYixXQUFXO1FBQ1gsT0FBTyxDQUFDLEdBQUcsR0FBRyxXQUFXLENBQUM7SUFDNUIsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENB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R0FBRyxNQUFNLENBQUM7WUFFaEMsTUFBTSxZQUFZLEdBQXVCO2dCQUN2QyxLQUFLLEVBQUUsT0FBTztnQkFDZCxRQUFRLEVBQUUsSUFBSTthQUNmLENBQUM7WUFFRixNQUFNLE1BQU0sR0FBa0IsTUFBTSxjQUFJLENBQUMsbUJBQW1CLENBQUM7Z0JBQzNELFNBQVMsRUFBRTtvQkFDVDt3QkFDRSxPQUFPLEVBQUUsb0RBQXVCO3dCQUNoQyxVQUFVLEVBQUUsR0FBRyxFQUFFLENBQUMsSUFBSSxvREFBdUIsQ0FBQyxZQUFZLENBQUM7cUJBQzVEO2lCQUNGO2FBQ0YsQ0FBQyxDQUFDLE9BQU8sRUFBRSxDQUFDO1lBRWIsTUFBTSxhQUFhLEdBQUcsTUFBTSxDQUFDLEdBQUcsQ0FDOUIsb0RBQXVCLENBQ3hCLENBQUM7WUFDRixNQUFNLE1BQU0sR0FBRyxhQUFhLENBQUMsU0FBUyxFQUFFLENBQUM7WUFFekMsOEJBQThCO1lBQzlCLE1BQU0sQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsYUFBYTtZQUNqRCxNQUFNLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLE9BQU87WUFDM0MsTUFBTSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxRQUFRO1FBQzlDLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvaG9tZS9hcmxpZ2xlL1YxL0Fpb2ZpeC9haW9maXgtYWktc2Fhcy1wbGF0Zm9ybS9wYWNrYWdlcy9sb2dnaW5nL3NyYy9zZXJ2aWNlcy9waW5vLWxvZ2dlci1jb25maWcuc2VydmljZS5zcGVjLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFRlc3QsIFRlc3RpbmdNb2R1bGUgfSBmcm9tICdAbmVzdGpzL3Rlc3RpbmcnO1xuaW1wb3J0IHtcbiAgUGlub0xvZ2dlckNvbmZpZ1NlcnZpY2UsXG4gIExvZ0xldmVsLFxufSBmcm9tICcuL3Bpbm8tbG9nZ2VyLWNvbmZpZy5zZXJ2aWNlJztcbmltcG9ydCB7IExvZ0NvbmZpZywgTG9nRm9ybWF0IH0gZnJvbSAnLi4vaW50ZXJmYWNlcy9sb2dnaW5nLmludGVyZmFjZSc7XG5cbmRlc2NyaWJlKCdQaW5vTG9nZ2VyQ29uZmlnU2VydmljZScsICgpID0+IHtcbiAgbGV0IHNlcnZpY2U6IFBpbm9Mb2dnZXJDb25maWdTZXJ2aWNlO1xuICBsZXQgb3JpZ2luYWxFbnY6IE5vZGVKUy5Qcm9jZXNzRW52O1xuXG4gIGJlZm9yZUVhY2goYXN5bmMgKCkgPT4ge1xuICAgIC8vIOS/neWtmOWOn+Wni+eOr+Wig+WPmOmHj1xuICAgIG9yaWdpbmFsRW52ID0geyAuLi5wcm9jZXNzLmVudiB9O1xuXG4gICAgLy8g5riF55CG5Y+v6IO95b2x5ZON5rWL6K+V55qE546v5aKD5Y+Y6YePXG4gICAgZGVsZXRlIHByb2Nlc3MuZW52LkxPR19MRVZFTDtcbiAgICBkZWxldGUgcHJvY2Vzcy5lbnYuTE9HX0ZPUk1BVDtcbiAgICBkZWxldGUgcHJvY2Vzcy5lbnYuTE9HX0ZJTEVfUEFUSDtcbiAgICBkZWxldGUgcHJvY2Vzcy5lbnYuTE9HX1JFTU9URV9VUkw7XG4gICAgZGVsZXRlIHByb2Nlc3MuZW52LkxPR19SRU1PVEVfVE9LRU47XG4gICAgZGVsZXRlIHByb2Nlc3MuZW52Lk5PREVfRU5WO1xuXG4gICAgY29uc3QgbW9kdWxlOiBUZXN0aW5nTW9kdWxlID0gYXdhaXQgVGVzdC5jcmVhdGVUZXN0aW5nTW9kdWxlKHtcbiAgICAgIHByb3ZpZGVyczogW1Bpbm9Mb2dnZXJDb25maWdTZXJ2aWNlXSxcbiAgICB9KS5jb21waWxlKCk7XG5cbiAgICBzZXJ2aWNlID0gbW9kdWxlLmdldDxQaW5vTG9nZ2VyQ29uZmlnU2VydmljZT4oUGlub0xvZ2dlckNvbmZpZ1NlcnZpY2UpO1xuICB9KTtcblxuICBhZnRlckVhY2goKCkgPT4ge1xuICAgIC8vIOaBouWkjeWOn+Wni+eOr+Wig+WPmOmHj1xuICAgIHByb2Nlc3MuZW52ID0gb3JpZ2luYWxFbnY7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCfliJ3lp4vljJYnLCAoKSA9PiB7XG4gICAgaXQoJ+W6lOivpeS9v+eUqOm7mOiupOmFjee9ruWIneWni+WMlicsICgpID0+IHtcbiAgICAgIGNvbnN0IGNvbmZpZyA9IHNlcnZpY2UuZ2V0Q29uZmlnKCk7XG5cbiAgICAgIGV4cGVjdChjb25maWcubGV2ZWwpLnRvQmUoJ2luZm8nKTtcbiAgICAgIGV4cGVjdChjb25maWcuZm9ybWF0KS50b0JlKExvZ0Zvcm1hdC5KU09OKTtcbiAgICAgIGV4cGVjdChjb25maWcuY29sb3JpemUpLnRvQmUoZmFsc2UpO1xuICAgICAgZXhwZWN0KGNvbmZpZy50aW1lc3RhbXApLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QoY29uZmlnLnJlcXVlc3RJZCkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChjb25maWcudGVuYW50SWQpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QoY29uZmlnLnVzZXJJZCkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChjb25maWcucGVyZm9ybWFuY2UpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QoY29uZmlnLnN0YWNrVHJhY2UpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG5cbiAgICBpdCgn5bqU6K+l5L2/55So6Ieq5a6a5LmJ6YWN572u5Yid5aeL5YyWJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgY3VzdG9tQ29uZmlnOiBQYXJ0aWFsPExvZ0NvbmZpZz4gPSB7XG4gICAgICAgIGxldmVsOiAnZGVidWcnLFxuICAgICAgICBmb3JtYXQ6IExvZ0Zvcm1hdC5URVhULFxuICAgICAgICBjb2xvcml6ZTogdHJ1ZSxcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IG1vZHVsZTogVGVzdGluZ01vZHVsZSA9IGF3YWl0IFRlc3QuY3JlYXRlVGVzdGluZ01vZHVsZSh7XG4gICAgICAgIHByb3ZpZGVyczogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIHByb3ZpZGU6IFBpbm9Mb2dnZXJDb25maWdTZXJ2aWNlLFxuICAgICAgICAgICAgdXNlRmFjdG9yeTogKCkgPT4gbmV3IFBpbm9Mb2dnZXJDb25maWdTZXJ2aWNlKGN1c3RvbUNvbmZpZyksXG4gICAgICAgICAgfSxcbiAgICAgICAgXSxcbiAgICAgIH0pLmNvbXBpbGUoKTtcblxuICAgICAgY29uc3QgY3VzdG9tU2VydmljZSA9IG1vZHVsZS5nZXQ8UGlub0xvZ2dlckNvbmZpZ1NlcnZpY2U+KFxuICAgICAgICBQaW5vTG9nZ2VyQ29uZmlnU2VydmljZSxcbiAgICAgICk7XG4gICAgICBjb25zdCBjb25maWcgPSBjdXN0b21TZXJ2aWNlLmdldENvbmZpZygpO1xuXG4gICAgICBleHBlY3QoY29uZmlnLmxldmVsKS50b0JlKCdkZWJ1ZycpO1xuICAgICAgZXhwZWN0KGNvbmZpZy5mb3JtYXQpLnRvQmUoTG9nRm9ybWF0LlRFWFQpO1xuICAgICAgZXhwZWN0KGNvbmZpZy5jb2xvcml6ZSkudG9CZSh0cnVlKTtcbiAgICB9KTtcblxuICAgIGl0KCflupTor6Xku47njq/looPlj5jph4/or7vlj5bphY3nva4nLCBhc3luYyAoKSA9PiB7XG4gICAgICBwcm9jZXNzLmVudi5MT0dfTEVWRUwgPSAnd2Fybic7XG4gICAgICBwcm9jZXNzLmVudi5MT0dfRk9STUFUID0gJ3RleHQnO1xuICAgICAgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPSAnZGV2ZWxvcG1lbnQnO1xuXG4gICAgICBjb25zdCBtb2R1bGU6IFRlc3RpbmdNb2R1bGUgPSBhd2FpdCBUZXN0LmNyZWF0ZVRlc3RpbmdNb2R1bGUoe1xuICAgICAgICBwcm92aWRlcnM6IFtQaW5vTG9nZ2VyQ29uZmlnU2VydmljZV0sXG4gICAgICB9KS5jb21waWxlKCk7XG5cbiAgICAgIGNvbnN0IGVudlNlcnZpY2UgPSBtb2R1bGUuZ2V0PFBpbm9Mb2dnZXJDb25maWdTZXJ2aWNlPihcbiAgICAgICAgUGlub0xvZ2dlckNvbmZpZ1NlcnZpY2UsXG4gICAgICApO1xuICAgICAgY29uc3QgY29uZmlnID0gZW52U2VydmljZS5nZXRDb25maWcoKTtcblxuICAgICAgZXhwZWN0KGNvbmZpZy5sZXZlbCkudG9CZSgnd2FybicpO1xuICAgICAgZXhwZWN0KGNvbmZpZy5mb3JtYXQpLnRvQmUoJ3RleHQnKTtcbiAgICAgIGV4cGVjdChjb25maWcuY29sb3JpemUpLnRvQmUodHJ1ZSk7IC8vIGRldmVsb3BtZW50546v5aKD5bqU6K+l5ZCv55SoY29sb3JpemVcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ+mFjee9rueuoeeQhicsICgpID0+IHtcbiAgICBpdCgn5bqU6K+l6I635Y+W5b2T5YmN6YWN572uJywgKCkgPT4ge1xuICAgICAgY29uc3QgY29uZmlnID0gc2VydmljZS5nZXRDb25maWcoKTtcblxuICAgICAgZXhwZWN0KGNvbmZpZykudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdCh0eXBlb2YgY29uZmlnKS50b0JlKCdvYmplY3QnKTtcbiAgICAgIGV4cGVjdChjb25maWcubGV2ZWwpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QoY29uZmlnLmZvcm1hdCkudG9CZURlZmluZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCflupTor6Xmm7TmlrDphY3nva4nLCAoKSA9PiB7XG4gICAgICBjb25zdCBuZXdDb25maWc6IFBhcnRpYWw8TG9nQ29uZmlnPiA9IHtcbiAgICAgICAgbGV2ZWw6ICdkZWJ1ZycsXG4gICAgICAgIGZvcm1hdDogTG9nRm9ybWF0LlRFWFQsXG4gICAgICAgIGNvbG9yaXplOiB0cnVlLFxuICAgICAgfTtcblxuICAgICAgc2VydmljZS51cGRhdGVDb25maWcobmV3Q29uZmlnKTtcbiAgICAgIGNvbnN0IGNvbmZpZyA9IHNlcnZpY2UuZ2V0Q29uZmlnKCk7XG5cbiAgICAgIGV4cGVjdChjb25maWcubGV2ZWwpLnRvQmUoJ2RlYnVnJyk7XG4gICAgICBleHBlY3QoY29uZmlnLmZvcm1hdCkudG9CZShMb2dGb3JtYXQuVEVYVCk7XG4gICAgICBleHBlY3QoY29uZmlnLmNvbG9yaXplKS50b0JlKHRydWUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ+W6lOivpemDqOWIhuabtOaWsOmFjee9ricsICgpID0+IHtcbiAgICAgIGNvbnN0IG9yaWdpbmFsQ29uZmlnID0gc2VydmljZS5nZXRDb25maWcoKTtcblxuICAgICAgc2VydmljZS51cGRhdGVDb25maWcoeyBsZXZlbDogJ2Vycm9yJyB9KTtcbiAgICAgIGNvbnN0IGNvbmZpZyA9IHNlcnZpY2UuZ2V0Q29uZmlnKCk7XG5cbiAgICAgIGV4cGVjdChjb25maWcubGV2ZWwpLnRvQmUoJ2Vycm9yJyk7XG4gICAgICBleHBlY3QoY29uZmlnLmZvcm1hdCkudG9CZShvcmlnaW5hbENvbmZpZy5mb3JtYXQpO1xuICAgICAgZXhwZWN0KGNvbmZpZy5jb2xvcml6ZSkudG9CZShvcmlnaW5hbENvbmZpZy5jb2xvcml6ZSk7XG4gICAgfSk7XG5cbiAgICBpdCgn5bqU6K+l6YeN572u5Li66buY6K6k6YWN572uJywgKCkgPT4ge1xuICAgICAgLy8g5YWI5L+u5pS56YWN572uXG4gICAgICBzZXJ2aWNlLnVwZGF0ZUNvbmZpZyh7IGxldmVsOiAnZGVidWcnLCBjb2xvcml6ZTogdHJ1ZSB9KTtcblxuICAgICAgLy8g6YeN572u5Li66buY6K6k6YWN572uXG4gICAgICBzZXJ2aWNlLnJlc2V0VG9EZWZhdWx0cygpO1xuICAgICAgY29uc3QgY29uZmlnID0gc2VydmljZS5nZXRDb25maWcoKTtcblxuICAgICAgZXhwZWN0KGNvbmZpZy5sZXZlbCkudG9CZSgnaW5mbycpO1xuICAgICAgZXhwZWN0KGNvbmZpZy5jb2xvcml6ZSkudG9CZShmYWxzZSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCfml6Xlv5fnuqfliKvnrqHnkIYnLCAoKSA9PiB7XG4gICAgaXQoJ+W6lOivpeiOt+WPluW9k+WJjeaXpeW/l+e6p+WIqycsICgpID0+IHtcbiAgICAgIGNvbnN0IGxldmVsID0gc2VydmljZS5nZXRMZXZlbCgpO1xuICAgICAgZXhwZWN0KGxldmVsKS50b0JlKCdpbmZvJyk7XG4gICAgfSk7XG5cbiAgICBpdCgn5bqU6K+l6K6+572u5pel5b+X57qn5YirJywgKCkgPT4ge1xuICAgICAgc2VydmljZS5zZXRMZXZlbCgnZGVidWcnKTtcbiAgICAgIGV4cGVjdChzZXJ2aWNlLmdldExldmVsKCkpLnRvQmUoJ2RlYnVnJyk7XG4gICAgfSk7XG5cbiAgICBpdCgn5bqU6K+l5pSv5oyB5omA5pyJ5pyJ5pWI55qE5pel5b+X57qn5YirJywgKCkgPT4ge1xuICAgICAgY29uc3QgdmFsaWRMZXZlbHM6IExvZ0xldmVsW10gPSBbXG4gICAgICAgICdmYXRhbCcsXG4gICAgICAgICdlcnJvcicsXG4gICAgICAgICd3YXJuJyxcbiAgICAgICAgJ2luZm8nLFxuICAgICAgICAnZGVidWcnLFxuICAgICAgICAndHJhY2UnLFxuICAgICAgXTtcblxuICAgICAgdmFsaWRMZXZlbHMuZm9yRWFjaChsZXZlbCA9PiB7XG4gICAgICAgIHNlcnZpY2Uuc2V0TGV2ZWwobGV2ZWwpO1xuICAgICAgICBleHBlY3Qoc2VydmljZS5nZXRMZXZlbCgpKS50b0JlKGxldmVsKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgn5pel5b+X5qC85byP566h55CGJywgKCkgPT4ge1xuICAgIGl0KCflupTor6Xojrflj5blvZPliY3ml6Xlv5fmoLzlvI8nLCAoKSA9PiB7XG4gICAgICBjb25zdCBmb3JtYXQgPSBzZXJ2aWNlLmdldEZvcm1hdCgpO1xuICAgICAgZXhwZWN0KGZvcm1hdCkudG9CZShMb2dGb3JtYXQuSlNPTik7XG4gICAgfSk7XG5cbiAgICBpdCgn5bqU6K+l6K6+572u5pel5b+X5qC85byPJywgKCkgPT4ge1xuICAgICAgc2VydmljZS5zZXRGb3JtYXQoTG9nRm9ybWF0LlRFWFQpO1xuICAgICAgZXhwZWN0KHNlcnZpY2UuZ2V0Rm9ybWF0KCkpLnRvQmUoTG9nRm9ybWF0LlRFWFQpO1xuICAgIH0pO1xuXG4gICAgaXQoJ+W6lOivpeaUr+aMgeaJgOacieacieaViOeahOaXpeW/l+agvOW8jycsICgpID0+IHtcbiAgICAgIGNvbnN0IHZhbGlkRm9ybWF0czogTG9nRm9ybWF0W10gPSBbTG9nRm9ybWF0LkpTT04sIExvZ0Zvcm1hdC5URVhUXTtcblxuICAgICAgdmFsaWRGb3JtYXRzLmZvckVhY2goZm9ybWF0ID0+IHtcbiAgICAgICAgc2VydmljZS5zZXRGb3JtYXQoZm9ybWF0KTtcbiAgICAgICAgZXhwZWN0KHNlcnZpY2UuZ2V0Rm9ybWF0KCkpLnRvQmUoZm9ybWF0KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgn546v5aKD5qOA5rWLJywgKCkgPT4ge1xuICAgIGl0KCflupTor6XmraPnoa7mo4DmtYvnlJ/kuqfnjq/looMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBwcm9jZXNzLmVudi5OT0RFX0VOViA9ICdwcm9kdWN0aW9uJztcblxuICAgICAgY29uc3QgbW9kdWxlOiBUZXN0aW5nTW9kdWxlID0gYXdhaXQgVGVzdC5jcmVhdGVUZXN0aW5nTW9kdWxlKHtcbiAgICAgICAgcHJvdmlkZXJzOiBbUGlub0xvZ2dlckNvbmZpZ1NlcnZpY2VdLFxuICAgICAgfSkuY29tcGlsZSgpO1xuXG4gICAgICBjb25zdCBwcm9kU2VydmljZSA9IG1vZHVsZS5nZXQ8UGlub0xvZ2dlckNvbmZpZ1NlcnZpY2U+KFxuICAgICAgICBQaW5vTG9nZ2VyQ29uZmlnU2VydmljZSxcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChwcm9kU2VydmljZS5pc1Byb2R1Y3Rpb24oKSkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChwcm9kU2VydmljZS5pc0RldmVsb3BtZW50KCkpLnRvQmUoZmFsc2UpO1xuICAgIH0pO1xuXG4gICAgaXQoJ+W6lOivpeato+ehruajgOa1i+W8gOWPkeeOr+WigycsIGFzeW5jICgpID0+IHtcbiAgICAgIHByb2Nlc3MuZW52Lk5PREVfRU5WID0gJ2RldmVsb3BtZW50JztcblxuICAgICAgY29uc3QgbW9kdWxlOiBUZXN0aW5nTW9kdWxlID0gYXdhaXQgVGVzdC5jcmVhdGVUZXN0aW5nTW9kdWxlKHtcbiAgICAgICAgcHJvdmlkZXJzOiBbUGlub0xvZ2dlckNvbmZpZ1NlcnZpY2VdLFxuICAgICAgfSkuY29tcGlsZSgpO1xuXG4gICAgICBjb25zdCBkZXZTZXJ2aWNlID0gbW9kdWxlLmdldDxQaW5vTG9nZ2VyQ29uZmlnU2VydmljZT4oXG4gICAgICAgIFBpbm9Mb2dnZXJDb25maWdTZXJ2aWNlLFxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KGRldlNlcnZpY2UuaXNQcm9kdWN0aW9uKCkpLnRvQmUoZmFsc2UpO1xuICAgICAgZXhwZWN0KGRldlNlcnZpY2UuaXNEZXZlbG9wbWVudCgpKS50b0JlKHRydWUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ+W6lOivpeato+ehruajgOa1i+a1i+ivleeOr+WigycsIGFzeW5jICgpID0+IHtcbiAgICAgIHByb2Nlc3MuZW52Lk5PREVfRU5WID0gJ3Rlc3QnO1xuXG4gICAgICBjb25zdCBtb2R1bGU6IFRlc3RpbmdNb2R1bGUgPSBhd2FpdCBUZXN0LmNyZWF0ZVRlc3RpbmdNb2R1bGUoe1xuICAgICAgICBwcm92aWRlcnM6IFtQaW5vTG9nZ2VyQ29uZmlnU2VydmljZV0sXG4gICAgICB9KS5jb21waWxlKCk7XG5cbiAgICAgIGNvbnN0IHRlc3RTZXJ2aWNlID0gbW9kdWxlLmdldDxQaW5vTG9nZ2VyQ29uZmlnU2VydmljZT4oXG4gICAgICAgIFBpbm9Mb2dnZXJDb25maWdTZXJ2aWNlLFxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KHRlc3RTZXJ2aWNlLmlzUHJvZHVjdGlvbigpKS50b0JlKGZhbHNlKTtcbiAgICAgIGV4cGVjdCh0ZXN0U2VydmljZS5pc0RldmVsb3BtZW50KCkpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCfnvo7ljJbmoLzlvI/liKTmlq0nLCAoKSA9PiB7XG4gICAgaXQoJ+W8gOWPkeeOr+Wig+W6lOivpeS9v+eUqOe+juWMluagvOW8jycsIGFzeW5jICgpID0+IHtcbiAgICAgIHByb2Nlc3MuZW52Lk5PREVfRU5WID0gJ2RldmVsb3BtZW50JztcblxuICAgICAgY29uc3QgbW9kdWxlOiBUZXN0aW5nTW9kdWxlID0gYXdhaXQgVGVzdC5jcmVhdGVUZXN0aW5nTW9kdWxlKHtcbiAgICAgICAgcHJvdmlkZXJzOiBbUGlub0xvZ2dlckNvbmZpZ1NlcnZpY2VdLFxuICAgICAgfSkuY29tcGlsZSgpO1xuXG4gICAgICBjb25zdCBkZXZTZXJ2aWNlID0gbW9kdWxlLmdldDxQaW5vTG9nZ2VyQ29uZmlnU2VydmljZT4oXG4gICAgICAgIFBpbm9Mb2dnZXJDb25maWdTZXJ2aWNlLFxuICAgICAgKTtcbiAgICAgIGRldlNlcnZpY2Uuc2V0Rm9ybWF0KExvZ0Zvcm1hdC5URVhUKTtcblxuICAgICAgZXhwZWN0KGRldlNlcnZpY2Uuc2hvdWxkVXNlUHJldHR5Rm9ybWF0KCkpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG5cbiAgICBpdCgn55Sf5Lqn546v5aKD5LiN5bqU6K+l5L2/55So576O5YyW5qC85byPJywgYXN5bmMgKCkgPT4ge1xuICAgICAgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPSAncHJvZHVjdGlvbic7XG5cbiAgICAgIGNvbnN0IG1vZHVsZTogVGVzdGluZ01vZHVsZSA9IGF3YWl0IFRlc3QuY3JlYXRlVGVzdGluZ01vZHVsZSh7XG4gICAgICAgIHByb3ZpZGVyczogW1Bpbm9Mb2dnZXJDb25maWdTZXJ2aWNlXSxcbiAgICAgIH0pLmNvbXBpbGUoKTtcblxuICAgICAgY29uc3QgcHJvZFNlcnZpY2UgPSBtb2R1bGUuZ2V0PFBpbm9Mb2dnZXJDb25maWdTZXJ2aWNlPihcbiAgICAgICAgUGlub0xvZ2dlckNvbmZpZ1NlcnZpY2UsXG4gICAgICApO1xuICAgICAgcHJvZFNlcnZpY2Uuc2V0Rm9ybWF0KExvZ0Zvcm1hdC5URVhUKTtcblxuICAgICAgZXhwZWN0KHByb2RTZXJ2aWNlLnNob3VsZFVzZVByZXR0eUZvcm1hdCgpKS50b0JlKGZhbHNlKTtcbiAgICB9KTtcblxuICAgIGl0KCdKU09O5qC85byP5LiN5bqU6K+l5L2/55So576O5YyW5qC85byPJywgYXN5bmMgKCkgPT4ge1xuICAgICAgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPSAnZGV2ZWxvcG1lbnQnO1xuXG4gICAgICBjb25zdCBtb2R1bGU6IFRlc3RpbmdNb2R1bGUgPSBhd2FpdCBUZXN0LmNyZWF0ZVRlc3RpbmdNb2R1bGUoe1xuICAgICAgICBwcm92aWRlcnM6IFtQaW5vTG9nZ2VyQ29uZmlnU2VydmljZV0sXG4gICAgICB9KS5jb21waWxlKCk7XG5cbiAgICAgIGNvbnN0IGRldlNlcnZpY2UgPSBtb2R1bGUuZ2V0PFBpbm9Mb2dnZXJDb25maWdTZXJ2aWNlPihcbiAgICAgICAgUGlub0xvZ2dlckNvbmZpZ1NlcnZpY2UsXG4gICAgICApO1xuICAgICAgZGV2U2VydmljZS5zZXRGb3JtYXQoTG9nRm9ybWF0LkpTT04pO1xuXG4gICAgICBleHBlY3QoZGV2U2VydmljZS5zaG91bGRVc2VQcmV0dHlGb3JtYXQoKSkudG9CZShmYWxzZSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCfphY3nva7pqozor4EnLCAoKSA9PiB7XG4gICAgaXQoJ+W6lOivpemqjOivgeacieaViOeahOaXpeW/l+e6p+WIqycsICgpID0+IHtcbiAgICAgIGNvbnN0IHZhbGlkTGV2ZWxzOiBMb2dMZXZlbFtdID0gW1xuICAgICAgICAnZmF0YWwnLFxuICAgICAgICAnZXJyb3InLFxuICAgICAgICAnd2FybicsXG4gICAgICAgICdpbmZvJyxcbiAgICAgICAgJ2RlYnVnJyxcbiAgICAgICAgJ3RyYWNlJyxcbiAgICAgIF07XG5cbiAgICAgIHZhbGlkTGV2ZWxzLmZvckVhY2gobGV2ZWwgPT4ge1xuICAgICAgICBleHBlY3QoKCkgPT4ge1xuICAgICAgICAgIHNlcnZpY2UudXBkYXRlQ29uZmlnKHsgbGV2ZWwgfSk7XG4gICAgICAgIH0pLm5vdC50b1Rocm93KCk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCflupTor6Xpqozor4HmnInmlYjnmoTml6Xlv5fmoLzlvI8nLCAoKSA9PiB7XG4gICAgICBjb25zdCB2YWxpZEZvcm1hdHM6IExvZ0Zvcm1hdFtdID0gW0xvZ0Zvcm1hdC5KU09OLCBMb2dGb3JtYXQuVEVYVF07XG5cbiAgICAgIHZhbGlkRm9ybWF0cy5mb3JFYWNoKGZvcm1hdCA9PiB7XG4gICAgICAgIGV4cGVjdCgoKSA9PiB7XG4gICAgICAgICAgc2VydmljZS51cGRhdGVDb25maWcoeyBmb3JtYXQgfSk7XG4gICAgICAgIH0pLm5vdC50b1Rocm93KCk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCflupTor6Xpqozor4Hmlofku7bova7ovazphY3nva4nLCAoKSA9PiB7XG4gICAgICBjb25zdCB2YWxpZFJvdGF0aW9uQ29uZmlnID0ge1xuICAgICAgICByb3RhdGlvbjoge1xuICAgICAgICAgIG1heFNpemU6ICcxMG0nLFxuICAgICAgICAgIG1heEZpbGVzOiA1LFxuICAgICAgICAgIGludGVydmFsOiAnMWQnLFxuICAgICAgICB9LFxuICAgICAgfTtcblxuICAgICAgZXhwZWN0KCgpID0+IHtcbiAgICAgICAgc2VydmljZS51cGRhdGVDb25maWcodmFsaWRSb3RhdGlvbkNvbmZpZyk7XG4gICAgICB9KS5ub3QudG9UaHJvdygpO1xuICAgIH0pO1xuXG4gICAgaXQoJ+W6lOivpemqjOivgei/nOeoi+aXpeW/l+mFjee9ricsICgpID0+IHtcbiAgICAgIGNvbnN0IHZhbGlkUmVtb3RlQ29uZmlnID0ge1xuICAgICAgICByZW1vdGU6IHtcbiAgICAgICAgICB1cmw6ICdodHRwczovL2xvZ3MuZXhhbXBsZS5jb20nLFxuICAgICAgICAgIHRva2VuOiAnc2VjcmV0LXRva2VuJyxcbiAgICAgICAgICB0aW1lb3V0OiA1MDAwLFxuICAgICAgICAgIHJldHJpZXM6IDMsXG4gICAgICAgIH0sXG4gICAgICB9O1xuXG4gICAgICBleHBlY3QoKCkgPT4ge1xuICAgICAgICBzZXJ2aWNlLnVwZGF0ZUNvbmZpZyh2YWxpZFJlbW90ZUNvbmZpZyk7XG4gICAgICB9KS5ub3QudG9UaHJvdygpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgn6YWN572u6aqM6K+B6ZSZ6K+vJywgKCkgPT4ge1xuICAgIGl0KCflupTor6Xmi5Lnu53ml6DmlYjnmoTml6Xlv5fnuqfliKsnLCAoKSA9PiB7XG4gICAgICBleHBlY3QoKCkgPT4ge1xuICAgICAgICBzZXJ2aWNlLnVwZGF0ZUNvbmZpZyh7IGxldmVsOiAnaW52YWxpZCcgYXMgTG9nTGV2ZWwgfSk7XG4gICAgICB9KS50b1Rocm93KCdJbnZhbGlkIGxvZyBsZXZlbCcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ+W6lOivpeaLkue7neaXoOaViOeahOaXpeW/l+agvOW8jycsICgpID0+IHtcbiAgICAgIGV4cGVjdCgoKSA9PiB7XG4gICAgICAgIHNlcnZpY2UudXBkYXRlQ29uZmlnKHsgZm9ybWF0OiAnaW52YWxpZCcgYXMgTG9nRm9ybWF0IH0pO1xuICAgICAgfSkudG9UaHJvdygnSW52YWxpZCBsb2cgZm9ybWF0Jyk7XG4gICAgfSk7XG5cbiAgICBpdCgn5bqU6K+l5ouS57ud5peg5pWI55qE5paH5Lu25aSn5bCP5qC85byPJywgKCkgPT4ge1xuICAgICAgZXhwZWN0KCgpID0+IHtcbiAgICAgICAgc2VydmljZS51cGRhdGVDb25maWcoe1xuICAgICAgICAgIHJvdGF0aW9uOiB7XG4gICAgICAgICAgICBtYXhTaXplOiAnaW52YWxpZC1zaXplJyxcbiAgICAgICAgICAgIG1heEZpbGVzOiA1LFxuICAgICAgICAgICAgaW50ZXJ2YWw6ICcxZCcsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICB9KS50b1Rocm93KCdJbnZhbGlkIG1heFNpemUgZm9ybWF0Jyk7XG4gICAgfSk7XG5cbiAgICBpdCgn5bqU6K+l5ouS57ud57y65bCRVVJM55qE6L+c56iL5pel5b+X6YWN572uJywgKCkgPT4ge1xuICAgICAgZXhwZWN0KCgpID0+IHtcbiAgICAgICAgc2VydmljZS51cGRhdGVDb25maWcoe1xuICAgICAgICAgIHJlbW90ZToge1xuICAgICAgICAgICAgdXJsOiAnJyxcbiAgICAgICAgICAgIHRva2VuOiAnc2VjcmV0LXRva2VuJyxcbiAgICAgICAgICAgIHRpbWVvdXQ6IDUwMDAsXG4gICAgICAgICAgICByZXRyaWVzOiAzLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgfSkudG9UaHJvdygnUmVtb3RlIGxvZ2dpbmcgVVJMIGlzIHJlcXVpcmVkJyk7XG4gICAgfSk7XG5cbiAgICBpdCgn5bqU6K+l5ouS57ud6LSf5pWw55qE6LaF5pe25pe26Ze0JywgKCkgPT4ge1xuICAgICAgZXhwZWN0KCgpID0+IHtcbiAgICAgICAgc2VydmljZS51cGRhdGVDb25maWcoe1xuICAgICAgICAgIHJlbW90ZToge1xuICAgICAgICAgICAgdXJsOiAnaHR0cHM6Ly9sb2dzLmV4YW1wbGUuY29tJyxcbiAgICAgICAgICAgIHRva2VuOiAnc2VjcmV0LXRva2VuJyxcbiAgICAgICAgICAgIHRpbWVvdXQ6IC0xLFxuICAgICAgICAgICAgcmV0cmllczogMyxcbiAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICAgIH0pLnRvVGhyb3coJ1JlbW90ZSBsb2dnaW5nIHRpbWVvdXQgbXVzdCBiZSBwb3NpdGl2ZScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ+W6lOivpeaLkue7nei0n+aVsOeahOmHjeivleasoeaVsCcsICgpID0+IHtcbiAgICAgIGV4cGVjdCgoKSA9PiB7XG4gICAgICAgIHNlcnZpY2UudXBkYXRlQ29uZmlnKHtcbiAgICAgICAgICByZW1vdGU6IHtcbiAgICAgICAgICAgIHVybDogJ2h0dHBzOi8vbG9ncy5leGFtcGxlLmNvbScsXG4gICAgICAgICAgICB0b2tlbjogJ3NlY3JldC10b2tlbicsXG4gICAgICAgICAgICB0aW1lb3V0OiA1MDAwLFxuICAgICAgICAgICAgcmV0cmllczogLTEsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICB9KS50b1Rocm93KCdSZW1vdGUgbG9nZ2luZyByZXRyaWVzIG11c3QgYmUgbm9uLW5lZ2F0aXZlJyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCfnjq/looPlj5jph4/phY3nva4nLCAoKSA9PiB7XG4gICAgaXQoJ+W6lOivpeS7jueOr+Wig+WPmOmHj+ivu+WPluaXpeW/l+e6p+WIqycsIGFzeW5jICgpID0+IHtcbiAgICAgIHByb2Nlc3MuZW52LkxPR19MRVZFTCA9ICdlcnJvcic7XG5cbiAgICAgIGNvbnN0IG1vZHVsZTogVGVzdGluZ01vZHVsZSA9IGF3YWl0IFRlc3QuY3JlYXRlVGVzdGluZ01vZHVsZSh7XG4gICAgICAgIHByb3ZpZGVyczogW1Bpbm9Mb2dnZXJDb25maWdTZXJ2aWNlXSxcbiAgICAgIH0pLmNvbXBpbGUoKTtcblxuICAgICAgY29uc3QgZW52U2VydmljZSA9IG1vZHVsZS5nZXQ8UGlub0xvZ2dlckNvbmZpZ1NlcnZpY2U+KFxuICAgICAgICBQaW5vTG9nZ2VyQ29uZmlnU2VydmljZSxcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChlbnZTZXJ2aWNlLmdldExldmVsKCkpLnRvQmUoJ2Vycm9yJyk7XG4gICAgfSk7XG5cbiAgICBpdCgn5bqU6K+l5LuO546v5aKD5Y+Y6YeP6K+75Y+W5pel5b+X5qC85byPJywgYXN5bmMgKCkgPT4ge1xuICAgICAgcHJvY2Vzcy5lbnYuTE9HX0ZPUk1BVCA9ICd0ZXh0JztcblxuICAgICAgY29uc3QgbW9kdWxlOiBUZXN0aW5nTW9kdWxlID0gYXdhaXQgVGVzdC5jcmVhdGVUZXN0aW5nTW9kdWxlKHtcbiAgICAgICAgcHJvdmlkZXJzOiBbUGlub0xvZ2dlckNvbmZpZ1NlcnZpY2VdLFxuICAgICAgfSkuY29tcGlsZSgpO1xuXG4gICAgICBjb25zdCBlbnZTZXJ2aWNlID0gbW9kdWxlLmdldDxQaW5vTG9nZ2VyQ29uZmlnU2VydmljZT4oXG4gICAgICAgIFBpbm9Mb2dnZXJDb25maWdTZXJ2aWNlLFxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KGVudlNlcnZpY2UuZ2V0Rm9ybWF0KCkpLnRvQmUoJ3RleHQnKTtcbiAgICB9KTtcblxuICAgIGl0KCflupTor6Xku47njq/looPlj5jph4/or7vlj5bml6Xlv5fmlofku7bot6/lvoQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBwcm9jZXNzLmVudi5MT0dfRklMRV9QQVRIID0gJy92YXIvbG9nL2FwcC5sb2cnO1xuXG4gICAgICBjb25zdCBtb2R1bGU6IFRlc3RpbmdNb2R1bGUgPSBhd2FpdCBUZXN0LmNyZWF0ZVRlc3RpbmdNb2R1bGUoe1xuICAgICAgICBwcm92aWRlcnM6IFtQaW5vTG9nZ2VyQ29uZmlnU2VydmljZV0sXG4gICAgICB9KS5jb21waWxlKCk7XG5cbiAgICAgIGNvbnN0IGVudlNlcnZpY2UgPSBtb2R1bGUuZ2V0PFBpbm9Mb2dnZXJDb25maWdTZXJ2aWNlPihcbiAgICAgICAgUGlub0xvZ2dlckNvbmZpZ1NlcnZpY2UsXG4gICAgICApO1xuICAgICAgY29uc3QgY29uZmlnID0gZW52U2VydmljZS5nZXRDb25maWcoKTtcblxuICAgICAgZXhwZWN0KGNvbmZpZy5maWxlUGF0aCkudG9CZSgnL3Zhci9sb2cvYXBwLmxvZycpO1xuICAgIH0pO1xuXG4gICAgaXQoJ+W6lOivpeS7jueOr+Wig+WPmOmHj+ivu+WPlui/nOeoi+aXpeW/l+mFjee9ricsIGFzeW5jICgpID0+IHtcbiAgICAgIHByb2Nlc3MuZW52LkxPR19SRU1PVEVfVVJMID0gJ2h0dHBzOi8vbG9ncy5leGFtcGxlLmNvbSc7XG4gICAgICBwcm9jZXNzLmVudi5MT0dfUkVNT1RFX1RPS0VOID0gJ3NlY3JldC10b2tlbic7XG5cbiAgICAgIGNvbnN0IG1vZHVsZTogVGVzdGluZ01vZHVsZSA9IGF3YWl0IFRlc3QuY3JlYXRlVGVzdGluZ01vZHVsZSh7XG4gICAgICAgIHByb3ZpZGVyczogW1Bpbm9Mb2dnZXJDb25maWdTZXJ2aWNlXSxcbiAgICAgIH0pLmNvbXBpbGUoKTtcblxuICAgICAgY29uc3QgZW52U2VydmljZSA9IG1vZHVsZS5nZXQ8UGlub0xvZ2dlckNvbmZpZ1NlcnZpY2U+KFxuICAgICAgICBQaW5vTG9nZ2VyQ29uZmlnU2VydmljZSxcbiAgICAgICk7XG4gICAgICBjb25zdCBjb25maWcgPSBlbnZTZXJ2aWNlLmdldENvbmZpZygpO1xuXG4gICAgICBleHBlY3QoY29uZmlnLnJlbW90ZSkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChjb25maWcucmVtb3RlPy51cmwpLnRvQmUoJ2h0dHBzOi8vbG9ncy5leGFtcGxlLmNvbScpO1xuICAgICAgZXhwZWN0KGNvbmZpZy5yZW1vdGU/LnRva2VuKS50b0JlKCdzZWNyZXQtdG9rZW4nKTtcbiAgICAgIGV4cGVjdChjb25maWcucmVtb3RlPy50aW1lb3V0KS50b0JlKDUwMDApO1xuICAgICAgZXhwZWN0KGNvbmZpZy5yZW1vdGU/LnJldHJpZXMpLnRvQmUoMyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCfphY3nva7lkIjlubYnLCAoKSA9PiB7XG4gICAgaXQoJ+W6lOivpeato+ehruWQiOW5tum7mOiupOmFjee9ruWSjOiHquWumuS5iemFjee9ricsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGN1c3RvbUNvbmZpZzogUGFydGlhbDxMb2dDb25maWc+ID0ge1xuICAgICAgICBsZXZlbDogJ2RlYnVnJyxcbiAgICAgICAgY29sb3JpemU6IHRydWUsXG4gICAgICAgIHRpbWVzdGFtcDogZmFsc2UsXG4gICAgICB9O1xuXG4gICAgICBjb25zdCBtb2R1bGU6IFRlc3RpbmdNb2R1bGUgPSBhd2FpdCBUZXN0LmNyZWF0ZVRlc3RpbmdNb2R1bGUoe1xuICAgICAgICBwcm92aWRlcnM6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBwcm92aWRlOiBQaW5vTG9nZ2VyQ29uZmlnU2VydmljZSxcbiAgICAgICAgICAgIHVzZUZhY3Rvcnk6ICgpID0+IG5ldyBQaW5vTG9nZ2VyQ29uZmlnU2VydmljZShjdXN0b21Db25maWcpLFxuICAgICAgICAgIH0sXG4gICAgICAgIF0sXG4gICAgICB9KS5jb21waWxlKCk7XG5cbiAgICAgIGNvbnN0IGN1c3RvbVNlcnZpY2UgPSBtb2R1bGUuZ2V0PFBpbm9Mb2dnZXJDb25maWdTZXJ2aWNlPihcbiAgICAgICAgUGlub0xvZ2dlckNvbmZpZ1NlcnZpY2UsXG4gICAgICApO1xuICAgICAgY29uc3QgY29uZmlnID0gY3VzdG9tU2VydmljZS5nZXRDb25maWcoKTtcblxuICAgICAgLy8g6Ieq5a6a5LmJ6YWN572u5bqU6K+l6KaG55uW6buY6K6k6YWN572uXG4gICAgICBleHBlY3QoY29uZmlnLmxldmVsKS50b0JlKCdkZWJ1ZycpO1xuICAgICAgZXhwZWN0KGNvbmZpZy5jb2xvcml6ZSkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChjb25maWcudGltZXN0YW1wKS50b0JlKGZhbHNlKTtcblxuICAgICAgLy8g5pyq5oyH5a6a55qE6YWN572u5bqU6K+l5L+d5oyB6buY6K6k5YC8XG4gICAgICBleHBlY3QoY29uZmlnLnJlcXVlc3RJZCkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChjb25maWcudGVuYW50SWQpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QoY29uZmlnLnVzZXJJZCkudG9CZSh0cnVlKTtcbiAgICB9KTtcblxuICAgIGl0KCflupTor6XmraPnoa7lpITnkIbnjq/looPlj5jph4/lkozoh6rlrprkuYnphY3nva7nmoTkvJjlhYjnuqcnLCBhc3luYyAoKSA9PiB7XG4gICAgICBwcm9jZXNzLmVudi5MT0dfTEVWRUwgPSAnd2Fybic7XG4gICAgICBwcm9jZXNzLmVudi5MT0dfRk9STUFUID0gJ3RleHQnO1xuXG4gICAgICBjb25zdCBjdXN0b21Db25maWc6IFBhcnRpYWw8TG9nQ29uZmlnPiA9IHtcbiAgICAgICAgbGV2ZWw6ICdkZWJ1ZycsXG4gICAgICAgIGNvbG9yaXplOiB0cnVlLFxuICAgICAgfTtcblxuICAgICAgY29uc3QgbW9kdWxlOiBUZXN0aW5nTW9kdWxlID0gYXdhaXQgVGVzdC5jcmVhdGVUZXN0aW5nTW9kdWxlKHtcbiAgICAgICAgcHJvdmlkZXJzOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgcHJvdmlkZTogUGlub0xvZ2dlckNvbmZpZ1NlcnZpY2UsXG4gICAgICAgICAgICB1c2VGYWN0b3J5OiAoKSA9PiBuZXcgUGlub0xvZ2dlckNvbmZpZ1NlcnZpY2UoY3VzdG9tQ29uZmlnKSxcbiAgICAgICAgICB9LFxuICAgICAgICBdLFxuICAgICAgfSkuY29tcGlsZSgpO1xuXG4gICAgICBjb25zdCBjdXN0b21TZXJ2aWNlID0gbW9kdWxlLmdldDxQaW5vTG9nZ2VyQ29uZmlnU2VydmljZT4oXG4gICAgICAgIFBpbm9Mb2dnZXJDb25maWdTZXJ2aWNlLFxuICAgICAgKTtcbiAgICAgIGNvbnN0IGNvbmZpZyA9IGN1c3RvbVNlcnZpY2UuZ2V0Q29uZmlnKCk7XG5cbiAgICAgIC8vIOeOr+Wig+WPmOmHj+W6lOivpeimhueblum7mOiupOmFjee9ru+8jOS9huiHquWumuS5iemFjee9ruW6lOivpeimhueblueOr+Wig+WPmOmHj1xuICAgICAgZXhwZWN0KGNvbmZpZy5sZXZlbCkudG9CZSgnZGVidWcnKTsgLy8g6Ieq5a6a5LmJ6YWN572u5LyY5YWI57qn5pyA6auYXG4gICAgICBleHBlY3QoY29uZmlnLmZvcm1hdCkudG9CZSgndGV4dCcpOyAvLyDnjq/looPlj5jph49cbiAgICAgIGV4cGVjdChjb25maWcuY29sb3JpemUpLnRvQmUodHJ1ZSk7IC8vIOiHquWumuS5iemFjee9rlxuICAgIH0pO1xuICB9KTtcbn0pO1xuIl0sInZlcnNpb24iOjN9