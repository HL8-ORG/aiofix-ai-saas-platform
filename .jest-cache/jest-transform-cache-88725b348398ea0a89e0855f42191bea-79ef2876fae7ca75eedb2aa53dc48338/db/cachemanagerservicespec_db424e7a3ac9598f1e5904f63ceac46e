81f614aa48da6e8a55171c42bc3a0da6
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const testing_1 = require("@nestjs/testing");
const event_emitter_1 = require("@nestjs/event-emitter");
const cache_manager_service_1 = require("./cache-manager.service");
const cache_interface_1 = require("../interfaces/cache.interface");
const logging_1 = require("@aiofix/logging");
/**
 * @class MockCacheService
 * @description 模拟缓存服务，用于测试
 */
class MockCacheService {
    constructor() {
        this.cache = new Map();
        this.stats = {
            totalEntries: 0,
            hits: 0,
            misses: 0,
            hitRate: 0,
            totalSize: 0,
            averageSize: 0,
            expiredEntries: 0,
            evictedEntries: 0,
            lastReset: Date.now(),
        };
    }
    async get(key) {
        const cacheKey = this.buildKey(key);
        const value = this.cache.get(cacheKey);
        if (value !== undefined) {
            this.stats.hits++;
            return value;
        }
        this.stats.misses++;
        return null;
    }
    async set(key, value) {
        const cacheKey = this.buildKey(key);
        this.cache.set(cacheKey, value);
        this.stats.totalEntries = this.cache.size;
        return true;
    }
    async delete(key) {
        const cacheKey = this.buildKey(key);
        return this.cache.delete(cacheKey);
    }
    async exists(key) {
        const cacheKey = this.buildKey(key);
        return this.cache.has(cacheKey);
    }
    async clear() {
        this.cache.clear();
        this.stats.totalEntries = 0;
        return true;
    }
    async getStats() {
        return { ...this.stats };
    }
    async getHealth() {
        return {
            healthy: true,
            connected: true,
            responseTime: 1,
            lastCheck: Date.now(),
        };
    }
    async resetStats() {
        this.stats = {
            totalEntries: 0,
            hits: 0,
            misses: 0,
            hitRate: 0,
            totalSize: 0,
            averageSize: 0,
            expiredEntries: 0,
            evictedEntries: 0,
            lastReset: Date.now(),
        };
    }
    buildKey(key) {
        return `${key.namespace || 'default'}:${key.key}`;
    }
}
/**
 * @class MockCacheKeyFactory
 * @description 模拟缓存键工厂，用于测试
 */
class MockCacheKeyFactory {
    create(key, options) {
        return {
            key,
            namespace: options?.namespace,
            version: options?.version,
            tenantId: options?.tenantId,
            userId: options?.userId,
            tags: options?.tags,
        };
    }
    createNamespace(namespace, key, options) {
        return this.create(key, { ...options, namespace });
    }
    createTenant(tenantId, key, options) {
        return this.create(key, { ...options, tenantId });
    }
    createUser(userId, key, options) {
        return this.create(key, { ...options, userId });
    }
    createTagged(key, tags, options) {
        return this.create(key, { ...options, tags });
    }
    toString(key) {
        return `${key.namespace || 'default'}:${key.key}`;
    }
    parse(keyString) {
        const parts = keyString.split(':');
        return {
            key: parts[1] || parts[0],
            namespace: parts.length > 1 ? parts[0] : undefined,
        };
    }
}
describe('CacheManagerService', () => {
    let service;
    let mockEventEmitter;
    let mockLogger;
    let mockKeyFactory;
    let mockLayer1;
    let mockLayer2;
    const mockConfig = {
        enabled: true,
        defaultStrategy: cache_interface_1.CacheStrategy.LRU,
        monitoringInterval: 1000,
        cleanupInterval: 2000,
        maxSize: 1000,
        enableStats: true,
        enableEvents: true,
    };
    beforeEach(async () => {
        mockEventEmitter = {
            emit: jest.fn(),
        };
        mockLogger = {
            info: jest.fn(),
            error: jest.fn(),
            warn: jest.fn(),
            debug: jest.fn(),
        };
        mockKeyFactory = new MockCacheKeyFactory();
        mockLayer1 = new MockCacheService();
        mockLayer2 = new MockCacheService();
        const module = await testing_1.Test.createTestingModule({
            providers: [
                cache_manager_service_1.CacheManagerService,
                {
                    provide: 'CACHE_MANAGER_CONFIG',
                    useValue: mockConfig,
                },
                {
                    provide: 'ICacheKeyFactory',
                    useValue: mockKeyFactory,
                },
                {
                    provide: event_emitter_1.EventEmitter2,
                    useValue: mockEventEmitter,
                },
                {
                    provide: logging_1.PinoLoggerService,
                    useValue: mockLogger,
                },
            ],
        }).compile();
        service = module.get(cache_manager_service_1.CacheManagerService);
    });
    afterEach(() => {
        service.onDestroy();
    });
    describe('basic operations', () => {
        it('should be defined', () => {
            expect(service).toBeDefined();
        });
        it('should add cache layer', () => {
            const layerConfig = {
                name: 'test-layer',
                priority: 1,
                service: mockLayer1,
                enabled: true,
            };
            const result = service.addLayer(layerConfig);
            expect(result).toBe(true);
            expect(service.getLayers()).toHaveLength(1);
        });
        it('should remove cache layer', () => {
            const layerConfig = {
                name: 'test-layer',
                priority: 1,
                service: mockLayer1,
                enabled: true,
            };
            service.addLayer(layerConfig);
            const result = service.removeLayer('test-layer');
            expect(result).toBe(true);
            expect(service.getLayers()).toHaveLength(0);
        });
        it('should enable/disable cache layer', () => {
            const layerConfig = {
                name: 'test-layer',
                priority: 1,
                service: mockLayer1,
                enabled: true,
            };
            service.addLayer(layerConfig);
            const disableResult = service.enableLayer('test-layer', false);
            expect(disableResult).toBe(true);
            const enableResult = service.enableLayer('test-layer', true);
            expect(enableResult).toBe(true);
        });
    });
    describe('cache operations', () => {
        beforeEach(() => {
            const layer1Config = {
                name: 'layer1',
                priority: 1,
                service: mockLayer1,
                enabled: true,
            };
            const layer2Config = {
                name: 'layer2',
                priority: 2,
                service: mockLayer2,
                enabled: true,
            };
            service.addLayer(layer1Config);
            service.addLayer(layer2Config);
        });
        it('should get value from cache', async () => {
            const key = mockKeyFactory.createNamespace('test-namespace', 'test-key');
            const value = { data: 'test-value' };
            await mockLayer1.set(key, value);
            const result = await service.get(key);
            expect(result).toEqual(value);
        });
        it('should return null for non-existent key', async () => {
            const key = mockKeyFactory.createNamespace('test-namespace', 'non-existent');
            const result = await service.get(key);
            expect(result).toBeNull();
        });
        it('should set value in all layers', async () => {
            const key = mockKeyFactory.createNamespace('test-namespace', 'test-key');
            const value = { data: 'test-value' };
            const result = await service.set(key, value);
            expect(result).toBe(true);
            expect(await mockLayer1.get(key)).toEqual(value);
            expect(await mockLayer2.get(key)).toEqual(value);
        });
        it('should delete value from all layers', async () => {
            const key = mockKeyFactory.createNamespace('test-namespace', 'test-key');
            const value = { data: 'test-value' };
            await service.set(key, value);
            const deleteResult = await service.delete(key);
            expect(deleteResult).toBe(true);
            expect(await mockLayer1.get(key)).toBeNull();
            expect(await mockLayer2.get(key)).toBeNull();
        });
        it('should check if key exists', async () => {
            const key = mockKeyFactory.createNamespace('test-namespace', 'test-key');
            const value = { data: 'test-value' };
            await service.set(key, value);
            const exists = await service.exists(key);
            expect(exists).toBe(true);
        });
        it('should clear all layers', async () => {
            const key = mockKeyFactory.createNamespace('test-namespace', 'test-key');
            const value = { data: 'test-value' };
            await service.set(key, value);
            const clearResult = await service.clear();
            expect(clearResult).toBe(true);
            expect(await mockLayer1.get(key)).toBeNull();
            expect(await mockLayer2.get(key)).toBeNull();
        });
    });
    describe('statistics', () => {
        beforeEach(() => {
            const layerConfig = {
                name: 'test-layer',
                priority: 1,
                service: mockLayer1,
                enabled: true,
            };
            service.addLayer(layerConfig);
        });
        it('should get cache stats', async () => {
            const stats = await service.getStats();
            expect(stats).toBeDefined();
            expect(stats.hits).toBeDefined();
            expect(stats.misses).toBeDefined();
            expect(stats.hitRate).toBeDefined();
        });
        it('should reset cache stats', async () => {
            const key = mockKeyFactory.createNamespace('test-namespace', 'test-key');
            const value = { data: 'test-value' };
            await service.set(key, value);
            await service.get(key);
            await service.resetStats();
            const stats = await service.getStats();
            expect(stats.hits).toBe(0);
            expect(stats.misses).toBe(0);
        });
    });
    describe('health check', () => {
        beforeEach(() => {
            const layerConfig = {
                name: 'test-layer',
                priority: 1,
                service: mockLayer1,
                enabled: true,
            };
            service.addLayer(layerConfig);
        });
        it('should get cache health', async () => {
            const health = await service.getHealth();
            expect(health).toBeDefined();
            expect(health.healthy).toBeDefined();
            expect(health.connected).toBeDefined();
            expect(health.responseTime).toBeDefined();
        });
    });
    describe('layer management', () => {
        it('should handle read-only layers', async () => {
            const readOnlyLayer = {
                name: 'readonly-layer',
                priority: 1,
                service: mockLayer1,
                enabled: true,
                readOnly: true,
            };
            service.addLayer(readOnlyLayer);
            const key = mockKeyFactory.createNamespace('test-namespace', 'test-key');
            const value = { data: 'test-value' };
            // 只读层不应该被写入
            const setResult = await service.set(key, value);
            expect(setResult).toBe(false);
        });
        it('should handle disabled layers', async () => {
            const disabledLayer = {
                name: 'disabled-layer',
                priority: 1,
                service: mockLayer1,
                enabled: false,
            };
            service.addLayer(disabledLayer);
            const key = mockKeyFactory.createNamespace('test-namespace', 'test-key');
            const value = { data: 'test-value' };
            // 禁用的层不应该被访问
            const getResult = await service.get(key);
            expect(getResult).toBeNull();
        });
    });
    describe('error handling', () => {
        it('should handle layer errors gracefully', async () => {
            const errorLayer = {
                name: 'error-layer',
                priority: 1,
                service: {
                    get: jest.fn().mockRejectedValue(new Error('Layer error')),
                    set: jest.fn().mockRejectedValue(new Error('Layer error')),
                    delete: jest.fn().mockRejectedValue(new Error('Layer error')),
                    exists: jest.fn().mockRejectedValue(new Error('Layer error')),
                    clear: jest.fn().mockRejectedValue(new Error('Layer error')),
                    getStats: jest.fn().mockRejectedValue(new Error('Layer error')),
                    getHealth: jest.fn().mockRejectedValue(new Error('Layer error')),
                    resetStats: jest.fn().mockRejectedValue(new Error('Layer error')),
                },
                enabled: true,
            };
            service.addLayer(errorLayer);
            const key = mockKeyFactory.createNamespace('test-namespace', 'test-key');
            const value = { data: 'test-value' };
            // 应该处理错误而不抛出异常
            const getResult = await service.get(key);
            expect(getResult).toBeNull();
            const setResult = await service.set(key, value);
            expect(setResult).toBe(false);
        });
    });
    describe('event emission', () => {
        beforeEach(() => {
            const layerConfig = {
                name: 'test-layer',
                priority: 1,
                service: mockLayer1,
                enabled: true,
            };
            service.addLayer(layerConfig);
        });
        it('should emit cache events', async () => {
            const key = mockKeyFactory.createNamespace('test-namespace', 'test-key');
            const value = { data: 'test-value' };
            await service.set(key, value);
            await service.get(key);
            expect(mockEventEmitter.emit).toHaveBeenCalledWith('cache.cache_set', expect.objectContaining({
                type: 'cache_set',
                data: expect.objectContaining({ key, value }),
            }));
            expect(mockEventEmitter.emit).toHaveBeenCalledWith('cache.cache_hit', expect.objectContaining({
                type: 'cache_hit',
                data: expect.objectContaining({ key, value }),
            }));
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvYXJsaWdsZS9WMS9BaW9maXgvYWlvZml4LWFpLXNhYXMtcGxhdGZvcm0vcGFja2FnZXMvY2FjaGUvc3JjL3NlcnZpY2VzL2NhY2hlLW1hbmFnZXIuc2VydmljZS5zcGVjLnRzIiwibWFwcGluZ3MiOiI7O0FBQUEsNkNBQXNEO0FBQ3RELHlEQUFzRDtBQUN0RCxtRUFJaUM7QUFHakMsbUVBSXVDO0FBQ3ZDLDZDQUFvRDtBQUVwRDs7O0dBR0c7QUFDSCxNQUFNLGdCQUFnQjtJQUF0QjtRQUNVLFVBQUssR0FBRyxJQUFJLEdBQUcsRUFBbUIsQ0FBQztRQUNuQyxVQUFLLEdBQUc7WUFDZCxZQUFZLEVBQUUsQ0FBQztZQUNmLElBQUksRUFBRSxDQUFDO1lBQ1AsTUFBTSxFQUFFLENBQUM7WUFDVCxPQUFPLEVBQUUsQ0FBQztZQUNWLFNBQVMsRUFBRSxDQUFDO1lBQ1osV0FBVyxFQUFFLENBQUM7WUFDZCxjQUFjLEVBQUUsQ0FBQztZQUNqQixjQUFjLEVBQUUsQ0FBQztZQUNqQixTQUFTLEVBQUUsSUFBSSxDQUFDLEdBQUcsRUFBRTtTQUN0QixDQUFDO0lBa0VKLENBQUM7SUFoRUMsS0FBSyxDQUFDLEdBQUcsQ0FBYyxHQUFhO1FBQ2xDLE1BQU0sUUFBUSxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDcEMsTUFBTSxLQUFLLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDdkMsSUFBSSxLQUFLLEtBQUssU0FBUyxFQUFFLENBQUM7WUFDeEIsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLEVBQUUsQ0FBQztZQUNsQixPQUFPLEtBQUssQ0FBQztRQUNmLENBQUM7UUFDRCxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sRUFBRSxDQUFDO1FBQ3BCLE9BQU8sSUFBSSxDQUFDO0lBQ2QsQ0FBQztJQUVELEtBQUssQ0FBQyxHQUFHLENBQWMsR0FBYSxFQUFFLEtBQVE7UUFDNUMsTUFBTSxRQUFRLEdBQUcsSUFBSSxD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SUFBSSxDQUFDLENBQUMsb0JBQW9CLENBQ2hELGlCQUFpQixFQUNqQixNQUFNLENBQUMsZ0JBQWdCLENBQUM7Z0JBQ3RCLElBQUksRUFBRSxXQUFXO2dCQUNqQixJQUFJLEVBQUUsTUFBTSxDQUFDLGdCQUFnQixDQUFDLEVBQUUsR0FBRyxFQUFFLEtBQUssRUFBRSxDQUFDO2FBQzlDLENBQUMsQ0FDSCxDQUFDO1FBQ0osQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9ob21lL2FybGlnbGUvVjEvQWlvZml4L2Fpb2ZpeC1haS1zYWFzLXBsYXRmb3JtL3BhY2thZ2VzL2NhY2hlL3NyYy9zZXJ2aWNlcy9jYWNoZS1tYW5hZ2VyLnNlcnZpY2Uuc3BlYy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBUZXN0LCBUZXN0aW5nTW9kdWxlIH0gZnJvbSAnQG5lc3Rqcy90ZXN0aW5nJztcbmltcG9ydCB7IEV2ZW50RW1pdHRlcjIgfSBmcm9tICdAbmVzdGpzL2V2ZW50LWVtaXR0ZXInO1xuaW1wb3J0IHtcbiAgQ2FjaGVNYW5hZ2VyU2VydmljZSxcbiAgQ2FjaGVNYW5hZ2VyQ29uZmlnLFxuICBDYWNoZUxheWVyQ29uZmlnLFxufSBmcm9tICcuL2NhY2hlLW1hbmFnZXIuc2VydmljZSc7XG5pbXBvcnQgeyBJQ2FjaGVTZXJ2aWNlIH0gZnJvbSAnLi4vaW50ZXJmYWNlcy9jYWNoZS5pbnRlcmZhY2UnO1xuaW1wb3J0IHsgSUNhY2hlS2V5RmFjdG9yeSB9IGZyb20gJy4uL2ludGVyZmFjZXMvY2FjaGUuaW50ZXJmYWNlJztcbmltcG9ydCB7XG4gIENhY2hlU3RyYXRlZ3ksXG4gIENhY2hlVHlwZSxcbiAgQ2FjaGVLZXksXG59IGZyb20gJy4uL2ludGVyZmFjZXMvY2FjaGUuaW50ZXJmYWNlJztcbmltcG9ydCB7IFBpbm9Mb2dnZXJTZXJ2aWNlIH0gZnJvbSAnQGFpb2ZpeC9sb2dnaW5nJztcblxuLyoqXG4gKiBAY2xhc3MgTW9ja0NhY2hlU2VydmljZVxuICogQGRlc2NyaXB0aW9uIOaooeaLn+e8k+WtmOacjeWKoe+8jOeUqOS6jua1i+ivlVxuICovXG5jbGFzcyBNb2NrQ2FjaGVTZXJ2aWNlIGltcGxlbWVudHMgSUNhY2hlU2VydmljZSB7XG4gIHByaXZhdGUgY2FjaGUgPSBuZXcgTWFwPHN0cmluZywgdW5rbm93bj4oKTtcbiAgcHJpdmF0ZSBzdGF0cyA9IHtcbiAgICB0b3RhbEVudHJpZXM6IDAsXG4gICAgaGl0czogMCxcbiAgICBtaXNzZXM6IDAsXG4gICAgaGl0UmF0ZTogMCxcbiAgICB0b3RhbFNpemU6IDAsXG4gICAgYXZlcmFnZVNpemU6IDAsXG4gICAgZXhwaXJlZEVudHJpZXM6IDAsXG4gICAgZXZpY3RlZEVudHJpZXM6IDAsXG4gICAgbGFzdFJlc2V0OiBEYXRlLm5vdygpLFxuICB9O1xuXG4gIGFzeW5jIGdldDxUID0gdW5rbm93bj4oa2V5OiBDYWNoZUtleSk6IFByb21pc2U8VCB8IG51bGw+IHtcbiAgICBjb25zdCBjYWNoZUtleSA9IHRoaXMuYnVpbGRLZXkoa2V5KTtcbiAgICBjb25zdCB2YWx1ZSA9IHRoaXMuY2FjaGUuZ2V0KGNhY2hlS2V5KTtcbiAgICBpZiAodmFsdWUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhpcy5zdGF0cy5oaXRzKys7XG4gICAgICByZXR1cm4gdmFsdWU7XG4gICAgfVxuICAgIHRoaXMuc3RhdHMubWlzc2VzKys7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICBhc3luYyBzZXQ8VCA9IHVua25vd24+KGtleTogQ2FjaGVLZXksIHZhbHVlOiBUKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgY29uc3QgY2FjaGVLZXkgPSB0aGlzLmJ1aWxkS2V5KGtleSk7XG4gICAgdGhpcy5jYWNoZS5zZXQoY2FjaGVLZXksIHZhbHVlKTtcbiAgICB0aGlzLnN0YXRzLnRvdGFsRW50cmllcyA9IHRoaXMuY2FjaGUuc2l6ZTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIGFzeW5jIGRlbGV0ZShrZXk6IENhY2hlS2V5KTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgY29uc3QgY2FjaGVLZXkgPSB0aGlzLmJ1aWxkS2V5KGtleSk7XG4gICAgcmV0dXJuIHRoaXMuY2FjaGUuZGVsZXRlKGNhY2hlS2V5KTtcbiAgfVxuXG4gIGFzeW5jIGV4aXN0cyhrZXk6IENhY2hlS2V5KTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgY29uc3QgY2FjaGVLZXkgPSB0aGlzLmJ1aWxkS2V5KGtleSk7XG4gICAgcmV0dXJuIHRoaXMuY2FjaGUuaGFzKGNhY2hlS2V5KTtcbiAgfVxuXG4gIGFzeW5jIGNsZWFyKCk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIHRoaXMuY2FjaGUuY2xlYXIoKTtcbiAgICB0aGlzLnN0YXRzLnRvdGFsRW50cmllcyA9IDA7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICBhc3luYyBnZXRTdGF0cygpIHtcbiAgICByZXR1cm4geyAuLi50aGlzLnN0YXRzIH07XG4gIH1cblxuICBhc3luYyBnZXRIZWFsdGgoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGhlYWx0aHk6IHRydWUsXG4gICAgICBjb25uZWN0ZWQ6IHRydWUsXG4gICAgICByZXNwb25zZVRpbWU6IDEsXG4gICAgICBsYXN0Q2hlY2s6IERhdGUubm93KCksXG4gICAgfTtcbiAgfVxuXG4gIGFzeW5jIHJlc2V0U3RhdHMoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdGhpcy5zdGF0cyA9IHtcbiAgICAgIHRvdGFsRW50cmllczogMCxcbiAgICAgIGhpdHM6IDAsXG4gICAgICBtaXNzZXM6IDAsXG4gICAgICBoaXRSYXRlOiAwLFxuICAgICAgdG90YWxTaXplOiAwLFxuICAgICAgYXZlcmFnZVNpemU6IDAsXG4gICAgICBleHBpcmVkRW50cmllczogMCxcbiAgICAgIGV2aWN0ZWRFbnRyaWVzOiAwLFxuICAgICAgbGFzdFJlc2V0OiBEYXRlLm5vdygpLFxuICAgIH07XG4gIH1cblxuICBwcml2YXRlIGJ1aWxkS2V5KGtleTogQ2FjaGVLZXkpOiBzdHJpbmcge1xuICAgIHJldHVybiBgJHtrZXkubmFtZXNwYWNlIHx8ICdkZWZhdWx0J306JHtrZXkua2V5fWA7XG4gIH1cbn1cblxuLyoqXG4gKiBAY2xhc3MgTW9ja0NhY2hlS2V5RmFjdG9yeVxuICogQGRlc2NyaXB0aW9uIOaooeaLn+e8k+WtmOmUruW3peWOgu+8jOeUqOS6jua1i+ivlVxuICovXG5jbGFzcyBNb2NrQ2FjaGVLZXlGYWN0b3J5IGltcGxlbWVudHMgSUNhY2hlS2V5RmFjdG9yeSB7XG4gIGNyZWF0ZShrZXk6IHN0cmluZywgb3B0aW9ucz86IFBhcnRpYWw8Q2FjaGVLZXk+KTogQ2FjaGVLZXkge1xuICAgIHJldHVybiB7XG4gICAgICBrZXksXG4gICAgICBuYW1lc3BhY2U6IG9wdGlvbnM/Lm5hbWVzcGFjZSxcbiAgICAgIHZlcnNpb246IG9wdGlvbnM/LnZlcnNpb24sXG4gICAgICB0ZW5hbnRJZDogb3B0aW9ucz8udGVuYW50SWQsXG4gICAgICB1c2VySWQ6IG9wdGlvbnM/LnVzZXJJZCxcbiAgICAgIHRhZ3M6IG9wdGlvbnM/LnRhZ3MsXG4gICAgfTtcbiAgfVxuXG4gIGNyZWF0ZU5hbWVzcGFjZShcbiAgICBuYW1lc3BhY2U6IHN0cmluZyxcbiAgICBrZXk6IHN0cmluZyxcbiAgICBvcHRpb25zPzogUGFydGlhbDxDYWNoZUtleT4sXG4gICk6IENhY2hlS2V5IHtcbiAgICByZXR1cm4gdGhpcy5jcmVhdGUoa2V5LCB7IC4uLm9wdGlvbnMsIG5hbWVzcGFjZSB9KTtcbiAgfVxuXG4gIGNyZWF0ZVRlbmFudChcbiAgICB0ZW5hbnRJZDogc3RyaW5nLFxuICAgIGtleTogc3RyaW5nLFxuICAgIG9wdGlvbnM/OiBQYXJ0aWFsPENhY2hlS2V5PixcbiAgKTogQ2FjaGVLZXkge1xuICAgIHJldHVybiB0aGlzLmNyZWF0ZShrZXksIHsgLi4ub3B0aW9ucywgdGVuYW50SWQgfSk7XG4gIH1cblxuICBjcmVhdGVVc2VyKFxuICAgIHVzZXJJZDogc3RyaW5nLFxuICAgIGtleTogc3RyaW5nLFxuICAgIG9wdGlvbnM/OiBQYXJ0aWFsPENhY2hlS2V5PixcbiAgKTogQ2FjaGVLZXkge1xuICAgIHJldHVybiB0aGlzLmNyZWF0ZShrZXksIHsgLi4ub3B0aW9ucywgdXNlcklkIH0pO1xuICB9XG5cbiAgY3JlYXRlVGFnZ2VkKFxuICAgIGtleTogc3RyaW5nLFxuICAgIHRhZ3M6IHN0cmluZ1tdLFxuICAgIG9wdGlvbnM/OiBQYXJ0aWFsPENhY2hlS2V5PixcbiAgKTogQ2FjaGVLZXkge1xuICAgIHJldHVybiB0aGlzLmNyZWF0ZShrZXksIHsgLi4ub3B0aW9ucywgdGFncyB9KTtcbiAgfVxuXG4gIHRvU3RyaW5nKGtleTogQ2FjaGVLZXkpOiBzdHJpbmcge1xuICAgIHJldHVybiBgJHtrZXkubmFtZXNwYWNlIHx8ICdkZWZhdWx0J306JHtrZXkua2V5fWA7XG4gIH1cblxuICBwYXJzZShrZXlTdHJpbmc6IHN0cmluZyk6IENhY2hlS2V5IHtcbiAgICBjb25zdCBwYXJ0cyA9IGtleVN0cmluZy5zcGxpdCgnOicpO1xuICAgIHJldHVybiB7XG4gICAgICBrZXk6IHBhcnRzWzFdIHx8IHBhcnRzWzBdLFxuICAgICAgbmFtZXNwYWNlOiBwYXJ0cy5sZW5ndGggPiAxID8gcGFydHNbMF0gOiB1bmRlZmluZWQsXG4gICAgfTtcbiAgfVxufVxuXG5kZXNjcmliZSgnQ2FjaGVNYW5hZ2VyU2VydmljZScsICgpID0+IHtcbiAgbGV0IHNlcnZpY2U6IENhY2hlTWFuYWdlclNlcnZpY2U7XG4gIGxldCBtb2NrRXZlbnRFbWl0dGVyOiBqZXN0Lk1vY2tlZDxFdmVudEVtaXR0ZXIyPjtcbiAgbGV0IG1vY2tMb2dnZXI6IGplc3QuTW9ja2VkPFBpbm9Mb2dnZXJTZXJ2aWNlPjtcbiAgbGV0IG1vY2tLZXlGYWN0b3J5OiBNb2NrQ2FjaGVLZXlGYWN0b3J5O1xuICBsZXQgbW9ja0xheWVyMTogTW9ja0NhY2hlU2VydmljZTtcbiAgbGV0IG1vY2tMYXllcjI6IE1vY2tDYWNoZVNlcnZpY2U7XG5cbiAgY29uc3QgbW9ja0NvbmZpZzogQ2FjaGVNYW5hZ2VyQ29uZmlnID0ge1xuICAgIGVuYWJsZWQ6IHRydWUsXG4gICAgZGVmYXVsdFN0cmF0ZWd5OiBDYWNoZVN0cmF0ZWd5LkxSVSxcbiAgICBtb25pdG9yaW5nSW50ZXJ2YWw6IDEwMDAsXG4gICAgY2xlYW51cEludGVydmFsOiAyMDAwLFxuICAgIG1heFNpemU6IDEwMDAsXG4gICAgZW5hYmxlU3RhdHM6IHRydWUsXG4gICAgZW5hYmxlRXZlbnRzOiB0cnVlLFxuICB9O1xuXG4gIGJlZm9yZUVhY2goYXN5bmMgKCkgPT4ge1xuICAgIG1vY2tFdmVudEVtaXR0ZXIgPSB7XG4gICAgICBlbWl0OiBqZXN0LmZuKCksXG4gICAgfSBhcyB1bmtub3duO1xuXG4gICAgbW9ja0xvZ2dlciA9IHtcbiAgICAgIGluZm86IGplc3QuZm4oKSxcbiAgICAgIGVycm9yOiBqZXN0LmZuKCksXG4gICAgICB3YXJuOiBqZXN0LmZuKCksXG4gICAgICBkZWJ1ZzogamVzdC5mbigpLFxuICAgIH0gYXMgdW5rbm93bjtcblxuICAgIG1vY2tLZXlGYWN0b3J5ID0gbmV3IE1vY2tDYWNoZUtleUZhY3RvcnkoKTtcbiAgICBtb2NrTGF5ZXIxID0gbmV3IE1vY2tDYWNoZVNlcnZpY2UoKTtcbiAgICBtb2NrTGF5ZXIyID0gbmV3IE1vY2tDYWNoZVNlcnZpY2UoKTtcblxuICAgIGNvbnN0IG1vZHVsZTogVGVzdGluZ01vZHVsZSA9IGF3YWl0IFRlc3QuY3JlYXRlVGVzdGluZ01vZHVsZSh7XG4gICAgICBwcm92aWRlcnM6IFtcbiAgICAgICAgQ2FjaGVNYW5hZ2VyU2VydmljZSxcbiAgICAgICAge1xuICAgICAgICAgIHByb3ZpZGU6ICdDQUNIRV9NQU5BR0VSX0NPTkZJRycsXG4gICAgICAgICAgdXNlVmFsdWU6IG1vY2tDb25maWcsXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBwcm92aWRlOiAnSUNhY2hlS2V5RmFjdG9yeScsXG4gICAgICAgICAgdXNlVmFsdWU6IG1vY2tLZXlGYWN0b3J5LFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgcHJvdmlkZTogRXZlbnRFbWl0dGVyMixcbiAgICAgICAgICB1c2VWYWx1ZTogbW9ja0V2ZW50RW1pdHRlcixcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIHByb3ZpZGU6IFBpbm9Mb2dnZXJTZXJ2aWNlLFxuICAgICAgICAgIHVzZVZhbHVlOiBtb2NrTG9nZ2VyLFxuICAgICAgICB9LFxuICAgICAgXSxcbiAgICB9KS5jb21waWxlKCk7XG5cbiAgICBzZXJ2aWNlID0gbW9kdWxlLmdldDxDYWNoZU1hbmFnZXJTZXJ2aWNlPihDYWNoZU1hbmFnZXJTZXJ2aWNlKTtcbiAgfSk7XG5cbiAgYWZ0ZXJFYWNoKCgpID0+IHtcbiAgICBzZXJ2aWNlLm9uRGVzdHJveSgpO1xuICB9KTtcblxuICBkZXNjcmliZSgnYmFzaWMgb3BlcmF0aW9ucycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGJlIGRlZmluZWQnLCAoKSA9PiB7XG4gICAgICBleHBlY3Qoc2VydmljZSkudG9CZURlZmluZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgYWRkIGNhY2hlIGxheWVyJywgKCkgPT4ge1xuICAgICAgY29uc3QgbGF5ZXJDb25maWc6IENhY2hlTGF5ZXJDb25maWcgPSB7XG4gICAgICAgIG5hbWU6ICd0ZXN0LWxheWVyJyxcbiAgICAgICAgcHJpb3JpdHk6IDEsXG4gICAgICAgIHNlcnZpY2U6IG1vY2tMYXllcjEsXG4gICAgICAgIGVuYWJsZWQ6IHRydWUsXG4gICAgICB9O1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBzZXJ2aWNlLmFkZExheWVyKGxheWVyQ29uZmlnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3Qoc2VydmljZS5nZXRMYXllcnMoKSkudG9IYXZlTGVuZ3RoKDEpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZW1vdmUgY2FjaGUgbGF5ZXInLCAoKSA9PiB7XG4gICAgICBjb25zdCBsYXllckNvbmZpZzogQ2FjaGVMYXllckNvbmZpZyA9IHtcbiAgICAgICAgbmFtZTogJ3Rlc3QtbGF5ZXInLFxuICAgICAgICBwcmlvcml0eTogMSxcbiAgICAgICAgc2VydmljZTogbW9ja0xheWVyMSxcbiAgICAgICAgZW5hYmxlZDogdHJ1ZSxcbiAgICAgIH07XG5cbiAgICAgIHNlcnZpY2UuYWRkTGF5ZXIobGF5ZXJDb25maWcpO1xuICAgICAgY29uc3QgcmVzdWx0ID0gc2VydmljZS5yZW1vdmVMYXllcigndGVzdC1sYXllcicpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChzZXJ2aWNlLmdldExheWVycygpKS50b0hhdmVMZW5ndGgoMCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGVuYWJsZS9kaXNhYmxlIGNhY2hlIGxheWVyJywgKCkgPT4ge1xuICAgICAgY29uc3QgbGF5ZXJDb25maWc6IENhY2hlTGF5ZXJDb25maWcgPSB7XG4gICAgICAgIG5hbWU6ICd0ZXN0LWxheWVyJyxcbiAgICAgICAgcHJpb3JpdHk6IDEsXG4gICAgICAgIHNlcnZpY2U6IG1vY2tMYXllcjEsXG4gICAgICAgIGVuYWJsZWQ6IHRydWUsXG4gICAgICB9O1xuXG4gICAgICBzZXJ2aWNlLmFkZExheWVyKGxheWVyQ29uZmlnKTtcblxuICAgICAgY29uc3QgZGlzYWJsZVJlc3VsdCA9IHNlcnZpY2UuZW5hYmxlTGF5ZXIoJ3Rlc3QtbGF5ZXInLCBmYWxzZSk7XG4gICAgICBleHBlY3QoZGlzYWJsZVJlc3VsdCkudG9CZSh0cnVlKTtcblxuICAgICAgY29uc3QgZW5hYmxlUmVzdWx0ID0gc2VydmljZS5lbmFibGVMYXllcigndGVzdC1sYXllcicsIHRydWUpO1xuICAgICAgZXhwZWN0KGVuYWJsZVJlc3VsdCkudG9CZSh0cnVlKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2NhY2hlIG9wZXJhdGlvbnMnLCAoKSA9PiB7XG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgICBjb25zdCBsYXllcjFDb25maWc6IENhY2hlTGF5ZXJDb25maWcgPSB7XG4gICAgICAgIG5hbWU6ICdsYXllcjEnLFxuICAgICAgICBwcmlvcml0eTogMSxcbiAgICAgICAgc2VydmljZTogbW9ja0xheWVyMSxcbiAgICAgICAgZW5hYmxlZDogdHJ1ZSxcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IGxheWVyMkNvbmZpZzogQ2FjaGVMYXllckNvbmZpZyA9IHtcbiAgICAgICAgbmFtZTogJ2xheWVyMicsXG4gICAgICAgIHByaW9yaXR5OiAyLFxuICAgICAgICBzZXJ2aWNlOiBtb2NrTGF5ZXIyLFxuICAgICAgICBlbmFibGVkOiB0cnVlLFxuICAgICAgfTtcblxuICAgICAgc2VydmljZS5hZGRMYXllcihsYXllcjFDb25maWcpO1xuICAgICAgc2VydmljZS5hZGRMYXllcihsYXllcjJDb25maWcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBnZXQgdmFsdWUgZnJvbSBjYWNoZScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGtleSA9IG1vY2tLZXlGYWN0b3J5LmNyZWF0ZU5hbWVzcGFjZSgndGVzdC1uYW1lc3BhY2UnLCAndGVzdC1rZXknKTtcbiAgICAgIGNvbnN0IHZhbHVlID0geyBkYXRhOiAndGVzdC12YWx1ZScgfTtcblxuICAgICAgYXdhaXQgbW9ja0xheWVyMS5zZXQoa2V5LCB2YWx1ZSk7XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLmdldChrZXkpO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKHZhbHVlKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIG51bGwgZm9yIG5vbi1leGlzdGVudCBrZXknLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBrZXkgPSBtb2NrS2V5RmFjdG9yeS5jcmVhdGVOYW1lc3BhY2UoXG4gICAgICAgICd0ZXN0LW5hbWVzcGFjZScsXG4gICAgICAgICdub24tZXhpc3RlbnQnLFxuICAgICAgKTtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2UuZ2V0KGtleSk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmVOdWxsKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHNldCB2YWx1ZSBpbiBhbGwgbGF5ZXJzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3Qga2V5ID0gbW9ja0tleUZhY3RvcnkuY3JlYXRlTmFtZXNwYWNlKCd0ZXN0LW5hbWVzcGFjZScsICd0ZXN0LWtleScpO1xuICAgICAgY29uc3QgdmFsdWUgPSB7IGRhdGE6ICd0ZXN0LXZhbHVlJyB9O1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLnNldChrZXksIHZhbHVlKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChhd2FpdCBtb2NrTGF5ZXIxLmdldChrZXkpKS50b0VxdWFsKHZhbHVlKTtcbiAgICAgIGV4cGVjdChhd2FpdCBtb2NrTGF5ZXIyLmdldChrZXkpKS50b0VxdWFsKHZhbHVlKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZGVsZXRlIHZhbHVlIGZyb20gYWxsIGxheWVycycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGtleSA9IG1vY2tLZXlGYWN0b3J5LmNyZWF0ZU5hbWVzcGFjZSgndGVzdC1uYW1lc3BhY2UnLCAndGVzdC1rZXknKTtcbiAgICAgIGNvbnN0IHZhbHVlID0geyBkYXRhOiAndGVzdC12YWx1ZScgfTtcblxuICAgICAgYXdhaXQgc2VydmljZS5zZXQoa2V5LCB2YWx1ZSk7XG4gICAgICBjb25zdCBkZWxldGVSZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLmRlbGV0ZShrZXkpO1xuXG4gICAgICBleHBlY3QoZGVsZXRlUmVzdWx0KS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KGF3YWl0IG1vY2tMYXllcjEuZ2V0KGtleSkpLnRvQmVOdWxsKCk7XG4gICAgICBleHBlY3QoYXdhaXQgbW9ja0xheWVyMi5nZXQoa2V5KSkudG9CZU51bGwoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgY2hlY2sgaWYga2V5IGV4aXN0cycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGtleSA9IG1vY2tLZXlGYWN0b3J5LmNyZWF0ZU5hbWVzcGFjZSgndGVzdC1uYW1lc3BhY2UnLCAndGVzdC1rZXknKTtcbiAgICAgIGNvbnN0IHZhbHVlID0geyBkYXRhOiAndGVzdC12YWx1ZScgfTtcblxuICAgICAgYXdhaXQgc2VydmljZS5zZXQoa2V5LCB2YWx1ZSk7XG4gICAgICBjb25zdCBleGlzdHMgPSBhd2FpdCBzZXJ2aWNlLmV4aXN0cyhrZXkpO1xuXG4gICAgICBleHBlY3QoZXhpc3RzKS50b0JlKHRydWUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBjbGVhciBhbGwgbGF5ZXJzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3Qga2V5ID0gbW9ja0tleUZhY3RvcnkuY3JlYXRlTmFtZXNwYWNlKCd0ZXN0LW5hbWVzcGFjZScsICd0ZXN0LWtleScpO1xuICAgICAgY29uc3QgdmFsdWUgPSB7IGRhdGE6ICd0ZXN0LXZhbHVlJyB9O1xuXG4gICAgICBhd2FpdCBzZXJ2aWNlLnNldChrZXksIHZhbHVlKTtcbiAgICAgIGNvbnN0IGNsZWFyUmVzdWx0ID0gYXdhaXQgc2VydmljZS5jbGVhcigpO1xuXG4gICAgICBleHBlY3QoY2xlYXJSZXN1bHQpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QoYXdhaXQgbW9ja0xheWVyMS5nZXQoa2V5KSkudG9CZU51bGwoKTtcbiAgICAgIGV4cGVjdChhd2FpdCBtb2NrTGF5ZXIyLmdldChrZXkpKS50b0JlTnVsbCgpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnc3RhdGlzdGljcycsICgpID0+IHtcbiAgICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICAgIGNvbnN0IGxheWVyQ29uZmlnOiBDYWNoZUxheWVyQ29uZmlnID0ge1xuICAgICAgICBuYW1lOiAndGVzdC1sYXllcicsXG4gICAgICAgIHByaW9yaXR5OiAxLFxuICAgICAgICBzZXJ2aWNlOiBtb2NrTGF5ZXIxLFxuICAgICAgICBlbmFibGVkOiB0cnVlLFxuICAgICAgfTtcblxuICAgICAgc2VydmljZS5hZGRMYXllcihsYXllckNvbmZpZyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGdldCBjYWNoZSBzdGF0cycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHN0YXRzID0gYXdhaXQgc2VydmljZS5nZXRTdGF0cygpO1xuXG4gICAgICBleHBlY3Qoc3RhdHMpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3Qoc3RhdHMuaGl0cykudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChzdGF0cy5taXNzZXMpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3Qoc3RhdHMuaGl0UmF0ZSkudG9CZURlZmluZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmVzZXQgY2FjaGUgc3RhdHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBrZXkgPSBtb2NrS2V5RmFjdG9yeS5jcmVhdGVOYW1lc3BhY2UoJ3Rlc3QtbmFtZXNwYWNlJywgJ3Rlc3Qta2V5Jyk7XG4gICAgICBjb25zdCB2YWx1ZSA9IHsgZGF0YTogJ3Rlc3QtdmFsdWUnIH07XG5cbiAgICAgIGF3YWl0IHNlcnZpY2Uuc2V0KGtleSwgdmFsdWUpO1xuICAgICAgYXdhaXQgc2VydmljZS5nZXQoa2V5KTtcblxuICAgICAgYXdhaXQgc2VydmljZS5yZXNldFN0YXRzKCk7XG5cbiAgICAgIGNvbnN0IHN0YXRzID0gYXdhaXQgc2VydmljZS5nZXRTdGF0cygpO1xuICAgICAgZXhwZWN0KHN0YXRzLmhpdHMpLnRvQmUoMCk7XG4gICAgICBleHBlY3Qoc3RhdHMubWlzc2VzKS50b0JlKDApO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnaGVhbHRoIGNoZWNrJywgKCkgPT4ge1xuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgY29uc3QgbGF5ZXJDb25maWc6IENhY2hlTGF5ZXJDb25maWcgPSB7XG4gICAgICAgIG5hbWU6ICd0ZXN0LWxheWVyJyxcbiAgICAgICAgcHJpb3JpdHk6IDEsXG4gICAgICAgIHNlcnZpY2U6IG1vY2tMYXllcjEsXG4gICAgICAgIGVuYWJsZWQ6IHRydWUsXG4gICAgICB9O1xuXG4gICAgICBzZXJ2aWNlLmFkZExheWVyKGxheWVyQ29uZmlnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZ2V0IGNhY2hlIGhlYWx0aCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGhlYWx0aCA9IGF3YWl0IHNlcnZpY2UuZ2V0SGVhbHRoKCk7XG5cbiAgICAgIGV4cGVjdChoZWFsdGgpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QoaGVhbHRoLmhlYWx0aHkpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QoaGVhbHRoLmNvbm5lY3RlZCkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChoZWFsdGgucmVzcG9uc2VUaW1lKS50b0JlRGVmaW5lZCgpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnbGF5ZXIgbWFuYWdlbWVudCcsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSByZWFkLW9ubHkgbGF5ZXJzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVhZE9ubHlMYXllcjogQ2FjaGVMYXllckNvbmZpZyA9IHtcbiAgICAgICAgbmFtZTogJ3JlYWRvbmx5LWxheWVyJyxcbiAgICAgICAgcHJpb3JpdHk6IDEsXG4gICAgICAgIHNlcnZpY2U6IG1vY2tMYXllcjEsXG4gICAgICAgIGVuYWJsZWQ6IHRydWUsXG4gICAgICAgIHJlYWRPbmx5OiB0cnVlLFxuICAgICAgfTtcblxuICAgICAgc2VydmljZS5hZGRMYXllcihyZWFkT25seUxheWVyKTtcblxuICAgICAgY29uc3Qga2V5ID0gbW9ja0tleUZhY3RvcnkuY3JlYXRlTmFtZXNwYWNlKCd0ZXN0LW5hbWVzcGFjZScsICd0ZXN0LWtleScpO1xuICAgICAgY29uc3QgdmFsdWUgPSB7IGRhdGE6ICd0ZXN0LXZhbHVlJyB9O1xuXG4gICAgICAvLyDlj6ror7vlsYLkuI3lupTor6XooqvlhpnlhaVcbiAgICAgIGNvbnN0IHNldFJlc3VsdCA9IGF3YWl0IHNlcnZpY2Uuc2V0KGtleSwgdmFsdWUpO1xuICAgICAgZXhwZWN0KHNldFJlc3VsdCkudG9CZShmYWxzZSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBkaXNhYmxlZCBsYXllcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBkaXNhYmxlZExheWVyOiBDYWNoZUxheWVyQ29uZmlnID0ge1xuICAgICAgICBuYW1lOiAnZGlzYWJsZWQtbGF5ZXInLFxuICAgICAgICBwcmlvcml0eTogMSxcbiAgICAgICAgc2VydmljZTogbW9ja0xheWVyMSxcbiAgICAgICAgZW5hYmxlZDogZmFsc2UsXG4gICAgICB9O1xuXG4gICAgICBzZXJ2aWNlLmFkZExheWVyKGRpc2FibGVkTGF5ZXIpO1xuXG4gICAgICBjb25zdCBrZXkgPSBtb2NrS2V5RmFjdG9yeS5jcmVhdGVOYW1lc3BhY2UoJ3Rlc3QtbmFtZXNwYWNlJywgJ3Rlc3Qta2V5Jyk7XG4gICAgICBjb25zdCB2YWx1ZSA9IHsgZGF0YTogJ3Rlc3QtdmFsdWUnIH07XG5cbiAgICAgIC8vIOemgeeUqOeahOWxguS4jeW6lOivpeiiq+iuv+mXrlxuICAgICAgY29uc3QgZ2V0UmVzdWx0ID0gYXdhaXQgc2VydmljZS5nZXQoa2V5KTtcbiAgICAgIGV4cGVjdChnZXRSZXN1bHQpLnRvQmVOdWxsKCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdlcnJvciBoYW5kbGluZycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBsYXllciBlcnJvcnMgZ3JhY2VmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGVycm9yTGF5ZXIgPSB7XG4gICAgICAgIG5hbWU6ICdlcnJvci1sYXllcicsXG4gICAgICAgIHByaW9yaXR5OiAxLFxuICAgICAgICBzZXJ2aWNlOiB7XG4gICAgICAgICAgZ2V0OiBqZXN0LmZuKCkubW9ja1JlamVjdGVkVmFsdWUobmV3IEVycm9yKCdMYXllciBlcnJvcicpKSxcbiAgICAgICAgICBzZXQ6IGplc3QuZm4oKS5tb2NrUmVqZWN0ZWRWYWx1ZShuZXcgRXJyb3IoJ0xheWVyIGVycm9yJykpLFxuICAgICAgICAgIGRlbGV0ZTogamVzdC5mbigpLm1vY2tSZWplY3RlZFZhbHVlKG5ldyBFcnJvcignTGF5ZXIgZXJyb3InKSksXG4gICAgICAgICAgZXhpc3RzOiBqZXN0LmZuKCkubW9ja1JlamVjdGVkVmFsdWUobmV3IEVycm9yKCdMYXllciBlcnJvcicpKSxcbiAgICAgICAgICBjbGVhcjogamVzdC5mbigpLm1vY2tSZWplY3RlZFZhbHVlKG5ldyBFcnJvcignTGF5ZXIgZXJyb3InKSksXG4gICAgICAgICAgZ2V0U3RhdHM6IGplc3QuZm4oKS5tb2NrUmVqZWN0ZWRWYWx1ZShuZXcgRXJyb3IoJ0xheWVyIGVycm9yJykpLFxuICAgICAgICAgIGdldEhlYWx0aDogamVzdC5mbigpLm1vY2tSZWplY3RlZFZhbHVlKG5ldyBFcnJvcignTGF5ZXIgZXJyb3InKSksXG4gICAgICAgICAgcmVzZXRTdGF0czogamVzdC5mbigpLm1vY2tSZWplY3RlZFZhbHVlKG5ldyBFcnJvcignTGF5ZXIgZXJyb3InKSksXG4gICAgICAgIH0sXG4gICAgICAgIGVuYWJsZWQ6IHRydWUsXG4gICAgICB9IGFzIHVua25vd247XG5cbiAgICAgIHNlcnZpY2UuYWRkTGF5ZXIoZXJyb3JMYXllcik7XG5cbiAgICAgIGNvbnN0IGtleSA9IG1vY2tLZXlGYWN0b3J5LmNyZWF0ZU5hbWVzcGFjZSgndGVzdC1uYW1lc3BhY2UnLCAndGVzdC1rZXknKTtcbiAgICAgIGNvbnN0IHZhbHVlID0geyBkYXRhOiAndGVzdC12YWx1ZScgfTtcblxuICAgICAgLy8g5bqU6K+l5aSE55CG6ZSZ6K+v6ICM5LiN5oqb5Ye65byC5bi4XG4gICAgICBjb25zdCBnZXRSZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLmdldChrZXkpO1xuICAgICAgZXhwZWN0KGdldFJlc3VsdCkudG9CZU51bGwoKTtcblxuICAgICAgY29uc3Qgc2V0UmVzdWx0ID0gYXdhaXQgc2VydmljZS5zZXQoa2V5LCB2YWx1ZSk7XG4gICAgICBleHBlY3Qoc2V0UmVzdWx0KS50b0JlKGZhbHNlKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2V2ZW50IGVtaXNzaW9uJywgKCkgPT4ge1xuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgY29uc3QgbGF5ZXJDb25maWc6IENhY2hlTGF5ZXJDb25maWcgPSB7XG4gICAgICAgIG5hbWU6ICd0ZXN0LWxheWVyJyxcbiAgICAgICAgcHJpb3JpdHk6IDEsXG4gICAgICAgIHNlcnZpY2U6IG1vY2tMYXllcjEsXG4gICAgICAgIGVuYWJsZWQ6IHRydWUsXG4gICAgICB9O1xuXG4gICAgICBzZXJ2aWNlLmFkZExheWVyKGxheWVyQ29uZmlnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZW1pdCBjYWNoZSBldmVudHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBrZXkgPSBtb2NrS2V5RmFjdG9yeS5jcmVhdGVOYW1lc3BhY2UoJ3Rlc3QtbmFtZXNwYWNlJywgJ3Rlc3Qta2V5Jyk7XG4gICAgICBjb25zdCB2YWx1ZSA9IHsgZGF0YTogJ3Rlc3QtdmFsdWUnIH07XG5cbiAgICAgIGF3YWl0IHNlcnZpY2Uuc2V0KGtleSwgdmFsdWUpO1xuICAgICAgYXdhaXQgc2VydmljZS5nZXQoa2V5KTtcblxuICAgICAgZXhwZWN0KG1vY2tFdmVudEVtaXR0ZXIuZW1pdCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgICdjYWNoZS5jYWNoZV9zZXQnLFxuICAgICAgICBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7XG4gICAgICAgICAgdHlwZTogJ2NhY2hlX3NldCcsXG4gICAgICAgICAgZGF0YTogZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoeyBrZXksIHZhbHVlIH0pLFxuICAgICAgICB9KSxcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChtb2NrRXZlbnRFbWl0dGVyLmVtaXQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICAnY2FjaGUuY2FjaGVfaGl0JyxcbiAgICAgICAgZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgICAgIHR5cGU6ICdjYWNoZV9oaXQnLFxuICAgICAgICAgIGRhdGE6IGV4cGVjdC5vYmplY3RDb250YWluaW5nKHsga2V5LCB2YWx1ZSB9KSxcbiAgICAgICAgfSksXG4gICAgICApO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuIl0sInZlcnNpb24iOjN9